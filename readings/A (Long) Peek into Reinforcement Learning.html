<!DOCTYPE html>
<!-- saved from url=(0092)https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
      






    

    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>A (Long) Peek into Reinforcement Learning</title>

    <meta name="description" content="In this post, we are gonna briefly go over the field of Reinforcement Learning (RL), from fundamental concepts to classic algorithms. Hopefully, this review ...">

    <meta content="Lil&#39;Log" property="og:site_name">
    
        <meta content="A (Long) Peek into Reinforcement Learning" property="og:title">
    
    
        <meta content="article" property="og:type">
    
    
        <meta content="In this post, we are gonna briefly go over the field of Reinforcement Learning (RL), from fundamental concepts to classic algorithms. Hopefully, this review is helpful enough so that newbies would not get lost in specialized terms and jargons while starting. [WARNING] This is a long read." property="og:description">
    
    
        <meta content="https://lilianweng.github.io/2018/02/19/a-long-peek-into-reinforcement-learning.html" property="og:url">
    
    
        <meta content="2018-02-19T17:31:00+00:00" property="article:published_time">
        <meta content="https://lilianweng.github.io/about/" property="article:author">
    
    
        <meta content="/img/srcset/RL_illustration.png" property="og:image">
    
    
        
        <meta content="reinforcement-learning" property="article:tag">
        
        <meta content="long-read" property="article:tag">
        
    

    <link rel="shortcut icon" href="https://lilianweng.github.io/lil-log/assets/favicon_peach.ico">
    <link rel="stylesheet" href="./A (Long) Peek into Reinforcement Learning_files/main.css">
    <link rel="canonical" href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html">

    <!-- For Latex -->
    <script src="./A (Long) Peek into Reinforcement Learning_files/sdk.js.download" async="" crossorigin="anonymous"></script><script id="facebook-jssdk" src="./A (Long) Peek into Reinforcement Learning_files/sdk.js(1).download"></script><script async="" src="./A (Long) Peek into Reinforcement Learning_files/analytics.js.download"></script><script src="./A (Long) Peek into Reinforcement Learning_files/MathJax.js.download" type="text/javascript"></script>

    <!-- Google Analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-8161570-6', 'auto');
        ga('send', 'pageview');
    </script>

    <!-- For Facebook share button -->
    <script src="./A (Long) Peek into Reinforcement Learning_files/embed.js.download" data-timestamp="1586629020017"></script><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.048416edcf5aee78d774bdd3019a3423.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.592be4942e5191dd5ec260e2340bdd4b.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.66651ad59b7dd01c893000c33250bd93.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#043b87;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.0') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.0') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.0') format('opentype')}
</style></head><body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div></div></div></div>
    <script>
      (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.9";
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
    </script>

    <!-- Twitter cards -->
    <meta name="twitter:site" content="@lilianweng">
    <meta name="twitter:creator" content="@Lilian Weng">
    <meta name="twitter:title" content="A (Long) Peek into Reinforcement Learning">

    
        <meta name="twitter:description" content="&lt;blockquote&gt;
  &lt;p&gt;In this post, we are gonna briefly go over the field of Reinforcement Learning (RL), from fundamental concepts to classic algorithms. Hopefully, this review is helpful enough so that newbies would not get lost in specialized terms and jargons while starting. [WARNING] This is a long read.&lt;/p&gt;
&lt;/blockquote&gt;

">
    

    
        <meta name="twitter:card" content="summary_large_image">
        
        <meta name="twitter:image" content="/lil-log/assets/images/RL_illustration.png">
    
    <!-- end of Twitter cards -->




  

    <header class="site-header" role="banner" id="header-bar" style="top: -50px;">

    <div class="wrapper">
        
        <a class="site-title" href="https://lilianweng.github.io/lil-log/">Lil'Log</a>

        <!-- <nav class="site-nav">
            <a class="page-link" href="http://lilianweng.github.io" target="_blank">&#x1f349; About</a>
        </nav> -->
        <nav class="site-nav">
            <a class="page-link" href="https://lilianweng.github.io/lil-log/contact.html">🦄 Contact</a>
        </nav>
        <nav class="site-nav">
            <a class="page-link" href="https://lilianweng.github.io/lil-log/FAQ.html">🙋 FAQ</a>
        </nav>
        <nav class="site-nav">
            <a class="page-link" href="https://lilianweng.github.io/lil-log/archive.html">⌛ Archive</a>
        </nav>

    </div>

</header>

<script>
var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
var currentScrollPos = window.pageYOffset;
  if (prevScrollpos > currentScrollPos) {
    document.getElementById("header-bar").style.top = "0";
  } else {
    document.getElementById("header-bar").style.top = "-50px";
  }
  prevScrollpos = currentScrollPos;
}
</script>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">A (Long) Peek into Reinforcement Learning</h1>
    <p class="post-meta">

      <time datetime="2018-02-19T17:31:00+00:00" itemprop="datePublished">
        
        Feb 19, 2018
      </time>

      <span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        by <span itemprop="name">Lilian Weng</span>
      </span>

      <span>
        
          
          <a class="post-tag" href="https://lilianweng.github.io/lil-log/tag/reinforcement-learning"><nobr>reinforcement-learning</nobr>&nbsp;</a>
        
          
          <a class="post-tag" href="https://lilianweng.github.io/lil-log/tag/long-read"><nobr>long-read</nobr>&nbsp;</a>
        
      </span>
      <!--
      <span class="share-buttons">
        <span class="share-button"><a class="twitter-share-button" href="https://twitter.com/share" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></span>

        <span class="share-button"><span class="fb-like" data-href="/2018/02/19/a-long-peek-into-reinforcement-learning.html" data-layout="button_count" data-action="like" data-size="small" data-show-faces="false" data-share="true"></span></span>
      </span>
      <div style="clear: both;"/>
      -->

    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <blockquote>
  <p>In this post, we are gonna briefly go over the field of Reinforcement Learning (RL), from fundamental concepts to classic algorithms. Hopefully, this review is helpful enough so that newbies would not get lost in specialized terms and jargons while starting. [WARNING] This is a long read.</p>
</blockquote>

<!--more-->

<ul class="table-of-content" id="markdown-toc">
  <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#what-is-reinforcement-learning" id="markdown-toc-what-is-reinforcement-learning">What is Reinforcement Learning?</a>    <ul>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#key-concepts" id="markdown-toc-key-concepts">Key Concepts</a>        <ul>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#model-transition-and-reward" id="markdown-toc-model-transition-and-reward">Model: Transition and Reward</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#policy" id="markdown-toc-policy">Policy</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#value-function" id="markdown-toc-value-function">Value Function</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#optimal-value-and-policy" id="markdown-toc-optimal-value-and-policy">Optimal Value and Policy</a></li>
        </ul>
      </li>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#markov-decision-processes" id="markdown-toc-markov-decision-processes">Markov Decision Processes</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#bellman-equations" id="markdown-toc-bellman-equations">Bellman Equations</a>        <ul>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#bellman-expectation-equations" id="markdown-toc-bellman-expectation-equations">Bellman Expectation Equations</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#bellman-optimality-equations" id="markdown-toc-bellman-optimality-equations">Bellman Optimality Equations</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#common-approaches" id="markdown-toc-common-approaches">Common Approaches</a>    <ul>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#dynamic-programming" id="markdown-toc-dynamic-programming">Dynamic Programming</a>        <ul>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#policy-evaluation" id="markdown-toc-policy-evaluation">Policy Evaluation</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#policy-improvement" id="markdown-toc-policy-improvement">Policy Improvement</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#policy-iteration" id="markdown-toc-policy-iteration">Policy Iteration</a></li>
        </ul>
      </li>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#monte-carlo-methods" id="markdown-toc-monte-carlo-methods">Monte-Carlo Methods</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#temporal-difference-learning" id="markdown-toc-temporal-difference-learning">Temporal-Difference Learning</a>        <ul>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#bootstrapping" id="markdown-toc-bootstrapping">Bootstrapping</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#value-estimation" id="markdown-toc-value-estimation">Value Estimation</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#sarsa-on-policy-td-control" id="markdown-toc-sarsa-on-policy-td-control">SARSA: On-Policy TD control</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#q-learning-off-policy-td-control" id="markdown-toc-q-learning-off-policy-td-control">Q-Learning: Off-policy TD control</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#deep-q-network" id="markdown-toc-deep-q-network">Deep Q-Network</a></li>
        </ul>
      </li>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#combining-td-and-mc-learning" id="markdown-toc-combining-td-and-mc-learning">Combining TD and MC Learning</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#policy-gradient" id="markdown-toc-policy-gradient">Policy Gradient</a>        <ul>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#policy-gradient-theorem" id="markdown-toc-policy-gradient-theorem">Policy Gradient Theorem</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#reinforce" id="markdown-toc-reinforce">REINFORCE</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#actor-critic" id="markdown-toc-actor-critic">Actor-Critic</a></li>
          <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#a3c" id="markdown-toc-a3c">A3C</a></li>
        </ul>
      </li>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#evolution-strategies" id="markdown-toc-evolution-strategies">Evolution Strategies</a></li>
    </ul>
  </li>
  <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#known-problems" id="markdown-toc-known-problems">Known Problems</a>    <ul>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#exploration-exploitation-dilemma" id="markdown-toc-exploration-exploitation-dilemma">Exploration-Exploitation Dilemma</a></li>
      <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#deadly-triad-issue" id="markdown-toc-deadly-triad-issue">Deadly Triad Issue</a></li>
    </ul>
  </li>
  <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#case-study-alphago-zero" id="markdown-toc-case-study-alphago-zero">Case Study: AlphaGo Zero</a></li>
  <li><a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#references" id="markdown-toc-references">References</a></li>
</ul>

<p>A couple of exciting news in Artificial Intelligence (AI) has just happened in recent years.  AlphaGo defeated the best professional human player in the game of Go. Very soon the extended algorithm AlphaGo Zero beat AlphaGo by 100-0 without supervised learning on human knowledge. Top professional game players lost to the bot developed by OpenAI on DOTA2 1v1 competition. After knowing these, it is pretty hard not to be curious about the magic behind these algorithms — Reinforcement Learning (RL). I’m writing this post to briefly go over the field. We will first introduce several fundamental concepts and then dive into classic approaches to solving RL problems. Hopefully, this post could be a good starting point for newbies, bridging the future study on the cutting-edge research.</p>

<h2 id="what-is-reinforcement-learning">What is Reinforcement Learning?</h2>

<p>Say, we have an agent in an unknown environment and this agent can obtain some rewards by interacting with the environment. The agent ought to take actions so as to maximize cumulative rewards. In reality, the scenario could be a bot playing a game to achieve high scores, or a robot trying to complete physical tasks with physical items; and not just limited to these.</p>

<p style="width: 70%;" class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/RL_illustration.png" alt="Illustration of a reinforcement learning problem"></p>
<p><em>Fig. 1. An agent interacts with the environment, trying to take smart actions to maximize cumulative rewards.</em></p>

<p>The goal of Reinforcement Learning (RL) is to learn a good strategy for the agent from experimental trials and relative simple feedback received. With the optimal strategy, the agent is capable to actively adapt to the environment to maximize future rewards.</p>

<h3 id="key-concepts">Key Concepts</h3>

<p>Now Let’s formally define a set of key concepts in RL.</p>

<p>The agent is acting in an <strong>environment</strong>. How the environment reacts to certain actions is defined by a <strong>model</strong> which we may or may not know. The agent can stay in one of many <strong>states</strong> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">s</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-4"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-5">S</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.305em;">∈</span><span class="texatom" id="MathJax-Span-5" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-6"><span class="mi" id="MathJax-Span-7" style="font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">s \in \mathcal{S}</script>) of the environment, and choose to take one of many <strong>actions</strong> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">a</span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-10">A</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-9"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.305em;">∈</span><span class="texatom" id="MathJax-Span-12" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-13"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">a \in \mathcal{A}</script>) to switch from one state to another. Which state the agent will arrive in is decided by transition probabilities between states (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">P</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">P</script>). Once an action is taken, the environment delivers a <strong>reward</strong> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">r</span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-17">R</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-19"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.305em;">∈</span><span class="texatom" id="MathJax-Span-22" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Caligraphic;">R</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">r \in \mathcal{R}</script>) as feedback.</p>

<p>The model defines the reward function and transition probabilities. We may or may not know how the model works and this differentiate two circumstances:</p>
<ul>
  <li><strong>Know the model</strong>: planning with perfect information; do model-based RL. When we fully know the environment, we can find the optimal solution by <a href="https://en.wikipedia.org/wiki/Dynamic_programming">Dynamic Programming</a> (DP). Do you still remember “longest increasing subsequence” or “traveling salesmen problem” from your Algorithms 101 class? LOL. This is not the focus of this post though.</li>
  <li><strong>Does not know the model</strong>: learning with incomplete information; do model-free RL or try to learn the model explicitly as part of the algorithm. Most of the following content serves the scenarios when the model is unknown.</li>
</ul>

<p>The agent’s <strong>policy</strong> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">π</span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">s</span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-25"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">\pi(s)</script> provides the guideline on what is the optimal action to take in a certain state with <span style="color: #e01f1f;"><strong>the goal to maximize the total rewards</strong></span>. Each state is associated with a <strong>value</strong> function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">V</span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">s</span><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">V(s)</script> predicting the expected amount of future rewards we are able to receive in this state by acting the corresponding policy. In other words, the value function quantifies how good a state is. Both policy and value functions are what we try to learn in reinforcement learning.</p>

<p style="width: 100%;" class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/RL_algorithm_categorization.png" alt="Categorization of RL Algorithms"></p>
<p><em>Fig. 2. Summary of approaches in RL based on whether we want to model the value, policy, or the environment. (Image source: reproduced from David Silver’s RL course <a href="https://youtu.be/2pWv7GOvuf0">lecture 1</a>.)</em></p>

<p>The interaction between the agent and the environment involves a sequence of actions and observed rewards in time, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-28"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">t</span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-31">1</span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-33">2</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">T</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-37"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-41" style="font-family: MathJax_Main; padding-left: 0.305em;">1</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-43" style="font-family: MathJax_Main; padding-left: 0.154em;">2</span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main; padding-left: 0.154em;">…</span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.154em;">,</span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">t=1, 2, \dots, T</script>. During the process, the agent accumulates the knowledge about the environment, learns the optimal policy, and makes decisions on which action to take next so as to efficiently learn the best policy. Let’s label the state, action, and reward at time step t as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-38"><span class="MJXp-msubsup" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-41" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-49"><span class="msubsup" id="MathJax-Span-50"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-52" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">S_t</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-45" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-54"><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">A_t</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-58"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-59"><span class="msubsup" id="MathJax-Span-60"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-62" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">R_t</script>, respectively. Thus the interaction sequence is fully described by one <strong>episode</strong> (also known as “trial” or “trajectory”) and the sequence ends at the terminal state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-50"><span class="MJXp-msubsup" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-53" style="vertical-align: -0.4em;">T</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-63"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-64"><span class="msubsup" id="MathJax-Span-65"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-67" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">S_T</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-54"><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-57" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-61" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-65" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-79" style="vertical-align: -0.4em;">T</span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-69"><span class="msubsup" id="MathJax-Span-70"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mn" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-74" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mn" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-78" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mn" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-82" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mn" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-86" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mn" id="MathJax-Span-88" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.154em;">…</span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main; padding-left: 0.154em;">,</span><span class="msubsup" id="MathJax-Span-92" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">S_1, A_1, R_2, S_2, A_2, \dots, S_T</script>

<p>Terms you will encounter a lot when diving into different categories of RL algorithms:</p>
<ul>
  <li><strong>Model-based</strong>: Rely on the model of the environment; either the model is known or the algorithm learns it explicitly.</li>
  <li><strong>Model-free</strong>: No dependency on the model during learning.</li>
  <li><strong>On-policy</strong>: Use the deterministic outcomes or samples from the target policy to train the algorithm.</li>
  <li><strong>Off-policy</strong>: Training on a distribution of transitions or episodes produced by a different behavior policy rather than that produced by the target policy.</li>
</ul>

<h4 id="model-transition-and-reward">Model: Transition and Reward</h4>

<p>The model is a descriptor of the environment. With the model, we can learn or infer how the environment would interact with and provide feedback to the agent. The model has two major parts, transition probability function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">P</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-95"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">P</script> and reward function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">R</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-98"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">R</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">R</script>.</p>

<p>Let’s say when we are in state s, we decide to take action a to arrive in the next state s’ and obtain reward r. This is known as one <strong>transition</strong> step, represented by a tuple (s, a, s’, r).</p>

<p>The transition function P records the probability of transitioning from state s to s’ after taking action a while obtaining reward r. We use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-mrow" id="MJXp-Span-85"><span class="MJXp-mi undefined" id="MJXp-Span-86">P</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-102"><span class="texatom" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_AMS;">P</span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\mathbb{P}</script> as a symbol of “probability”.</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-87"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">P</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-92" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">r</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">s</span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">a</span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-101"><span class="MJXp-mi undefined" id="MJXp-Span-102">P</span></span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">t</span><span class="MJXp-mo" id="MJXp-Span-108">+</span><span class="MJXp-mn" id="MJXp-Span-109">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msup" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-113" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-117" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">t</span><span class="MJXp-mo" id="MJXp-Span-119">+</span><span class="MJXp-mn" id="MJXp-Span-120">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">r</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-126" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">s</span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-132" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">a</span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-106"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-107"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-110"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-112" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">r</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-121" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_AMS;">P</span></span></span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-125"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-127"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-130" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msup" id="MathJax-Span-133" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-137" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-143" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-144" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">r</span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-147"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-153" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">P(s', r \vert s, a)  = \mathbb{P} [S_{t+1} = s', R_{t+1} = r \vert S_t = s, A_t = a]</script>

<p>Thus the state-transition function can be defined as a function of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">P</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-141" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">r</span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">s</span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">a</span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-163"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.456em;"><span class="mo" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">r</span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">P(s', r \vert s, a)</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-149"><span class="MJXp-msubsup" id="MJXp-Span-150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">a</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">s</span><span class="MJXp-msup" id="MJXp-Span-154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-156" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">P</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-163" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">s</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">a</span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-170"><span class="MJXp-mi undefined" id="MJXp-Span-171">P</span></span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-175" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">t</span><span class="MJXp-mo" id="MJXp-Span-177">+</span><span class="MJXp-mn" id="MJXp-Span-178">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msup" id="MJXp-Span-180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-182" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-186" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">s</span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-192" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">a</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-197"><span class=""><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-199" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">r</span><span class="MJXp-mo" id="MJXp-Span-201">∈</span><span class="MJXp-mrow" id="MJXp-Span-202"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-203">R</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">P</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-208" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">r</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">s</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">a</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-174"><span class="msubsup" id="MathJax-Span-175"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.859em;"><span class="mi" id="MathJax-Span-177" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.91em, 4.136em, -999.997em); top: -3.677em; left: 0.658em;"><span class="texatom" id="MathJax-Span-178"><span class="mrow" id="MathJax-Span-179"><span class="mi" id="MathJax-Span-180" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="msup" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.355em;"><span class="mo" id="MathJax-Span-183" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-187"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-196" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-197"><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_AMS;">P</span></span></span><span class="mo" id="MathJax-Span-199" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-202"><span class="mrow" id="MathJax-Span-203"><span class="mi" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msup" id="MathJax-Span-208" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-218" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-225" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.36em, 4.287em, -999.997em); top: -2.87em; left: 0.053em;"><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-231"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">R</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-236"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-238" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">r</span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-242" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">P_{ss'}^a = P(s' \vert s, a)  = \mathbb{P} [S_{t+1} = s' \vert S_t = s, A_t = a] = \sum_{r \in \mathcal{R}} P(s', r \vert s, a)</script>

<p>The reward function R predicts the next reward triggered by one action:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">R</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">s</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">a</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-mi undefined" id="MJXp-Span-225">E</span></span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-229" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">t</span><span class="MJXp-mo" id="MJXp-Span-231">+</span><span class="MJXp-mn" id="MJXp-Span-232">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-236" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">s</span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-242" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">a</span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-247"><span class=""><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-249" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">r</span><span class="MJXp-mo" id="MJXp-Span-251">∈</span><span class="MJXp-mrow" id="MJXp-Span-252"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-253">R</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">r</span><span class="MJXp-munderover" id="MJXp-Span-255"><span class=""><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-257" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-260" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-261">∈</span><span class="MJXp-mrow" id="MJXp-Span-262"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-263">S</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">P</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-268" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">r</span><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">s</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">a</span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-247"><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-251" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-255" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-256"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-259"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-264" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-265" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-269" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-273" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-275" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-280" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.36em, 4.287em, -999.997em); top: -2.87em; left: 0.053em;"><span class="texatom" id="MathJax-Span-282"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-285" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-286"><span class="mrow" id="MathJax-Span-287"><span class="mi" id="MathJax-Span-288" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">R</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">r</span><span class="munderover" id="MathJax-Span-290" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.46em, 4.287em, -999.997em); top: -2.82em; left: 0em;"><span class="texatom" id="MathJax-Span-292"><span class="mrow" id="MathJax-Span-293"><span class="msup" id="MathJax-Span-294"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-296" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-303"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">r</span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">R(s, a) = \mathbb{E} [R_{t+1} \vert S_t = s, A_t = a] = \sum_{r\in\mathcal{R}} r \sum_{s' \in \mathcal{S}} P(s', r \vert s, a)</script>

<h4 id="policy">Policy</h4>

<p>Policy, as the agent’s behavior function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">π</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-313"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-314"><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">\pi</script>, tells us which action to take in state s. It is a mapping from state s to action a and can be either deterministic or stochastic:</p>
<ul>
  <li>Deterministic: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">π</span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">s</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">a</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-316"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-317"><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">\pi(s) = a</script>.</li>
  <li>Stochastic: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">π</span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">a</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">s</span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-293"><span class="MJXp-mrow" id="MJXp-Span-294" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-295">P</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-296" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">A</span><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">a</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">S</span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">s</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-324"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-332" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-333" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-334"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_AMS;">P</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-337" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\pi(a \vert s) = \mathbb{P}_\pi [A=a \vert S=s]</script>.</li>
</ul>

<h4 id="value-function">Value Function</h4>

<p>Value function measures the goodness of a state or how rewarding a state or an action is by a prediction of future reward. The future reward, also known as <strong>return</strong>, is a total sum of discounted rewards going forward. Let’s compute the return <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-msubsup" id="MJXp-Span-307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-309" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-347"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-348"><span class="msubsup" id="MathJax-Span-349"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-351" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">G_t</script> starting from time t:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-310"><span class="MJXp-msubsup" id="MJXp-Span-311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-313" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-317" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">t</span><span class="MJXp-mo" id="MJXp-Span-319">+</span><span class="MJXp-mn" id="MJXp-Span-320">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">γ</span><span class="MJXp-msubsup" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-325" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">t</span><span class="MJXp-mo" id="MJXp-Span-327">+</span><span class="MJXp-mn" id="MJXp-Span-328">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-332"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-338" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi" id="MJXp-Span-339">∞</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-334" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">k</span><span class="MJXp-mo" id="MJXp-Span-336">=</span><span class="MJXp-mn" id="MJXp-Span-337">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341" style="margin-right: 0.05em;">γ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-342" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-345" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">t</span><span class="MJXp-mo" id="MJXp-Span-347">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">k</span><span class="MJXp-mo" id="MJXp-Span-349">+</span><span class="MJXp-mn" id="MJXp-Span-350">1</span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-352"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-353"><span class="msubsup" id="MathJax-Span-354"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-355" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-358" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-360"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-363" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-364" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-365" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-367"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-369"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main; padding-left: 0.204em;">⋯</span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-377" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-378" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.236em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-379"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-382" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-383" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.43em, 1000.66em, 4.136em, -999.997em); top: -5.139em; left: 0.355em;"><span class="texatom" id="MathJax-Span-384"><span class="mrow" id="MathJax-Span-385"><span class="mi" id="MathJax-Span-386" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-387" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.607em;"><span class="mi" id="MathJax-Span-389" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-390"><span style="display: inline-block; position: relative; width: 2.926em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="mi" id="MathJax-Span-394" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-395" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-397" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-398" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-24">G_t = R_{t+1} + \gamma R_{t+2} + \dots = \sum_{k=0}^{\infty} \gamma^k R_{t+k+1}</script>

<p>The discounting factor <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">γ</span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-355">0</span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-357">1</span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-399"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Main; padding-left: 0.305em;">∈</span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main; padding-left: 0.305em;">[</span><span class="mn" id="MathJax-Span-404" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-406" style="font-family: MathJax_Main; padding-left: 0.154em;">1</span><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\gamma \in [0, 1]</script> penalize the rewards in the future, because:</p>
<ul>
  <li>The future rewards may have higher uncertainty; i.e. stock market.</li>
  <li>The future rewards do not provide immediate benefits; i.e. As human beings, we might prefer to have fun today rather than 5 years later ;).</li>
  <li>Discounting provides mathematical convenience; i.e., we don’t need to track future steps forever to compute return.</li>
  <li>We don’t need to worry about the infinite loops in the state transition graph.</li>
</ul>

<p>The <strong>state-value</strong> of a state s is the expected return if we are in this state at time t, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-359"><span class="MJXp-msubsup" id="MJXp-Span-360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-362" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">s</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-408"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-409"><span class="msubsup" id="MathJax-Span-410"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-412" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">S_t = s</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-365"><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-368" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">s</span><span class="MJXp-mo" id="MJXp-Span-372" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mrow" id="MJXp-Span-375" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-376">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-377" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-382" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-386" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">s</span><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-415"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-416"><span class="msubsup" id="MathJax-Span-417"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-424" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-426" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-427"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="texatom" id="MathJax-Span-430"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-433" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-434"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-438"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">V_{\pi}(s) = \mathbb{E}_{\pi}[G_t \vert S_t = s]</script>

<p>Similarly, we define the <strong>action-value</strong> (“Q-value”; Q as “Quality” I believe?) of a state-action pair as:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-390"><span class="MJXp-msubsup" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-393" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-395" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">s</span><span class="MJXp-mo" id="MJXp-Span-397" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">a</span><span class="MJXp-mo" id="MJXp-Span-399" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-401"><span class="MJXp-mrow" id="MJXp-Span-402" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-403">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-404" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-409" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-413" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">s</span><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-419" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">a</span><span class="MJXp-mo" id="MJXp-Span-422" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-445"><span class="msubsup" id="MathJax-Span-446"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-448"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-453" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-456" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-457" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-458"><span class="mrow" id="MathJax-Span-459"><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mi" id="MathJax-Span-463" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-464" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-465"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-467" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-470" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-471" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-475" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-478" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-480" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">Q_{\pi}(s, a) = \mathbb{E}_{\pi}[G_t \vert S_t = s, A_t = a]</script>

<p>Additionally, since we follow the target policy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">π</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-481"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-482"><span class="mi" id="MathJax-Span-483" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">\pi</script>, we can make use of the probility distribution over possible actions and the Q-values to recover the state-value:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-425"><span class="MJXp-msubsup" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-428" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">s</span><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-434"><span class=""><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-436" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">a</span><span class="MJXp-mo" id="MJXp-Span-438">∈</span><span class="MJXp-mrow" id="MJXp-Span-439"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-440">A</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-443" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">s</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">a</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">π</span><span class="MJXp-mo" id="MJXp-Span-451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">a</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">s</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-484"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-485"><span class="msubsup" id="MathJax-Span-486"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-488"><span class="mrow" id="MathJax-Span-489"><span class="mi" id="MathJax-Span-490" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-491" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-492" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-493" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-495" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-496" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-497"><span class="mrow" id="MathJax-Span-498"><span class="mi" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-501"><span class="mrow" id="MathJax-Span-502"><span class="mi" id="MathJax-Span-503" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-504" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="mi" id="MathJax-Span-508" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">V_{\pi}(s) = \sum_{a \in \mathcal{A}} Q_{\pi}(s, a) \pi(a \vert s)</script>

<p>The difference between action-value and state-value is the action <strong>advantage</strong> function (“A-value”):</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-456"><span class="MJXp-msubsup" id="MJXp-Span-457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-459" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">s</span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">a</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-469" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">s</span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">a</span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-479" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">s</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-520"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-521"><span class="msubsup" id="MathJax-Span-522"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-524"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-531" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-532" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-533" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-535"><span class="mrow" id="MathJax-Span-536"><span class="mi" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-540" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-542" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="msubsup" id="MathJax-Span-544" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-546"><span class="mrow" id="MathJax-Span-547"><span class="mi" id="MathJax-Span-548" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">A_{\pi}(s, a) = Q_{\pi}(s, a) - V_{\pi}(s)</script>

<h4 id="optimal-value-and-policy">Optimal Value and Policy</h4>

<p>The optimal value function produces the maximum return:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-495"><span class="MJXp-msubsup" id="MJXp-Span-496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-498" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-499">∗</span></span></span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">s</span><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-504"><span class=""><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-506" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">π</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-510" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">s</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-518" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-519">∗</span></span></span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">s</span><span class="MJXp-mo" id="MJXp-Span-522" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">a</span><span class="MJXp-mo" id="MJXp-Span-524" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-526"><span class=""><span class="MJXp-mo" id="MJXp-Span-527" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-528" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">π</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-532" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">s</span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">a</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-552"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-553"><span class="msubsup" id="MathJax-Span-554"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-556"><span class="mrow" id="MathJax-Span-557"><span class="mo" id="MathJax-Span-558" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-561" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-563" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.236em, -999.997em); top: -3.374em; left: 0.708em;"><span class="texatom" id="MathJax-Span-565"><span class="mrow" id="MathJax-Span-566"><span class="mi" id="MathJax-Span-567" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-568" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-570"><span class="mrow" id="MathJax-Span-571"><span class="mi" id="MathJax-Span-572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-575" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-577" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-578" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-579"><span class="mrow" id="MathJax-Span-580"><span class="mo" id="MathJax-Span-581" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-582" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-585" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-586" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-587" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-588" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-589" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.236em, -999.997em); top: -3.374em; left: 0.708em;"><span class="texatom" id="MathJax-Span-590"><span class="mrow" id="MathJax-Span-591"><span class="mi" id="MathJax-Span-592" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-593" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-595"><span class="mrow" id="MathJax-Span-596"><span class="mi" id="MathJax-Span-597" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-598" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-602" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">V_{*}(s) = \max_{\pi} V_{\pi}(s),
Q_{*}(s, a) = \max_{\pi} Q_{\pi}(s, a)</script>

<p>The optimal policy achieves optimal value functions:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-539"><span class="MJXp-msubsup" id="MJXp-Span-540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541" style="margin-right: 0.05em;">π</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-542" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-543">∗</span></span></span><span class="MJXp-mo" id="MJXp-Span-544" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-545">arg</span><span class="MJXp-mo" id="MJXp-Span-546" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-547"><span class=""><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-549" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">π</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-553" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">s</span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560" style="margin-right: 0.05em;">π</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-561" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-562">∗</span></span></span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-564">arg</span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-566"><span class=""><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-568" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">π</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-570"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-572" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">s</span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">a</span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-603"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-604"><span class="msubsup" id="MathJax-Span-605"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="texatom" id="MathJax-Span-607"><span class="mrow" id="MathJax-Span-608"><span class="mo" id="MathJax-Span-609" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-610" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Main; padding-left: 0.305em;">arg</span><span class="mo" id="MathJax-Span-612"></span><span class="munderover" id="MathJax-Span-613" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-614" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.236em, -999.997em); top: -3.374em; left: 0.708em;"><span class="texatom" id="MathJax-Span-615"><span class="mrow" id="MathJax-Span-616"><span class="mi" id="MathJax-Span-617" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-618" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-620"><span class="mrow" id="MathJax-Span-621"><span class="mi" id="MathJax-Span-622" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-625" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-627" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-628" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="texatom" id="MathJax-Span-629"><span class="mrow" id="MathJax-Span-630"><span class="mo" id="MathJax-Span-631" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-632" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Main; padding-left: 0.305em;">arg</span><span class="mo" id="MathJax-Span-634"></span><span class="munderover" id="MathJax-Span-635" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-636" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.236em, -999.997em); top: -3.374em; left: 0.708em;"><span class="texatom" id="MathJax-Span-637"><span class="mrow" id="MathJax-Span-638"><span class="mi" id="MathJax-Span-639" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-640" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-642"><span class="mrow" id="MathJax-Span-643"><span class="mi" id="MathJax-Span-644" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-647" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-648" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-649" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-33">\pi_{*} = \arg\max_{\pi} V_{\pi}(s),
\pi_{*} = \arg\max_{\pi} Q_{\pi}(s, a)</script>

<p>And of course, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-579"><span class="MJXp-msubsup" id="MJXp-Span-580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-582" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584" style="margin-right: 0.05em;">π</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-585" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-586">∗</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">s</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-593" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-594">∗</span></span></span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">s</span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-651"><span class="msubsup" id="MathJax-Span-652"><span style="display: inline-block; position: relative; width: 1.363em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-654"><span class="mrow" id="MathJax-Span-655"><span class="msubsup" id="MathJax-Span-656"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-657" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="texatom" id="MathJax-Span-658"><span class="mrow" id="MathJax-Span-659"><span class="mo" id="MathJax-Span-660" style="font-size: 50%; font-family: MathJax_Main;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-661" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-662" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-663" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-665" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-666" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-667"><span class="mrow" id="MathJax-Span-668"><span class="mo" id="MathJax-Span-669" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-671" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-672" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">V_{\pi_{*}}(s)=V_{*}(s)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-msubsup" id="MJXp-Span-599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-601" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603" style="margin-right: 0.05em;">π</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-604" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-605">∗</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">s</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">a</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-614" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-615">∗</span></span></span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">s</span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">a</span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-673"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-674"><span class="msubsup" id="MathJax-Span-675"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-676" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-677"><span class="mrow" id="MathJax-Span-678"><span class="msubsup" id="MathJax-Span-679"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-680" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="texatom" id="MathJax-Span-681"><span class="mrow" id="MathJax-Span-682"><span class="mo" id="MathJax-Span-683" style="font-size: 50%; font-family: MathJax_Main;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-684" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-685" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-686" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-687" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-688" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-689" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-690" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-691" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-692"><span class="mrow" id="MathJax-Span-693"><span class="mo" id="MathJax-Span-694" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-695" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-696" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-698" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-699" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">Q_{\pi_{*}}(s, a) = Q_{*}(s, a)</script>.</p>

<h3 id="markov-decision-processes">Markov Decision Processes</h3>

<p>In more formal terms, almost all the RL problems can be framed as <strong>Markov Decision Processes</strong> (MDPs). All states in MDP has “Markov” property, referring to the fact that the future only depends on the current state, not the history:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-621"><span class="MJXp-mrow" id="MJXp-Span-622"><span class="MJXp-mi undefined" id="MJXp-Span-623">P</span></span><span class="MJXp-mo" id="MJXp-Span-624" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-627" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">t</span><span class="MJXp-mo" id="MJXp-Span-629">+</span><span class="MJXp-mn" id="MJXp-Span-630">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-631" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-634" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-637"><span class="MJXp-mi undefined" id="MJXp-Span-638">P</span></span><span class="MJXp-mo" id="MJXp-Span-639" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-642" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">t</span><span class="MJXp-mo" id="MJXp-Span-644">+</span><span class="MJXp-mn" id="MJXp-Span-645">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-649" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-655" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-700"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-701"><span class="texatom" id="MathJax-Span-702"><span class="mrow" id="MathJax-Span-703"><span class="mi" id="MathJax-Span-704" style="font-family: MathJax_AMS;">P</span></span></span><span class="mo" id="MathJax-Span-705" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-706"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-707" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-708"><span class="mrow" id="MathJax-Span-709"><span class="mi" id="MathJax-Span-710" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-711" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-712" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-713" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-714"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-715" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-717" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-718" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-719" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-720"><span class="mi" id="MathJax-Span-721" style="font-family: MathJax_AMS;">P</span></span></span><span class="mo" id="MathJax-Span-722" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-723"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-724" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-725"><span class="mrow" id="MathJax-Span-726"><span class="mi" id="MathJax-Span-727" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-728" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-729" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-730" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-731"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-732" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mn" id="MathJax-Span-733" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-734" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main; padding-left: 0.154em;">…</span><span class="mo" id="MathJax-Span-736" style="font-family: MathJax_Main; padding-left: 0.154em;">,</span><span class="msubsup" id="MathJax-Span-737" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-738" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-739" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-740" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-36">\mathbb{P}[ S_{t+1} \vert S_t ] = \mathbb{P} [S_{t+1} \vert S_1, \dots, S_t]</script>

<p>Or in other words, the future and the past are <strong>conditionally independent</strong> given the present, as the current state encapsulates all the statistics we need to decide the future.</p>

<p style="width: 60%;" class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/agent_environment_MDP.png" alt="Agent-Environment Interaction in MDP"></p>
<p><em>Fig. 3. The agent-environment interaction in a Markov decision process. (Image source: Sec. 3.1 Sutton &amp; Barto (2017).)</em></p>

<p>A Markov deicison process consists of five elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-657"><span class="MJXp-mrow" id="MJXp-Span-658"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-659">M</span></span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-661" style="margin-left: 0em; margin-right: 0em;">⟨</span><span class="MJXp-mrow" id="MJXp-Span-662"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-663">S</span></span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-665"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-666">A</span></span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">P</span><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">R</span><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">γ</span><span class="MJXp-mo" id="MJXp-Span-673" style="margin-left: 0em; margin-right: 0em;">⟩</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-741"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-742"><span class="texatom" id="MathJax-Span-743"><span class="mrow" id="MathJax-Span-744"><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Caligraphic;">M</span></span></span><span class="mo" id="MathJax-Span-746" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mo" id="MathJax-Span-747" style="font-family: MathJax_Main; padding-left: 0.305em;">⟨</span><span class="texatom" id="MathJax-Span-748"><span class="mrow" id="MathJax-Span-749"><span class="mi" id="MathJax-Span-750" style="font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-752" style="padding-left: 0.154em;"><span class="mrow" id="MathJax-Span-753"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-755" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-756" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-757" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-758" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">R</span><span class="mo" id="MathJax-Span-759" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Main;">⟩</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">\mathcal{M} = \langle \mathcal{S}, \mathcal{A}, P, R, \gamma \rangle</script>, where the symbols carry the same meanings as key concepts in the <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#key-concepts">previous</a> section, well aligned with RL problem settings:</p>
<ul>
  <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-674"><span class="MJXp-mrow" id="MJXp-Span-675"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-676">S</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-762"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-763"><span class="texatom" id="MathJax-Span-764"><span class="mrow" id="MathJax-Span-765"><span class="mi" id="MathJax-Span-766" style="font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">\mathcal{S}</script> - a set of states;</li>
  <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-mrow" id="MJXp-Span-678"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-679">A</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-767"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-768"><span class="texatom" id="MathJax-Span-769"><span class="mrow" id="MathJax-Span-770"><span class="mi" id="MathJax-Span-771" style="font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">\mathcal{A}</script> - a set of actions;</li>
  <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">P</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-772"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-773"><span class="mi" id="MathJax-Span-774" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">P</script> - transition probability function;</li>
  <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">R</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-775"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-776"><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math-italic;">R</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">R</script> - reward function;</li>
  <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">γ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-778"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-779"><span class="mi" id="MathJax-Span-780" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">\gamma</script> - discounting factor for future rewards.
In an unknown environment, we do not have perfect knowledge about <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">P</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-781"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-782"><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">P</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">R</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-784"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-785"><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Math-italic;">R</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">R</script>.</li>
</ul>

<p class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/mdp_example.jpg" alt="MDP example"></p>
<p><em>Fig. 4. A fun example of Markov decision process: a typical work day. (Image source: <a href="https://randomant.net/reinforcement-learning-concepts/">randomant.net/reinforcement-learning-concepts</a>)</em></p>

<h3 id="bellman-equations">Bellman Equations</h3>

<p>Bellman equations refer to a set of equations that decompose the value function into the immediate reward plus the discounted future values.</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-690"><span class="MJXp-mtable" id="MJXp-Span-691"><span><span class="MJXp-mtr" id="MJXp-Span-692" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-693" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">V</span><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">s</span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-698" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-699"></span><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-701"><span class="MJXp-mi undefined" id="MJXp-Span-702">E</span></span><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-706" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-710" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">s</span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mtr" id="MJXp-Span-714" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-715" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-716" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-717"></span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-719"><span class="MJXp-mi undefined" id="MJXp-Span-720">E</span></span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-724" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">t</span><span class="MJXp-mo" id="MJXp-Span-726">+</span><span class="MJXp-mn" id="MJXp-Span-727">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">γ</span><span class="MJXp-msubsup" id="MJXp-Span-730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-732" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">t</span><span class="MJXp-mo" id="MJXp-Span-734">+</span><span class="MJXp-mn" id="MJXp-Span-735">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738" style="margin-right: 0.05em;">γ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-739" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-742" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">t</span><span class="MJXp-mo" id="MJXp-Span-744">+</span><span class="MJXp-mn" id="MJXp-Span-745">3</span></span></span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-747" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-751" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-752" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">s</span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mtr" id="MJXp-Span-755" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-756" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-757" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-758"></span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-760"><span class="MJXp-mi undefined" id="MJXp-Span-761">E</span></span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-765" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">t</span><span class="MJXp-mo" id="MJXp-Span-767">+</span><span class="MJXp-mn" id="MJXp-Span-768">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">γ</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-774" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">t</span><span class="MJXp-mo" id="MJXp-Span-776">+</span><span class="MJXp-mn" id="MJXp-Span-777">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">γ</span><span class="MJXp-msubsup" id="MJXp-Span-780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-782" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">t</span><span class="MJXp-mo" id="MJXp-Span-784">+</span><span class="MJXp-mn" id="MJXp-Span-785">3</span></span></span><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-788" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-792" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">s</span><span class="MJXp-mo" id="MJXp-Span-795" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mtr" id="MJXp-Span-796" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-797" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-798" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-799"></span><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-801"><span class="MJXp-mi undefined" id="MJXp-Span-802">E</span></span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-806" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">t</span><span class="MJXp-mo" id="MJXp-Span-808">+</span><span class="MJXp-mn" id="MJXp-Span-809">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-810" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">γ</span><span class="MJXp-msubsup" id="MJXp-Span-812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-814" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">t</span><span class="MJXp-mo" id="MJXp-Span-816">+</span><span class="MJXp-mn" id="MJXp-Span-817">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-821" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">s</span><span class="MJXp-mo" id="MJXp-Span-824" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mtr" id="MJXp-Span-825" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-826" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-827" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-828"></span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-830"><span class="MJXp-mi undefined" id="MJXp-Span-831">E</span></span><span class="MJXp-mo" id="MJXp-Span-832" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-835" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">t</span><span class="MJXp-mo" id="MJXp-Span-837">+</span><span class="MJXp-mn" id="MJXp-Span-838">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">V</span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-845" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">t</span><span class="MJXp-mo" id="MJXp-Span-847">+</span><span class="MJXp-mn" id="MJXp-Span-848">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-853" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">s</span><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-787"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-788"><span class="mtable" id="MathJax-Span-789" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 20.265em; height: 0px;"><span style="position: absolute; clip: rect(3.632em, 1001.92em, 10.184em, -999.997em); top: -7.256em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1001.92em, 4.388em, -999.997em); top: -6.701em; right: 0em;"><span class="mtd" id="MathJax-Span-790"><span class="mrow" id="MathJax-Span-791"><span class="mi" id="MathJax-Span-792" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-793" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-794" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-795" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000em, 4.136em, -999.997em); top: -5.239em; right: 0em;"><span class="mtd" id="MathJax-Span-814"><span class="mrow" id="MathJax-Span-815"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000em, 4.136em, -999.997em); top: -3.929em; right: 0em;"><span class="mtd" id="MathJax-Span-860"><span class="mrow" id="MathJax-Span-861"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000em, 4.136em, -999.997em); top: -2.568em; right: 0em;"><span class="mtd" id="MathJax-Span-906"><span class="mrow" id="MathJax-Span-907"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000em, 4.136em, -999.997em); top: -1.207em; right: 0em;"><span class="mtd" id="MathJax-Span-939"><span class="mrow" id="MathJax-Span-940"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.261em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1018.15em, 10.638em, -999.997em); top: -7.457em; left: 2.019em;"><span style="display: inline-block; position: relative; width: 18.248em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1006.71em, 4.388em, -999.997em); top: -6.701em; left: 0em;"><span class="mtd" id="MathJax-Span-796"><span class="mrow" id="MathJax-Span-797"><span class="mi" id="MathJax-Span-798"></span><span class="mo" id="MathJax-Span-799" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-800" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-801"><span class="mi" id="MathJax-Span-802" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-803" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-804"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-805" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-806" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-807" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-808"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-809" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-810" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-811" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-812" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-813" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.926em, 1018em, 4.388em, -999.997em); top: -5.239em; left: 0em;"><span class="mtd" id="MathJax-Span-816"><span class="mrow" id="MathJax-Span-817"><span class="mi" id="MathJax-Span-818"></span><span class="mo" id="MathJax-Span-819" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-820" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-821"><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-823" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-824"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-825" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-826"><span class="mrow" id="MathJax-Span-827"><span class="mi" id="MathJax-Span-828" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-829" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-830" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-833"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-834" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-835"><span class="mrow" id="MathJax-Span-836"><span class="mi" id="MathJax-Span-837" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-838" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-839" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-840" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="msubsup" id="MathJax-Span-841" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-842" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.607em;"><span class="mn" id="MathJax-Span-843" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-844"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-845" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-846"><span class="mrow" id="MathJax-Span-847"><span class="mi" id="MathJax-Span-848" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-849" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-850" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-851" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mo" id="MathJax-Span-852" style="font-family: MathJax_Main; padding-left: 0.204em;">…</span><span class="mo" id="MathJax-Span-853" style="font-family: MathJax_Main; padding-left: 0.154em;">|</span><span class="msubsup" id="MathJax-Span-854"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-855" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-856" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-857" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-858" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-859" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1018.15em, 4.388em, -999.997em); top: -3.929em; left: 0em;"><span class="mtd" id="MathJax-Span-862"><span class="mrow" id="MathJax-Span-863"><span class="mi" id="MathJax-Span-864"></span><span class="mo" id="MathJax-Span-865" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-866" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-867"><span class="mi" id="MathJax-Span-868" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-869" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-870"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-871" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-872"><span class="mrow" id="MathJax-Span-873"><span class="mi" id="MathJax-Span-874" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-875" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-876" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-878" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-879" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-880"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-881" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-882"><span class="mrow" id="MathJax-Span-883"><span class="mi" id="MathJax-Span-884" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-885" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-886" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-887" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-888" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-889"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-890" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-891"><span class="mrow" id="MathJax-Span-892"><span class="mi" id="MathJax-Span-893" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-894" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-895" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-896" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mo" id="MathJax-Span-897" style="font-family: MathJax_Main; padding-left: 0.204em;">…</span><span class="mo" id="MathJax-Span-898" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-899" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-900"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-901" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-902" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-903" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-905" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1011.29em, 4.388em, -999.997em); top: -2.568em; left: 0em;"><span class="mtd" id="MathJax-Span-908"><span class="mrow" id="MathJax-Span-909"><span class="mi" id="MathJax-Span-910"></span><span class="mo" id="MathJax-Span-911" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-912" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-913"><span class="mi" id="MathJax-Span-914" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-915" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-916"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-917" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-918"><span class="mrow" id="MathJax-Span-919"><span class="mi" id="MathJax-Span-920" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-921" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-922" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-923" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-924" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-925"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-926" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-927"><span class="mrow" id="MathJax-Span-928"><span class="mi" id="MathJax-Span-929" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-930" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-931" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-932" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-933"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-935" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-936" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-937" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-938" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1012.7em, 4.388em, -999.997em); top: -1.207em; left: 0em;"><span class="mtd" id="MathJax-Span-941"><span class="mrow" id="MathJax-Span-942"><span class="mi" id="MathJax-Span-943"></span><span class="mo" id="MathJax-Span-944" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-945" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-946"><span class="mi" id="MathJax-Span-947" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-948" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-949"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-950" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-951"><span class="mrow" id="MathJax-Span-952"><span class="mi" id="MathJax-Span-953" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-954" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-955" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-956" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-957" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-958" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-959" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-960"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-961" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-962"><span class="mrow" id="MathJax-Span-963"><span class="mi" id="MathJax-Span-964" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-965" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-966" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-967" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-968" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-969"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-970" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-971" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-972" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-973" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-974" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.462em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">% <![CDATA[
\begin{aligned}
V(s) &= \mathbb{E}[G_t \vert S_t = s] \\
&= \mathbb{E} [R_{t+1} + \gamma R_{t+2} + \gamma^2 R_{t+3} + \dots \vert S_t = s] \\
&= \mathbb{E} [R_{t+1} + \gamma (R_{t+2} + \gamma R_{t+3} + \dots) \vert S_t = s] \\
&= \mathbb{E} [R_{t+1} + \gamma G_{t+1} \vert S_t = s] \\
&= \mathbb{E} [R_{t+1} + \gamma V(S_{t+1}) \vert S_t = s]
\end{aligned} %]]></script>

<p>Similarly for Q-value,</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-857"><span class="MJXp-mtable" id="MJXp-Span-858"><span><span class="MJXp-mtr" id="MJXp-Span-859" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-860" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">Q</span><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">s</span><span class="MJXp-mo" id="MJXp-Span-864" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">a</span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-867" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-868"></span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-870"><span class="MJXp-mi undefined" id="MJXp-Span-871">E</span></span><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-875" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">t</span><span class="MJXp-mo" id="MJXp-Span-877">+</span><span class="MJXp-mn" id="MJXp-Span-878">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">V</span><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-885" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">t</span><span class="MJXp-mo" id="MJXp-Span-887">+</span><span class="MJXp-mn" id="MJXp-Span-888">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-893" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">s</span><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-899" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-900" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">a</span><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mtr" id="MJXp-Span-903" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-904" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-905" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-906"></span><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-908"><span class="MJXp-mi undefined" id="MJXp-Span-909">E</span></span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-913" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">t</span><span class="MJXp-mo" id="MJXp-Span-915">+</span><span class="MJXp-mn" id="MJXp-Span-916">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">γ</span><span class="MJXp-msubsup" id="MJXp-Span-919"><span class="MJXp-mrow" id="MJXp-Span-920" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-921">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-922" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">a</span><span class="MJXp-mo" id="MJXp-Span-924">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">π</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">Q</span><span class="MJXp-mo" id="MJXp-Span-927" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-930" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">t</span><span class="MJXp-mo" id="MJXp-Span-932">+</span><span class="MJXp-mn" id="MJXp-Span-933">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-934" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">a</span><span class="MJXp-mo" id="MJXp-Span-936" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.333em; margin-right: 0.333em;">∣</span><span class="MJXp-msubsup" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-940" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">s</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-944"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-946" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">a</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-975"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-976"><span class="mtable" id="MathJax-Span-977" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 22.886em; height: 0px;"><span style="position: absolute; clip: rect(2.422em, 1002.93em, 4.841em, -999.997em); top: -3.979em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1002.93em, 4.388em, -999.997em); top: -4.635em; right: 0em;"><span class="mtd" id="MathJax-Span-978"><span class="mrow" id="MathJax-Span-979"><span class="mi" id="MathJax-Span-980" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-981" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-982" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-983" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-984" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-985" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000em, 4.136em, -999.997em); top: -3.274em; right: 0em;"><span class="mtd" id="MathJax-Span-1026"><span class="mrow" id="MathJax-Span-1027"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.422em, 1019.76em, 5.093em, -999.997em); top: -3.979em; left: 3.027em;"><span style="display: inline-block; position: relative; width: 19.912em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1016.74em, 4.388em, -999.997em); top: -4.635em; left: 0em;"><span class="mtd" id="MathJax-Span-986"><span class="mrow" id="MathJax-Span-987"><span class="mi" id="MathJax-Span-988"></span><span class="mo" id="MathJax-Span-989" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-990" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-991"><span class="mi" id="MathJax-Span-992" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-993" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-994"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-995" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-996"><span class="mrow" id="MathJax-Span-997"><span class="mi" id="MathJax-Span-998" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-999" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1000" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1001" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1002" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1003" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-1004" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1005"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1006" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1007"><span class="mrow" id="MathJax-Span-1008"><span class="mi" id="MathJax-Span-1009" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1010" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1011" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1012" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1013" style="font-family: MathJax_Main; padding-left: 0.305em;">∣</span><span class="msubsup" id="MathJax-Span-1014" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1015" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1016" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1017" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1018" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-1019" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1020" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1021" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-1022" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1023" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1024" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-1025" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1019.76em, 4.388em, -999.997em); top: -3.274em; left: 0em;"><span class="mtd" id="MathJax-Span-1028"><span class="mrow" id="MathJax-Span-1029"><span class="mi" id="MathJax-Span-1030"></span><span class="mo" id="MathJax-Span-1031" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-1032" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-1033"><span class="mi" id="MathJax-Span-1034" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-1035" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1036"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1037" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-1038"><span class="mrow" id="MathJax-Span-1039"><span class="mi" id="MathJax-Span-1040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1041" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1042" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1043" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1044" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1045"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-1046"><span class="mrow" id="MathJax-Span-1047"><span class="mi" id="MathJax-Span-1048" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="texatom" id="MathJax-Span-1049"><span class="mrow" id="MathJax-Span-1050"><span class="mi" id="MathJax-Span-1051" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1052" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-1054" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-1055" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1056"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1057" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1058"><span class="mrow" id="MathJax-Span-1059"><span class="mi" id="MathJax-Span-1060" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1061" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1062" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1063" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1065" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1066" style="font-family: MathJax_Main; padding-left: 0.305em;">∣</span><span class="msubsup" id="MathJax-Span-1067" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1068" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1069" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1070" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1071" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-1072" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1073" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1074" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-1075" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1076" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1077" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-1078" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-46">% <![CDATA[
\begin{aligned}
Q(s, a) 
&= \mathbb{E} [R_{t+1} + \gamma V(S_{t+1}) \mid S_t = s, A_t = a] \\
&= \mathbb{E} [R_{t+1} + \gamma \mathbb{E}_{a\sim\pi} Q(S_{t+1}, a) \mid S_t = s, A_t = a]
\end{aligned} %]]></script>

<h4 id="bellman-expectation-equations">Bellman Expectation Equations</h4>

<p>The recursive update process can be further decomposed to be equations built on both state-value and action-value functions. As we go further in future action steps, we extend V and Q alternatively by following the policy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">π</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1079"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1080"><span class="mi" id="MathJax-Span-1081" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">\pi</script>.</p>

<p style="width: 60%;" class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/bellman_equation.png" alt="Bellman"></p>
<p><em>Fig. 5. Illustration of how Bellman expection equations update state-value and action-value functions.</em></p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-952"><span class="MJXp-mtable" id="MJXp-Span-953"><span><span class="MJXp-mtr" id="MJXp-Span-954" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-955" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-958" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-960" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">s</span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-963" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-964"></span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-966"><span class=""><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-968" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">a</span><span class="MJXp-mo" id="MJXp-Span-970">∈</span><span class="MJXp-mrow" id="MJXp-Span-971"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-972">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">π</span><span class="MJXp-mo" id="MJXp-Span-974" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">a</span><span class="MJXp-mo" id="MJXp-Span-976" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">s</span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-981" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">s</span><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">a</span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-988" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-989" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-990"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-992" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">s</span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">a</span><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-999" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1000"></span><span class="MJXp-mo" id="MJXp-Span-1001" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">R</span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">s</span><span class="MJXp-mo" id="MJXp-Span-1005" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">a</span><span class="MJXp-mo" id="MJXp-Span-1007" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">γ</span><span class="MJXp-munderover" id="MJXp-Span-1010"><span class=""><span class="MJXp-mo" id="MJXp-Span-1011" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1012" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1015" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1016">∈</span><span class="MJXp-mrow" id="MJXp-Span-1017"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1018">S</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">a</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">s</span><span class="MJXp-msup" id="MJXp-Span-1023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1025" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1029" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1034" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1036" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1037" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1040" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">s</span><span class="MJXp-mo" id="MJXp-Span-1044" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1045" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1046"></span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1048"><span class=""><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1050" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">a</span><span class="MJXp-mo" id="MJXp-Span-1052">∈</span><span class="MJXp-mrow" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1054">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">π</span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">a</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">s</span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1061"><span class="MJXp-mo" id="MJXp-Span-1062" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">R</span><span class="MJXp-mo" id="MJXp-Span-1064" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">s</span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">a</span><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">γ</span><span class="MJXp-munderover" id="MJXp-Span-1071"><span class=""><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1073" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1076" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1077">∈</span><span class="MJXp-mrow" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1079">S</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">a</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1082"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">s</span><span class="MJXp-msup" id="MJXp-Span-1084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1086" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1090" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1095" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1097"><span class="MJXp-mo" id="MJXp-Span-1098" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-1099" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1100" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1103" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-1105" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">s</span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">a</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1110" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1111"></span><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">R</span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">s</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">a</span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">γ</span><span class="MJXp-munderover" id="MJXp-Span-1121"><span class=""><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1123" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1126" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1127">∈</span><span class="MJXp-mrow" id="MJXp-Span-1128"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1129">S</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">a</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">s</span><span class="MJXp-msup" id="MJXp-Span-1134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1136" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1138"><span class=""><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1140" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1143" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1144">∈</span><span class="MJXp-mrow" id="MJXp-Span-1145"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1146">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">π</span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1151" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msup" id="MJXp-Span-1153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1155" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1159" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">π</span></span></span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1164" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1165" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-1166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1168" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1169" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1082"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1083"><span class="mtable" id="MathJax-Span-1084" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 21.978em; height: 0px;"><span style="position: absolute; clip: rect(4.488em, 1003.38em, 13.359em, -999.997em); top: -9.574em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.48em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1002.22em, 4.388em, -999.997em); top: -8.213em; right: 0em;"><span class="mtd" id="MathJax-Span-1085"><span class="mrow" id="MathJax-Span-1086"><span class="msubsup" id="MathJax-Span-1087"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1088" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1089"><span class="mrow" id="MathJax-Span-1090"><span class="mi" id="MathJax-Span-1091" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1092" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1093" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1094" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1003.38em, 4.388em, -999.997em); top: -5.693em; right: 0em;"><span class="mtd" id="MathJax-Span-1124"><span class="mrow" id="MathJax-Span-1125"><span class="msubsup" id="MathJax-Span-1126"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1127" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-1128"><span class="mrow" id="MathJax-Span-1129"><span class="mi" id="MathJax-Span-1130" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1131" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1132" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1133" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1134" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1135" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1002.22em, 4.388em, -999.997em); top: -3.122em; right: 0em;"><span class="mtd" id="MathJax-Span-1178"><span class="mrow" id="MathJax-Span-1179"><span class="msubsup" id="MathJax-Span-1180"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1181" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1182"><span class="mrow" id="MathJax-Span-1183"><span class="mi" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1185" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1186" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1187" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1003.38em, 4.388em, -999.997em); top: -0.602em; right: 0em;"><span class="mtd" id="MathJax-Span-1251"><span class="mrow" id="MathJax-Span-1252"><span class="msubsup" id="MathJax-Span-1253"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1254" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-1255"><span class="mrow" id="MathJax-Span-1256"><span class="mi" id="MathJax-Span-1257" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1258" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1259" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1260" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1262" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.579em;"></span></span><span style="position: absolute; clip: rect(5.547em, 1018.45em, 15.628em, -999.997em); top: -10.834em; left: 3.48em;"><span style="display: inline-block; position: relative; width: 18.501em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1009.02em, 5.396em, -999.997em); top: -8.213em; left: 0em;"><span class="mtd" id="MathJax-Span-1095"><span class="mrow" id="MathJax-Span-1096"><span class="mi" id="MathJax-Span-1097"></span><span class="mo" id="MathJax-Span-1098" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-1099" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1100" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1101"><span class="mrow" id="MathJax-Span-1102"><span class="mi" id="MathJax-Span-1103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1104" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1105"><span class="mrow" id="MathJax-Span-1106"><span class="mi" id="MathJax-Span-1107" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-1108" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1109" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1110" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1111" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-1112" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1113" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1114"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1115" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-1116"><span class="mrow" id="MathJax-Span-1117"><span class="mi" id="MathJax-Span-1118" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1119" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1120" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1121" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1122" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1123" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1011.9em, 5.396em, -999.997em); top: -5.693em; left: 0em;"><span class="mtd" id="MathJax-Span-1136"><span class="mrow" id="MathJax-Span-1137"><span class="mi" id="MathJax-Span-1138"></span><span class="mo" id="MathJax-Span-1139" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1140" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">R</span><span class="mo" id="MathJax-Span-1141" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1142" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1143" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1144" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1145" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1146" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1147" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-1148" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1149" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.46em, 4.287em, -999.997em); top: -2.82em; left: 0em;"><span class="texatom" id="MathJax-Span-1150"><span class="mrow" id="MathJax-Span-1151"><span class="msup" id="MathJax-Span-1152"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1153" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1154" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1155" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1156"><span class="mrow" id="MathJax-Span-1157"><span class="mi" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1159" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1160" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.859em;"><span class="mi" id="MathJax-Span-1161" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.91em, 4.136em, -999.997em); top: -3.677em; left: 0.658em;"><span class="texatom" id="MathJax-Span-1162"><span class="mrow" id="MathJax-Span-1163"><span class="mi" id="MathJax-Span-1164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="msup" id="MathJax-Span-1165"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1166" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.355em;"><span class="mo" id="MathJax-Span-1167" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1168"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1169" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1170"><span class="mrow" id="MathJax-Span-1171"><span class="mi" id="MathJax-Span-1172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1173" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1174"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1175" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1176" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1177" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1016.99em, 5.396em, -999.997em); top: -3.122em; left: 0em;"><span class="mtd" id="MathJax-Span-1188"><span class="mrow" id="MathJax-Span-1189"><span class="mi" id="MathJax-Span-1190"></span><span class="mo" id="MathJax-Span-1191" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-1192" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1193" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1194"><span class="mrow" id="MathJax-Span-1195"><span class="mi" id="MathJax-Span-1196" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1197" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1198"><span class="mrow" id="MathJax-Span-1199"><span class="mi" id="MathJax-Span-1200" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-1201" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1202" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1203" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1204" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-1205" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1206" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1207" style=""><span class="mrow" id="MathJax-Span-1208"><span class="mo" id="MathJax-Span-1209" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span><span class="mi" id="MathJax-Span-1210" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-1211" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1212" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1213" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1214" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1215" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1216" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1217" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-1218" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1219" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.46em, 4.287em, -999.997em); top: -2.82em; left: 0em;"><span class="texatom" id="MathJax-Span-1220"><span class="mrow" id="MathJax-Span-1221"><span class="msup" id="MathJax-Span-1222"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1223" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1224" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1225" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1226"><span class="mrow" id="MathJax-Span-1227"><span class="mi" id="MathJax-Span-1228" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1229" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1230" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.859em;"><span class="mi" id="MathJax-Span-1231" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.91em, 4.136em, -999.997em); top: -3.677em; left: 0.658em;"><span class="texatom" id="MathJax-Span-1232"><span class="mrow" id="MathJax-Span-1233"><span class="mi" id="MathJax-Span-1234" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="msup" id="MathJax-Span-1235"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1236" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.355em;"><span class="mo" id="MathJax-Span-1237" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1238"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1239" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1240"><span class="mrow" id="MathJax-Span-1241"><span class="mi" id="MathJax-Span-1242" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1243" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1244"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1245" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1246" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1247" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1248" style=""><span class="mrow" id="MathJax-Span-1249"><span class="mo" id="MathJax-Span-1250" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1018.45em, 5.446em, -999.997em); top: -0.602em; left: 0em;"><span class="mtd" id="MathJax-Span-1263"><span class="mrow" id="MathJax-Span-1264"><span class="mi" id="MathJax-Span-1265"></span><span class="mo" id="MathJax-Span-1266" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1267" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">R</span><span class="mo" id="MathJax-Span-1268" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1269" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1270" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1271" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1272" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1273" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-1275" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1276" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.46em, 4.287em, -999.997em); top: -2.82em; left: 0em;"><span class="texatom" id="MathJax-Span-1277"><span class="mrow" id="MathJax-Span-1278"><span class="msup" id="MathJax-Span-1279"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1281" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1282" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1283"><span class="mrow" id="MathJax-Span-1284"><span class="mi" id="MathJax-Span-1285" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1286" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1287" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.859em;"><span class="mi" id="MathJax-Span-1288" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.91em, 4.136em, -999.997em); top: -3.677em; left: 0.658em;"><span class="texatom" id="MathJax-Span-1289"><span class="mrow" id="MathJax-Span-1290"><span class="mi" id="MathJax-Span-1291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="msup" id="MathJax-Span-1292"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1293" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.355em;"><span class="mo" id="MathJax-Span-1294" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1295" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.615em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0.103em;"><span class="mo" id="MathJax-Span-1296" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.62em, 4.287em, -999.997em); top: -2.82em; left: 0em;"><span class="texatom" id="MathJax-Span-1297"><span class="mrow" id="MathJax-Span-1298"><span class="msup" id="MathJax-Span-1299"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1300" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1301" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1302" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1303"><span class="mrow" id="MathJax-Span-1304"><span class="mi" id="MathJax-Span-1305" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-1306" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1307" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1308"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1309" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.507em;"><span class="mo" id="MathJax-Span-1310" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1311" style="font-family: MathJax_Main;">|</span><span class="msup" id="MathJax-Span-1312"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1313" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1315" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-1316"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1317" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-1318"><span class="mrow" id="MathJax-Span-1319"><span class="mi" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1321" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1322"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1323" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1324" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1325" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-1326" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1327" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.507em;"><span class="mo" id="MathJax-Span-1328" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1329" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.839em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">% <![CDATA[
\begin{aligned}
V_{\pi}(s) &= \sum_{a \in \mathcal{A}} \pi(a \vert s) Q_{\pi}(s, a) \\
Q_{\pi}(s, a) &= R(s, a) + \gamma \sum_{s' \in \mathcal{S}} P_{ss'}^a V_{\pi} (s') \\
V_{\pi}(s) &= \sum_{a \in \mathcal{A}} \pi(a \vert s) \big( R(s, a) + \gamma \sum_{s' \in \mathcal{S}} P_{ss'}^a V_{\pi} (s') \big) \\
Q_{\pi}(s, a) &= R(s, a) + \gamma \sum_{s' \in \mathcal{S}} P_{ss'}^a \sum_{a' \in \mathcal{A}} \pi(a' \vert s') Q_{\pi} (s', a')
\end{aligned} %]]></script>

<h4 id="bellman-optimality-equations">Bellman Optimality Equations</h4>

<p>If we are only interested in the optimal values, rather than computing the expectation following a policy, we could jump right into the maximum returns during the alternative updates without using a policy. RECAP: the optimal values <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1170"><span class="MJXp-msubsup" id="MJXp-Span-1171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172" style="margin-right: 0.05em;">V</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1173" style="vertical-align: -0.4em;">∗</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1330"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1331"><span class="msubsup" id="MathJax-Span-1332"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1333" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mo" id="MathJax-Span-1334" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">V_*</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1174"><span class="MJXp-msubsup" id="MJXp-Span-1175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176" style="margin-right: 0.05em;">Q</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1177" style="vertical-align: -0.4em;">∗</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1335"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1336"><span class="msubsup" id="MathJax-Span-1337"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1338" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mo" id="MathJax-Span-1339" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">Q_*</script> are the best returns we can obtain, defined <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#optimal-value-and-policy">here</a>.</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1178"><span class="MJXp-mtable" id="MJXp-Span-1179"><span><span class="MJXp-mtr" id="MJXp-Span-1180" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1181" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183" style="margin-right: 0.05em;">V</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1184" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">s</span><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1188" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1189"></span><span class="MJXp-mo" id="MJXp-Span-1190" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1191"><span class=""><span class="MJXp-mo" id="MJXp-Span-1192" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1193" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">a</span><span class="MJXp-mo" id="MJXp-Span-1195">∈</span><span class="MJXp-mrow" id="MJXp-Span-1196"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1197">A</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199" style="margin-right: 0.05em;">Q</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1200" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">s</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">a</span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1206" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1207" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209" style="margin-right: 0.05em;">Q</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1210" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1211" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">s</span><span class="MJXp-mo" id="MJXp-Span-1213" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">a</span><span class="MJXp-mo" id="MJXp-Span-1215" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1216" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1217"></span><span class="MJXp-mo" id="MJXp-Span-1218" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">R</span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">s</span><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">a</span><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">γ</span><span class="MJXp-munderover" id="MJXp-Span-1227"><span class=""><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1229" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1232" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1233">∈</span><span class="MJXp-mrow" id="MJXp-Span-1234"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1235">S</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">a</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">s</span><span class="MJXp-msup" id="MJXp-Span-1240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1242" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245" style="margin-right: 0.05em;">V</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1246" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1250" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1252" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1253" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255" style="margin-right: 0.05em;">V</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1256" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">s</span><span class="MJXp-mo" id="MJXp-Span-1259" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1260" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1261"></span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1263"><span class=""><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1265" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">a</span><span class="MJXp-mo" id="MJXp-Span-1267">∈</span><span class="MJXp-mrow" id="MJXp-Span-1268"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1269">A</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1270"><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">R</span><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">s</span><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">a</span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">γ</span><span class="MJXp-munderover" id="MJXp-Span-1280"><span class=""><span class="MJXp-mo" id="MJXp-Span-1281" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1282" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1285" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1286">∈</span><span class="MJXp-mrow" id="MJXp-Span-1287"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1288">S</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">a</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">s</span><span class="MJXp-msup" id="MJXp-Span-1293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1295" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298" style="margin-right: 0.05em;">V</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1299" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1303" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1304" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1305"><span class="MJXp-mo" id="MJXp-Span-1306" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-1307" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1308" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310" style="margin-right: 0.05em;">Q</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1311" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">s</span><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">a</span><span class="MJXp-mo" id="MJXp-Span-1316" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1317" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1318"></span><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">R</span><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">s</span><span class="MJXp-mo" id="MJXp-Span-1323" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">a</span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1326" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">γ</span><span class="MJXp-munderover" id="MJXp-Span-1328"><span class=""><span class="MJXp-mo" id="MJXp-Span-1329" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1330" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1333" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1334">∈</span><span class="MJXp-mrow" id="MJXp-Span-1335"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1336">S</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">a</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">s</span><span class="MJXp-msup" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1343" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1345"><span class=""><span class="MJXp-mo" id="MJXp-Span-1346" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1347" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1350" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1351">∈</span><span class="MJXp-mrow" id="MJXp-Span-1352"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1353">A</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355" style="margin-right: 0.05em;">Q</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1356" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-1357" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1360" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-1362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1364" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1365" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1340"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1341"><span class="mtable" id="MathJax-Span-1342" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 18.954em; height: 0px;"><span style="position: absolute; clip: rect(4.186em, 1003.33em, 12.603em, -999.997em); top: -9.12em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.43em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1002.17em, 4.388em, -999.997em); top: -8.062em; right: 0em;"><span class="mtd" id="MathJax-Span-1343"><span class="mrow" id="MathJax-Span-1344"><span class="msubsup" id="MathJax-Span-1345"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1346" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mo" id="MathJax-Span-1347" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1348" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1349" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1350" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1003.33em, 4.388em, -999.997em); top: -5.945em; right: 0em;"><span class="mtd" id="MathJax-Span-1372"><span class="mrow" id="MathJax-Span-1373"><span class="msubsup" id="MathJax-Span-1374"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1375" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mo" id="MathJax-Span-1376" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1377" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1378" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1379" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1380" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1381" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1002.17em, 4.388em, -999.997em); top: -3.425em; right: 0em;"><span class="mtd" id="MathJax-Span-1422"><span class="mrow" id="MathJax-Span-1423"><span class="msubsup" id="MathJax-Span-1424"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1425" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mo" id="MathJax-Span-1426" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1427" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1428" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1429" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1003.33em, 4.388em, -999.997em); top: -0.905em; right: 0em;"><span class="mtd" id="MathJax-Span-1485"><span class="mrow" id="MathJax-Span-1486"><span class="msubsup" id="MathJax-Span-1487"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1488" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mo" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1490" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1491" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1492" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1493" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1494" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.126em;"></span></span><span style="position: absolute; clip: rect(5.244em, 1015.48em, 14.72em, -999.997em); top: -10.179em; left: 3.43em;"><span style="display: inline-block; position: relative; width: 15.527em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1006.76em, 4.942em, -999.997em); top: -8.062em; left: 0em;"><span class="mtd" id="MathJax-Span-1351"><span class="mrow" id="MathJax-Span-1352"><span class="mi" id="MathJax-Span-1353"></span><span class="mo" id="MathJax-Span-1354" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-1355" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1356" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -3.274em; left: 0.204em;"><span class="texatom" id="MathJax-Span-1357"><span class="mrow" id="MathJax-Span-1358"><span class="mi" id="MathJax-Span-1359" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1360" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1361"><span class="mrow" id="MathJax-Span-1362"><span class="mi" id="MathJax-Span-1363" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1364" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1365" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mo" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1367" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1368" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1369" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1370" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1371" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1011.85em, 5.396em, -999.997em); top: -5.945em; left: 0em;"><span class="mtd" id="MathJax-Span-1382"><span class="mrow" id="MathJax-Span-1383"><span class="mi" id="MathJax-Span-1384"></span><span class="mo" id="MathJax-Span-1385" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1386" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">R</span><span class="mo" id="MathJax-Span-1387" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1388" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1389" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1390" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1391" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1392" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1393" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-1394" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1395" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.46em, 4.287em, -999.997em); top: -2.82em; left: 0em;"><span class="texatom" id="MathJax-Span-1396"><span class="mrow" id="MathJax-Span-1397"><span class="msup" id="MathJax-Span-1398"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1399" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1400" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1401" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1402"><span class="mrow" id="MathJax-Span-1403"><span class="mi" id="MathJax-Span-1404" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1405" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1406" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.859em;"><span class="mi" id="MathJax-Span-1407" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.91em, 4.136em, -999.997em); top: -3.677em; left: 0.658em;"><span class="texatom" id="MathJax-Span-1408"><span class="mrow" id="MathJax-Span-1409"><span class="mi" id="MathJax-Span-1410" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="msup" id="MathJax-Span-1411"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1412" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.355em;"><span class="mo" id="MathJax-Span-1413" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1414"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1415" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mo" id="MathJax-Span-1416" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1417" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1418"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1419" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1420" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1421" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1014.72em, 5.396em, -999.997em); top: -3.425em; left: 0em;"><span class="mtd" id="MathJax-Span-1430"><span class="mrow" id="MathJax-Span-1431"><span class="mi" id="MathJax-Span-1432"></span><span class="mo" id="MathJax-Span-1433" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-1434" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1435" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -3.274em; left: 0.204em;"><span class="texatom" id="MathJax-Span-1436"><span class="mrow" id="MathJax-Span-1437"><span class="mi" id="MathJax-Span-1438" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1439" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1440"><span class="mrow" id="MathJax-Span-1441"><span class="mi" id="MathJax-Span-1442" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1443" style="padding-left: 0.154em;"><span class="mrow" id="MathJax-Span-1444"><span class="mo" id="MathJax-Span-1445" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span><span class="mi" id="MathJax-Span-1446" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-1447" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1448" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1449" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1450" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1451" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1452" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1453" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-1454" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1455" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.46em, 4.287em, -999.997em); top: -2.82em; left: 0em;"><span class="texatom" id="MathJax-Span-1456"><span class="mrow" id="MathJax-Span-1457"><span class="msup" id="MathJax-Span-1458"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1459" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1460" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1461" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1462"><span class="mrow" id="MathJax-Span-1463"><span class="mi" id="MathJax-Span-1464" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1465" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1466" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.859em;"><span class="mi" id="MathJax-Span-1467" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.91em, 4.136em, -999.997em); top: -3.677em; left: 0.658em;"><span class="texatom" id="MathJax-Span-1468"><span class="mrow" id="MathJax-Span-1469"><span class="mi" id="MathJax-Span-1470" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="msup" id="MathJax-Span-1471"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1472" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.355em;"><span class="mo" id="MathJax-Span-1473" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1474"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1475" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mo" id="MathJax-Span-1476" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1477" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1478"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1479" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1480" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1481" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1482" style=""><span class="mrow" id="MathJax-Span-1483"><span class="mo" id="MathJax-Span-1484" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1015.48em, 5.396em, -999.997em); top: -0.905em; left: 0em;"><span class="mtd" id="MathJax-Span-1495"><span class="mrow" id="MathJax-Span-1496"><span class="mi" id="MathJax-Span-1497"></span><span class="mo" id="MathJax-Span-1498" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1499" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">R</span><span class="mo" id="MathJax-Span-1500" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1501" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1502" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1503" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1504" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1505" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1506" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-1507" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1508" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.46em, 4.287em, -999.997em); top: -2.82em; left: 0em;"><span class="texatom" id="MathJax-Span-1509"><span class="mrow" id="MathJax-Span-1510"><span class="msup" id="MathJax-Span-1511"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1512" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1513" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1514" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1515"><span class="mrow" id="MathJax-Span-1516"><span class="mi" id="MathJax-Span-1517" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1518" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1519" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.859em;"><span class="mi" id="MathJax-Span-1520" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.91em, 4.136em, -999.997em); top: -3.677em; left: 0.658em;"><span class="texatom" id="MathJax-Span-1521"><span class="mrow" id="MathJax-Span-1522"><span class="mi" id="MathJax-Span-1523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="msup" id="MathJax-Span-1524"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1525" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.355em;"><span class="mo" id="MathJax-Span-1526" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1527" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1528" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.62em, 4.287em, -999.997em); top: -3.274em; left: 0.103em;"><span class="texatom" id="MathJax-Span-1529"><span class="mrow" id="MathJax-Span-1530"><span class="msup" id="MathJax-Span-1531"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1532" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1533" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1534" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1535"><span class="mrow" id="MathJax-Span-1536"><span class="mi" id="MathJax-Span-1537" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1538" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1539" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mo" id="MathJax-Span-1540" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1541" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1542"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1543" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1544" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1545" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-1546" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1547" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.507em;"><span class="mo" id="MathJax-Span-1548" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1549" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 10.184em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-51">% <![CDATA[
\begin{aligned}
V_*(s) &= \max_{a \in \mathcal{A}} Q_*(s,a)\\
Q_*(s, a) &= R(s, a) + \gamma \sum_{s' \in \mathcal{S}} P_{ss'}^a V_*(s') \\
V_*(s) &= \max_{a \in \mathcal{A}} \big( R(s, a) + \gamma \sum_{s' \in \mathcal{S}} P_{ss'}^a V_*(s') \big) \\
Q_*(s, a) &= R(s, a) + \gamma \sum_{s' \in \mathcal{S}} P_{ss'}^a \max_{a' \in \mathcal{A}} Q_*(s', a')
\end{aligned} %]]></script>

<p>Unsurprisingly they look very similar to Bellman expectation equations.</p>

<p>If we have complete information of the environment, this turns into a planning problem, solvable by DP. Unfortunately, in most scenarios, we do not know <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1366"><span class="MJXp-msubsup" id="MJXp-Span-1367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368" style="margin-right: 0.05em;">P</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">a</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">s</span><span class="MJXp-msup" id="MJXp-Span-1371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1373" style="vertical-align: 0.5em;">′</span></span></span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1550"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1551"><span class="msubsup" id="MathJax-Span-1552"><span style="display: inline-block; position: relative; width: 1.565em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1553" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.46em, 4.136em, -999.997em); top: -4.332em; left: 0.859em;"><span class="mi" id="MathJax-Span-1554" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.91em, 4.136em, -999.997em); top: -3.677em; left: 0.658em;"><span class="texatom" id="MathJax-Span-1555"><span class="mrow" id="MathJax-Span-1556"><span class="mi" id="MathJax-Span-1557" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="msup" id="MathJax-Span-1558"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1559" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.355em;"><span class="mo" id="MathJax-Span-1560" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">P_{ss'}^a</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">R</span><span class="MJXp-mo" id="MJXp-Span-1377" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">s</span><span class="MJXp-mo" id="MJXp-Span-1379" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">a</span><span class="MJXp-mo" id="MJXp-Span-1381" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1561"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1562"><span class="mi" id="MathJax-Span-1563" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-1564" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1565" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1566" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1567" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1568" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">R(s, a)</script>, so we cannot solve MDPs by directly applying Bellmen equations, but it lays the theoretical foundation for many RL algorithms.</p>

<h2 id="common-approaches">Common Approaches</h2>

<p>Now it is the time to go through the major approaches and classic algorithms for solving RL problems. In future posts, I plan to dive into each approach further.</p>

<h3 id="dynamic-programming">Dynamic Programming</h3>

<p>When the model is fully known, following Bellman equations, we can use <a href="https://en.wikipedia.org/wiki/Dynamic_programming">Dynamic Programming</a> (DP) to iteratively evaluate value functions and improve policy.</p>

<h4 id="policy-evaluation">Policy Evaluation</h4>

<p>Policy Evaluation is to compute the state-value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1382"><span class="MJXp-msubsup" id="MJXp-Span-1383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1385" style="vertical-align: -0.4em;">π</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1569"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1570"><span class="msubsup" id="MathJax-Span-1571"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1572" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1573" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">V_\pi</script> for a given policy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">π</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1574"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1575"><span class="mi" id="MathJax-Span-1576" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">\pi</script>:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1388"><span class="MJXp-msubsup" id="MJXp-Span-1389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1391" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">t</span><span class="MJXp-mo" id="MJXp-Span-1393">+</span><span class="MJXp-mn" id="MJXp-Span-1394">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">s</span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1398" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1399"><span class="MJXp-mrow" id="MJXp-Span-1400" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1401">E</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1402" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1403" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">r</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">γ</span><span class="MJXp-msubsup" id="MJXp-Span-1407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1409" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1413" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1414" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1415"><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1419" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">s</span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1424"><span class=""><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426" style="margin-left: 0px;">a</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">π</span><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">a</span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">s</span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-1433"><span class=""><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1435" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1438" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1439">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">r</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">P</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1445" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1446" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">r</span><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">s</span><span class="MJXp-mo" id="MJXp-Span-1450" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">a</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">r</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">γ</span><span class="MJXp-msubsup" id="MJXp-Span-1457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1459" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1460" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1463" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1464" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1465" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1577"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1578"><span class="msubsup" id="MathJax-Span-1579"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1580" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1581"><span class="mrow" id="MathJax-Span-1582"><span class="mi" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1584" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1585" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1586" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1587" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1588" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1589" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-1590" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-1591"><span class="mrow" id="MathJax-Span-1592"><span class="mi" id="MathJax-Span-1593" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-1594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1595" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1596" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-1597" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1598" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1599"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1600" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1601" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1602" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1603"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1604" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1605" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1606" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1607"><span class="mrow" id="MathJax-Span-1608"><span class="mo" id="MathJax-Span-1609" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1610"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1611" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1612" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1613" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1614" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-1615" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1616" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-1617" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1618" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.236em, -999.997em); top: -2.921em; left: 0.557em;"><span class="mi" id="MathJax-Span-1619" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-1620" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1621" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1622" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1623" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-1624" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1625" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-1626" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1627" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.01em, 4.388em, -999.997em); top: -2.82em; left: 0.204em;"><span class="texatom" id="MathJax-Span-1628"><span class="mrow" id="MathJax-Span-1629"><span class="msup" id="MathJax-Span-1630"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1631" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1632" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1633" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1634" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-1635" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-1636" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1637"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1638" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1639" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1640" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1641" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">r</span><span class="mo" id="MathJax-Span-1642" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-1643" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1644" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1645" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1646" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1647" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1648" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-1649" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1650" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1651"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1652" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1653" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1654" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1655"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1656" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1657" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1658" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1659" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-56">V_{t+1}(s) 
= \mathbb{E}_\pi [r + \gamma V_t(s') | S_t = s]
= \sum_a \pi(a \vert s) \sum_{s', r} P(s', r \vert s, a) (r + \gamma V_k(s'))</script>

<h4 id="policy-improvement">Policy Improvement</h4>

<p>Based on the value functions, Policy Improvement generates a better policy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-msup" id="MJXp-Span-1467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468" style="margin-right: 0.05em;">π</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1469" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">π</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-57-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1660"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1661"><span class="msup" id="MathJax-Span-1662"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1663" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.607em;"><span class="mo" id="MathJax-Span-1664" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1665" style="font-family: MathJax_Main; padding-left: 0.305em;">≥</span><span class="mi" id="MathJax-Span-1666" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">\pi' \geq \pi</script> by acting greedily.</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1472"><span class="MJXp-msubsup" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1475" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">s</span><span class="MJXp-mo" id="MJXp-Span-1478" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">a</span><span class="MJXp-mo" id="MJXp-Span-1480" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1481" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1482"><span class="MJXp-mi undefined" id="MJXp-Span-1483">E</span></span><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1487" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">t</span><span class="MJXp-mo" id="MJXp-Span-1489">+</span><span class="MJXp-mn" id="MJXp-Span-1490">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">γ</span><span class="MJXp-msubsup" id="MJXp-Span-1493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1495" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1499" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">t</span><span class="MJXp-mo" id="MJXp-Span-1501">+</span><span class="MJXp-mn" id="MJXp-Span-1502">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1504" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-1505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1507" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">s</span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1513" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1514" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">a</span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1518"><span class=""><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1520" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-1521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1523" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1524">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">r</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">P</span><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1530" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">r</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">s</span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">a</span><span class="MJXp-mo" id="MJXp-Span-1537" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">r</span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">γ</span><span class="MJXp-msubsup" id="MJXp-Span-1542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1544" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-1546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1548" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1549" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1667"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1668"><span class="msubsup" id="MathJax-Span-1669"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1670" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1671" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1672" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1673" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1674" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1675" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1676" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1677" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-1678" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-1679"><span class="mi" id="MathJax-Span-1680" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-1681" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1682"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1683" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-1684"><span class="mrow" id="MathJax-Span-1685"><span class="mi" id="MathJax-Span-1686" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1687" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1688" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1689" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1690" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1691"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1692" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1693" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1694" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1695"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1696" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1697"><span class="mrow" id="MathJax-Span-1698"><span class="mi" id="MathJax-Span-1699" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1700" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1701" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1702" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1703" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-1704"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1705" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1706" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1707" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1708" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-1709" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1710" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1711" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-1712" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1713" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1714" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-1715" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1716" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-1717" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1718" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.01em, 4.388em, -999.997em); top: -2.82em; left: 0.204em;"><span class="texatom" id="MathJax-Span-1719"><span class="mrow" id="MathJax-Span-1720"><span class="msup" id="MathJax-Span-1721"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1722" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-1723" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1724" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1725" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-1726" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-1727" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1728"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1729" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1730" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1731" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1732" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">r</span><span class="mo" id="MathJax-Span-1733" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-1734" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1735" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1736" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1737" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1738" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1739" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-1740" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-1741" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1742"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1743" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1744" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1745" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-1746"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1747" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-1748" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1749" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1750" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-58">Q_\pi(s, a) 
= \mathbb{E} [R_{t+1} + \gamma V_\pi(S_{t+1}) \vert S_t=s, A_t=a]
= \sum_{s', r} P(s', r \vert s, a) (r + \gamma V_\pi(s'))</script>

<h4 id="policy-iteration">Policy Iteration</h4>

<p>The <em>Generalized Policy Iteration (GPI)</em> algorithm refers to an iterative procedure to improve the policy when combining policy evaluation and improvement.</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1551"><span class="MJXp-msubsup" id="MJXp-Span-1552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553" style="margin-right: 0.05em;">π</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1554" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-munderover" id="MJXp-Span-1555"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mpadded" id="MJXp-Span-1557" style="vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;"><span class="MJXp-box" style="margin: -0.15em 0.333em 0.15em 0.278em;"><span class="MJXp-mtext" id="MJXp-Span-1558">evaluation</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0.333em; margin-right: 0.333em;">→</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1561" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563" style="margin-right: 0.05em;">π</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1564" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1565"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mpadded" id="MJXp-Span-1567" style="vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;"><span class="MJXp-box" style="margin: -0.15em 0.333em 0.15em 0.278em;"><span class="MJXp-mtext" id="MJXp-Span-1568">improve</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0.333em; margin-right: 0.333em;">→</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570" style="margin-right: 0.05em;">π</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1571" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-munderover" id="MJXp-Span-1572"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mpadded" id="MJXp-Span-1574" style="vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;"><span class="MJXp-box" style="margin: -0.15em 0.333em 0.15em 0.278em;"><span class="MJXp-mtext" id="MJXp-Span-1575">evaluation</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0.333em; margin-right: 0.333em;">→</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1578" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580" style="margin-right: 0.05em;">π</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1581" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1582"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mpadded" id="MJXp-Span-1584" style="vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;"><span class="MJXp-box" style="margin: -0.15em 0.333em 0.15em 0.278em;"><span class="MJXp-mtext" id="MJXp-Span-1585">improve</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1583" style="margin-left: 0.333em; margin-right: 0.333em;">→</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587" style="margin-right: 0.05em;">π</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1588" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-munderover" id="MJXp-Span-1589"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mpadded" id="MJXp-Span-1591" style="vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;"><span class="MJXp-box" style="margin: -0.15em 0.333em 0.15em 0.278em;"><span class="MJXp-mtext" id="MJXp-Span-1592">evaluation</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0.333em; margin-right: 0.333em;">→</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-munderover" id="MJXp-Span-1594"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mpadded" id="MJXp-Span-1596" style="vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;"><span class="MJXp-box" style="margin: -0.15em 0.333em 0.15em 0.278em;"><span class="MJXp-mtext" id="MJXp-Span-1597">improve</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0.333em; margin-right: 0.333em;">→</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599" style="margin-right: 0.05em;">π</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1600" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-munderover" id="MJXp-Span-1601"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mpadded" id="MJXp-Span-1603" style="vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;"><span class="MJXp-box" style="margin: -0.15em 0.333em 0.15em 0.278em;"><span class="MJXp-mtext" id="MJXp-Span-1604">evaluation</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0.333em; margin-right: 0.333em;">→</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606" style="margin-right: 0.05em;">V</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1607" style="vertical-align: -0.4em;">∗</span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1751"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1752"><span class="msubsup" id="MathJax-Span-1753"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1754" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="mn" id="MathJax-Span-1755" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1756" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.73em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1757" style=""><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: -0.098em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: 2.775em;">→<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.355em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.859em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.313em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.817em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 2.271em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1003.43em, 4.136em, -999.997em); top: -4.685em; left: 0em;"><span class="mpadded" id="MathJax-Span-1758"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.18em, 4.136em, -999.997em); top: -4.131em; left: 0.255em;"><span class="mrow" id="MathJax-Span-1759"><span class="mtext" id="MathJax-Span-1760" style="font-size: 70.7%; font-family: MathJax_Main;">evaluation</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1761" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.363em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1762" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1763"><span class="mrow" id="MathJax-Span-1764"><span class="msubsup" id="MathJax-Span-1765"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mn" id="MathJax-Span-1767" style="font-size: 50%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1768" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.03em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1769" style=""><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: -0.098em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: 2.069em;">→<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.456em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.96em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.515em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1002.72em, 4.287em, -999.997em); top: -4.735em; left: 0em;"><span class="mpadded" id="MathJax-Span-1770"><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1002.47em, 4.287em, -999.997em); top: -4.131em; left: 0.255em;"><span class="mrow" id="MathJax-Span-1771"><span class="mtext" id="MathJax-Span-1772" style="font-size: 70.7%; font-family: MathJax_Main;">improve</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1773" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1774" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="mn" id="MathJax-Span-1775" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1776" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.73em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1777" style=""><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: -0.098em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: 2.775em;">→<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.355em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.859em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.313em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.817em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 2.271em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1003.43em, 4.136em, -999.997em); top: -4.685em; left: 0em;"><span class="mpadded" id="MathJax-Span-1778"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.18em, 4.136em, -999.997em); top: -4.131em; left: 0.255em;"><span class="mrow" id="MathJax-Span-1779"><span class="mtext" id="MathJax-Span-1780" style="font-size: 70.7%; font-family: MathJax_Main;">evaluation</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1781" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.363em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1782" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-1783"><span class="mrow" id="MathJax-Span-1784"><span class="msubsup" id="MathJax-Span-1785"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1786" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mn" id="MathJax-Span-1787" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1788" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.03em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1789" style=""><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: -0.098em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: 2.069em;">→<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.456em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.96em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.515em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1002.72em, 4.287em, -999.997em); top: -4.735em; left: 0em;"><span class="mpadded" id="MathJax-Span-1790"><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1002.47em, 4.287em, -999.997em); top: -4.131em; left: 0.255em;"><span class="mrow" id="MathJax-Span-1791"><span class="mtext" id="MathJax-Span-1792" style="font-size: 70.7%; font-family: MathJax_Main;">improve</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1793" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1794" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="mn" id="MathJax-Span-1795" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1796" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.73em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1797" style=""><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: -0.098em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: 2.775em;">→<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.355em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.859em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.313em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.817em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 2.271em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1003.43em, 4.136em, -999.997em); top: -4.685em; left: 0em;"><span class="mpadded" id="MathJax-Span-1798"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.18em, 4.136em, -999.997em); top: -4.131em; left: 0.255em;"><span class="mrow" id="MathJax-Span-1799"><span class="mtext" id="MathJax-Span-1800" style="font-size: 70.7%; font-family: MathJax_Main;">evaluation</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1801" style="font-family: MathJax_Main; padding-left: 0.305em;">⋯</span><span class="munderover" id="MathJax-Span-1802" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.03em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1803" style=""><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: -0.098em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: 2.069em;">→<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.456em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.96em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.515em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.228em, 1002.72em, 4.287em, -999.997em); top: -4.735em; left: 0em;"><span class="mpadded" id="MathJax-Span-1804"><span style="display: inline-block; position: relative; width: 3.027em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1002.47em, 4.287em, -999.997em); top: -4.131em; left: 0.255em;"><span class="mrow" id="MathJax-Span-1805"><span class="mtext" id="MathJax-Span-1806" style="font-size: 70.7%; font-family: MathJax_Main;">improve</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1807" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1808" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="mo" id="MathJax-Span-1809" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1810" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.73em, 4.136em, -999.997em); top: -3.979em; left: 0.003em;"><span class="mo" id="MathJax-Span-1811" style=""><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: -0.098em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.979em; left: 2.775em;">→<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.355em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 0.859em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.313em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 1.817em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -3.979em; left: 2.271em;">−<span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1003.43em, 4.136em, -999.997em); top: -4.685em; left: 0em;"><span class="mpadded" id="MathJax-Span-1812"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1003.18em, 4.136em, -999.997em); top: -4.131em; left: 0.255em;"><span class="mrow" id="MathJax-Span-1813"><span class="mtext" id="MathJax-Span-1814" style="font-size: 70.7%; font-family: MathJax_Main;">evaluation</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1815" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1816" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mo" id="MathJax-Span-1817" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-59">\pi_0 \xrightarrow[]{\text{evaluation}} V_{\pi_0} \xrightarrow[]{\text{improve}}
\pi_1 \xrightarrow[]{\text{evaluation}} V_{\pi_1} \xrightarrow[]{\text{improve}}
\pi_2 \xrightarrow[]{\text{evaluation}} \dots \xrightarrow[]{\text{improve}}
\pi_* \xrightarrow[]{\text{evaluation}} V_*</script>

<p>In GPI, the value function is approximated repeatedly to be closer to the true value of the current policy and in the meantime, the policy is improved repeatedly to approach optimality. This policy iteration process works and always converges to the optimality, but why this is the case?</p>

<p>Say, we have a policy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">π</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-60-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1818"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1819"><span class="mi" id="MathJax-Span-1820" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">\pi</script> and then generate an improved version <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1610"><span class="MJXp-msup" id="MJXp-Span-1611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612" style="margin-right: 0.05em;">π</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1613" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-61-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1821"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1822"><span class="msup" id="MathJax-Span-1823"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1824" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.607em;"><span class="mo" id="MathJax-Span-1825" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">\pi'</script> by greedily taking actions, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1614"><span class="MJXp-msup" id="MJXp-Span-1615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616" style="margin-right: 0.05em;">π</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1617" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">s</span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1621" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-1622">arg</span><span class="MJXp-mo" id="MJXp-Span-1623" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1624"><span class="MJXp-mo" id="MJXp-Span-1625" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1626" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">a</span><span class="MJXp-mo" id="MJXp-Span-1628">∈</span><span class="MJXp-mrow" id="MJXp-Span-1629"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1630">A</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1633" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1634" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">s</span><span class="MJXp-mo" id="MJXp-Span-1636" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">a</span><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-62-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1826"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1827"><span class="msup" id="MathJax-Span-1828"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1829" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.607em;"><span class="mo" id="MathJax-Span-1830" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1831" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1832" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1833" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1834" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1835" style="font-family: MathJax_Main; padding-left: 0.305em;">arg</span><span class="mo" id="MathJax-Span-1836"></span><span class="munderover" id="MathJax-Span-1837" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 3.38em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1838" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 1.867em;"><span class="texatom" id="MathJax-Span-1839"><span class="mrow" id="MathJax-Span-1840"><span class="mi" id="MathJax-Span-1841" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1842" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1843"><span class="mrow" id="MathJax-Span-1844"><span class="mi" id="MathJax-Span-1845" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1846" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1847" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1848" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1849" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1850" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1851" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1852" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1853" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">\pi'(s) = \arg\max_{a \in \mathcal{A}} Q_\pi(s, a)</script>. The value of this improved <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1639"><span class="MJXp-msup" id="MJXp-Span-1640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641" style="margin-right: 0.05em;">π</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1642" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-63-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1854"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1855"><span class="msup" id="MathJax-Span-1856"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1857" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.607em;"><span class="mo" id="MathJax-Span-1858" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">\pi'</script> is guaranteed to be better because:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1643"><span class="MJXp-mtable" id="MJXp-Span-1644"><span><span class="MJXp-mtr" id="MJXp-Span-1645" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1646" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1649" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1650" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">s</span><span class="MJXp-mo" id="MJXp-Span-1652" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-1653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654" style="margin-right: 0.05em;">π</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1655" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">s</span><span class="MJXp-mo" id="MJXp-Span-1658" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1659" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1660" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1661"></span><span class="MJXp-mo" id="MJXp-Span-1662" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1665" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">s</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-1669">arg</span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-munderover" id="MJXp-Span-1671"><span class=""><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1673" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">a</span><span class="MJXp-mo" id="MJXp-Span-1675">∈</span><span class="MJXp-mrow" id="MJXp-Span-1676"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1677">A</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1680" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1681" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">s</span><span class="MJXp-mo" id="MJXp-Span-1683" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">a</span><span class="MJXp-mo" id="MJXp-Span-1685" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1686" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1687" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1688" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1689" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-1690"></span><span class="MJXp-mo" id="MJXp-Span-1691" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1692"><span class=""><span class="MJXp-mo" id="MJXp-Span-1693" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1694" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">a</span><span class="MJXp-mo" id="MJXp-Span-1696">∈</span><span class="MJXp-mrow" id="MJXp-Span-1697"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1698">A</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1701" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1702" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">s</span><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">a</span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1707" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-1708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1710" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1711" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712">s</span><span class="MJXp-mo" id="MJXp-Span-1713" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">π</span><span class="MJXp-mo" id="MJXp-Span-1715" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">s</span><span class="MJXp-mo" id="MJXp-Span-1717" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1718" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1722" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1723" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">s</span><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1859"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1860"><span class="mtable" id="MathJax-Span-1861" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 21.827em; height: 0px;"><span style="position: absolute; clip: rect(1.817em, 1004.99em, 4.841em, -999.997em); top: -3.979em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.093em; height: 0px;"><span style="position: absolute; clip: rect(3.027em, 1004.99em, 4.388em, -999.997em); top: -5.189em; right: 0em;"><span class="mtd" id="MathJax-Span-1862"><span class="mrow" id="MathJax-Span-1863"><span class="msubsup" id="MathJax-Span-1864"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1865" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1866" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1867" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1868" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1869" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-1870" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1871" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.607em;"><span class="mo" id="MathJax-Span-1872" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1873" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1874" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1875" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1876" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000em, 4.136em, -999.997em); top: -3.274em; right: 0em;"><span class="mtd" id="MathJax-Span-1907"><span class="mrow" id="MathJax-Span-1908"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.371em, 1016.64em, 6.152em, -999.997em); top: -4.483em; left: 5.093em;"><span style="display: inline-block; position: relative; width: 16.736em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1011.29em, 4.942em, -999.997em); top: -5.189em; left: 0em;"><span class="mtd" id="MathJax-Span-1877"><span class="mrow" id="MathJax-Span-1878"><span class="mi" id="MathJax-Span-1879"></span><span class="mo" id="MathJax-Span-1880" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-1881" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1882" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1883" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1884" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1885" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1886" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1887" style="font-family: MathJax_Main; padding-left: 0.154em;">arg</span><span class="mo" id="MathJax-Span-1888"></span><span class="munderover" id="MathJax-Span-1889" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1890" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -3.274em; left: 0.204em;"><span class="texatom" id="MathJax-Span-1891"><span class="mrow" id="MathJax-Span-1892"><span class="mi" id="MathJax-Span-1893" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1894" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1895"><span class="mrow" id="MathJax-Span-1896"><span class="mi" id="MathJax-Span-1897" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1898" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1899" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1901" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1902" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1903" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1904" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1905" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1906" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1016.64em, 4.942em, -999.997em); top: -3.274em; left: 0em;"><span class="mtd" id="MathJax-Span-1909"><span class="mrow" id="MathJax-Span-1910"><span class="mi" id="MathJax-Span-1911"></span><span class="mo" id="MathJax-Span-1912" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-1913" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-1914" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -3.274em; left: 0.204em;"><span class="texatom" id="MathJax-Span-1915"><span class="mrow" id="MathJax-Span-1916"><span class="mi" id="MathJax-Span-1917" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1918" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-1919"><span class="mrow" id="MathJax-Span-1920"><span class="mi" id="MathJax-Span-1921" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1922" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1923" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1924" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1925" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1926" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1927" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1928" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-1929" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1930" style="font-family: MathJax_Main; padding-left: 0.305em;">≥</span><span class="msubsup" id="MathJax-Span-1931" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1932" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1933" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1934" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1935" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1936" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1937" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1938" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1939" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1940" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1941" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1942" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-1943" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1944" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1945" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1946" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1947" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1948" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.488em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-64">% <![CDATA[
\begin{aligned}
Q_\pi(s, \pi'(s))
&= Q_\pi(s, \arg\max_{a \in \mathcal{A}} Q_\pi(s, a)) \\
&= \max_{a \in \mathcal{A}} Q_\pi(s, a) \geq Q_\pi(s, \pi(s)) = V_\pi(s)
\end{aligned} %]]></script>

<h3 id="monte-carlo-methods">Monte-Carlo Methods</h3>

<p>First, let’s recall that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">V</span><span class="MJXp-mo" id="MJXp-Span-1728" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">s</span><span class="MJXp-mo" id="MJXp-Span-1730" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1732"><span class="MJXp-mi undefined" id="MJXp-Span-1733">E</span></span><span class="MJXp-mo" id="MJXp-Span-1734" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1737" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1738" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-1739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1741" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">s</span><span class="MJXp-mo" id="MJXp-Span-1744" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-65-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1949"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1950"><span class="mi" id="MathJax-Span-1951" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-1952" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1953" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1954" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1955" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="texatom" id="MathJax-Span-1956" style="padding-left: 0.305em;"><span class="mrow" id="MathJax-Span-1957"><span class="mi" id="MathJax-Span-1958" style="font-family: MathJax_AMS;">E</span></span></span><span class="mo" id="MathJax-Span-1959" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-1960"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1961" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1962" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1963" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-1964"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1965" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1966" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1967" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-1968" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-1969" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">V(s) = \mathbb{E}[ G_t \vert S_t=s]</script>. Monte-Carlo (MC) methods uses a simple idea: It learns from episodes of raw experience without modeling the environmental dynamics and computes the observed mean return as an approximation of the expected return. To compute the empirical return <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1745"><span class="MJXp-msubsup" id="MJXp-Span-1746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1748" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-66-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1970"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1971"><span class="msubsup" id="MathJax-Span-1972"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1973" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1974" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">G_t</script>, MC methods need to learn from <span style="color: #e01f1f;"><strong>complete</strong></span> episodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1749"><span class="MJXp-msubsup" id="MJXp-Span-1750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1752" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1753" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1756" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1760" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1761" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1763" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1766" style="vertical-align: -0.4em;">T</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-67-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1975"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1976"><span class="msubsup" id="MathJax-Span-1977"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1978" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mn" id="MathJax-Span-1979" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1980" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1981" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1982" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mn" id="MathJax-Span-1983" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1984" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1985" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1986" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mn" id="MathJax-Span-1987" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1988" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1989" style="font-family: MathJax_Main; padding-left: 0.154em;">…</span><span class="mo" id="MathJax-Span-1990" style="font-family: MathJax_Main; padding-left: 0.154em;">,</span><span class="msubsup" id="MathJax-Span-1991" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1992" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-1993" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-67">S_1, A_1, R_2, \dots, S_T</script> to compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1767"><span class="MJXp-msubsup" id="MJXp-Span-1768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1770" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1772"><span class="MJXp-mo" id="MJXp-Span-1773" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">T</span><span class="MJXp-mo" id="MJXp-Span-1780">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">t</span><span class="MJXp-mo" id="MJXp-Span-1782">−</span><span class="MJXp-mn" id="MJXp-Span-1783">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">k</span><span class="MJXp-mo" id="MJXp-Span-1776">=</span><span class="MJXp-mn" id="MJXp-Span-1777">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785" style="margin-right: 0.05em;">γ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1786" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1789" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">t</span><span class="MJXp-mo" id="MJXp-Span-1791">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">k</span><span class="MJXp-mo" id="MJXp-Span-1793">+</span><span class="MJXp-mn" id="MJXp-Span-1794">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-68-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1994"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-1995"><span class="msubsup" id="MathJax-Span-1996"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-1997" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-1998" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-1999" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-2000" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 3.329em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1001.01em, 4.388em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2001" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1002.27em, 4.186em, -999.997em); top: -4.433em; left: 1.061em;"><span class="texatom" id="MathJax-Span-2002"><span class="mrow" id="MathJax-Span-2003"><span class="mi" id="MathJax-Span-2004" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-2005" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2006" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2007" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2008" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.36em, 4.136em, -999.997em); top: -3.677em; left: 1.061em;"><span class="texatom" id="MathJax-Span-2009"><span class="mrow" id="MathJax-Span-2010"><span class="mi" id="MathJax-Span-2011" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2012" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2013" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2014" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2015" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.607em;"><span class="mi" id="MathJax-Span-2016" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2017"><span style="display: inline-block; position: relative; width: 2.926em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2018" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2019"><span class="mrow" id="MathJax-Span-2020"><span class="mi" id="MathJax-Span-2021" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2022" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-2023" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2024" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2025" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">G_t = \sum_{k=0}^{T-t-1} \gamma^k R_{t+k+1}</script> and all the episodes must eventually terminate.</p>

<p>The empirical mean return for state s is:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">V</span><span class="MJXp-mo" id="MJXp-Span-1797" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">s</span><span class="MJXp-mo" id="MJXp-Span-1799" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1800" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1801" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1802"><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">t</span><span class="MJXp-mo" id="MJXp-Span-1806">=</span><span class="MJXp-mn" id="MJXp-Span-1807">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1809"><span class="MJXp-mn undefined" id="MJXp-Span-1810">1</span></span><span class="MJXp-mo" id="MJXp-Span-1811" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1814" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">s</span><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-msubsup" id="MJXp-Span-1818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1820" style="vertical-align: -0.4em;">t</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1821"><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">t</span><span class="MJXp-mo" id="MJXp-Span-1825">=</span><span class="MJXp-mn" id="MJXp-Span-1826">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1828"><span class="MJXp-mn undefined" id="MJXp-Span-1829">1</span></span><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1833" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1834" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">s</span><span class="MJXp-mo" id="MJXp-Span-1836" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2026"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2027"><span class="mi" id="MathJax-Span-2028" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2029" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2030" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2031" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2032" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mfrac" id="MathJax-Span-2033" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 7.563em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(2.876em, 1007.41em, 4.438em, -999.997em); top: -4.735em; left: 50%; margin-left: -3.727em;"><span class="mrow" id="MathJax-Span-2034"><span class="munderover" id="MathJax-Span-2035"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1001.01em, 4.388em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2036" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -4.433em; left: 1.061em;"><span class="mi" id="MathJax-Span-2037" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1001.21em, 4.136em, -999.997em); top: -3.677em; left: 1.061em;"><span class="texatom" id="MathJax-Span-2038"><span class="mrow" id="MathJax-Span-2039"><span class="mi" id="MathJax-Span-2040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2041" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2042" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2043" style="padding-left: 0.154em;"><span class="mrow" id="MathJax-Span-2044"><span class="mn" id="MathJax-Span-2045" style="font-family: MathJax_Main;">1</span></span></span><span class="mo" id="MathJax-Span-2046" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2047"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2048" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2049" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2050" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2051" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-2052" style="font-family: MathJax_Main;">]</span><span class="msubsup" id="MathJax-Span-2053"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2054" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-2055" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1006.2em, 4.438em, -999.997em); top: -3.072em; left: 50%; margin-left: -3.122em;"><span class="mrow" id="MathJax-Span-2056"><span class="munderover" id="MathJax-Span-2057"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1001.01em, 4.388em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2058" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -4.433em; left: 1.061em;"><span class="mi" id="MathJax-Span-2059" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1001.21em, 4.136em, -999.997em); top: -3.677em; left: 1.061em;"><span class="texatom" id="MathJax-Span-2060"><span class="mrow" id="MathJax-Span-2061"><span class="mi" id="MathJax-Span-2062" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2063" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2064" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2065" style="padding-left: 0.154em;"><span class="mrow" id="MathJax-Span-2066"><span class="mn" id="MathJax-Span-2067" style="font-family: MathJax_Main;">1</span></span></span><span class="mo" id="MathJax-Span-2068" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2069"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2070" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2071" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2072" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2073" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-2074" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1007.56em, 1.212em, -999.997em); top: -1.258em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.563em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-69">V(s) = \frac{\sum_{t=1}^T \mathbb{1}[S_t = s] G_t}{\sum_{t=1}^T \mathbb{1}[S_t = s]}</script>

<p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1837"><span class="MJXp-mrow" id="MJXp-Span-1838"><span class="MJXp-mn undefined" id="MJXp-Span-1839">1</span></span><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1843" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">s</span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-70-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2075"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2076"><span class="texatom" id="MathJax-Span-2077"><span class="mrow" id="MathJax-Span-2078"><span class="mn" id="MathJax-Span-2079" style="font-family: MathJax_Main;">1</span></span></span><span class="mo" id="MathJax-Span-2080" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2081"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2082" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2083" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2084" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2085" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-2086" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">\mathbb{1}[S_t = s]</script> is a binary indicator function. We may count the visit of state s every time so that there could exist multiple visits of one state in one episode (“every-visit”), or only count it the first time we encounter a state in one episode (“first-visit”). This way of approximation can be easily extended to action-value functions by counting (s, a) pair.</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">Q</span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">s</span><span class="MJXp-mo" id="MJXp-Span-1851" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">a</span><span class="MJXp-mo" id="MJXp-Span-1853" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1854" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1855" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1856"><span class="MJXp-mo" id="MJXp-Span-1857" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">t</span><span class="MJXp-mo" id="MJXp-Span-1860">=</span><span class="MJXp-mn" id="MJXp-Span-1861">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1863"><span class="MJXp-mn undefined" id="MJXp-Span-1864">1</span></span><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1868" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1869" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">s</span><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1874" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1875" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">a</span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-msubsup" id="MJXp-Span-1878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1880" style="vertical-align: -0.4em;">t</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1881"><span class="MJXp-mo" id="MJXp-Span-1882" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884">t</span><span class="MJXp-mo" id="MJXp-Span-1885">=</span><span class="MJXp-mn" id="MJXp-Span-1886">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1888"><span class="MJXp-mn undefined" id="MJXp-Span-1889">1</span></span><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1893" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1894" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">s</span><span class="MJXp-mo" id="MJXp-Span-1896" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1899" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">a</span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2087"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2088"><span class="mi" id="MathJax-Span-2089" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-2090" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2091" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2092" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2093" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-2094" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2095" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mfrac" id="MathJax-Span-2096" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 10.99em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(2.876em, 1010.84em, 4.438em, -999.997em); top: -4.735em; left: 50%; margin-left: -5.441em;"><span class="mrow" id="MathJax-Span-2097"><span class="munderover" id="MathJax-Span-2098"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1001.01em, 4.388em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2099" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -4.433em; left: 1.061em;"><span class="mi" id="MathJax-Span-2100" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1001.21em, 4.136em, -999.997em); top: -3.677em; left: 1.061em;"><span class="texatom" id="MathJax-Span-2101"><span class="mrow" id="MathJax-Span-2102"><span class="mi" id="MathJax-Span-2103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2104" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2105" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2106" style="padding-left: 0.154em;"><span class="mrow" id="MathJax-Span-2107"><span class="mn" id="MathJax-Span-2108" style="font-family: MathJax_Main;">1</span></span></span><span class="mo" id="MathJax-Span-2109" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2110"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2111" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2112" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2113" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2114" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-2115" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2116" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2117" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2118" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2119" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2120" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-2121" style="font-family: MathJax_Main;">]</span><span class="msubsup" id="MathJax-Span-2122"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2123" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-2124" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1009.63em, 4.438em, -999.997em); top: -3.072em; left: 50%; margin-left: -4.887em;"><span class="mrow" id="MathJax-Span-2125"><span class="munderover" id="MathJax-Span-2126"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1001.01em, 4.388em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2127" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -4.433em; left: 1.061em;"><span class="mi" id="MathJax-Span-2128" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1001.21em, 4.136em, -999.997em); top: -3.677em; left: 1.061em;"><span class="texatom" id="MathJax-Span-2129"><span class="mrow" id="MathJax-Span-2130"><span class="mi" id="MathJax-Span-2131" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2132" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2133" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2134" style="padding-left: 0.154em;"><span class="mrow" id="MathJax-Span-2135"><span class="mn" id="MathJax-Span-2136" style="font-family: MathJax_Main;">1</span></span></span><span class="mo" id="MathJax-Span-2137" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2138"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2139" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2140" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2141" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2142" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">s</span><span class="mo" id="MathJax-Span-2143" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2144" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2145" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2147" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2148" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">a</span><span class="mo" id="MathJax-Span-2149" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1010.99em, 1.212em, -999.997em); top: -1.258em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 10.99em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-71">Q(s, a) = \frac{\sum_{t=1}^T \mathbb{1}[S_t = s, A_t = a] G_t}{\sum_{t=1}^T \mathbb{1}[S_t = s, A_t = a]}</script>

<p>To learn the optimal policy by MC, we iterate it by following a similar idea to <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#policy-iteration">GPI</a>.</p>

<p style="width: 50%;" class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/MC_control.png" alt="Policy Iteration by MC"></p>

<ol>
  <li>Improve the policy greedily with respect to the current value function: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">π</span><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">s</span><span class="MJXp-mo" id="MJXp-Span-1907" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-1909">arg</span><span class="MJXp-mo" id="MJXp-Span-1910" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1911"><span class="MJXp-mo" id="MJXp-Span-1912" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1913" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">a</span><span class="MJXp-mo" id="MJXp-Span-1915">∈</span><span class="MJXp-mrow" id="MJXp-Span-1916"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1917">A</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918">Q</span><span class="MJXp-mo" id="MJXp-Span-1919" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">s</span><span class="MJXp-mo" id="MJXp-Span-1921" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">a</span><span class="MJXp-mo" id="MJXp-Span-1923" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-72-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2150"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2151"><span class="mi" id="MathJax-Span-2152" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2153" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2154" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2155" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2156" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2157" style="font-family: MathJax_Main; padding-left: 0.305em;">arg</span><span class="mo" id="MathJax-Span-2158"></span><span class="munderover" id="MathJax-Span-2159" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 3.38em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2160" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 1.867em;"><span class="texatom" id="MathJax-Span-2161"><span class="mrow" id="MathJax-Span-2162"><span class="mi" id="MathJax-Span-2163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2164" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2165"><span class="mrow" id="MathJax-Span-2166"><span class="mi" id="MathJax-Span-2167" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-2168" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">Q</span><span class="mo" id="MathJax-Span-2169" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2170" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2171" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2172" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-2173" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">\pi(s) = \arg\max_{a \in \mathcal{A}} Q(s, a)</script>.</li>
  <li>Generate a new episode with the new policy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">π</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-73-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2174"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2175"><span class="mi" id="MathJax-Span-2176" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">\pi</script> (i.e. using algorithms like <a href="https://lilianweng.github.io/lil-log/2018/01/23/the-multi-armed-bandit-problem-and-its-solutions.html#%CE%B5-greedy-algorithm">ε-greedy</a> helps us balance between exploitation and exploration.)</li>
  <li>Estimate Q using the new episode: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1926"><span class="MJXp-msubsup" id="MJXp-Span-1927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1929" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-1930" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">s</span><span class="MJXp-mo" id="MJXp-Span-1932" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933">a</span><span class="MJXp-mo" id="MJXp-Span-1934" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1935" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1936" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1937"><span class="MJXp-mo" id="MJXp-Span-1938" style="margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">t</span><span class="MJXp-mo" id="MJXp-Span-1941">=</span><span class="MJXp-mn" id="MJXp-Span-1942">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1944"><span class="MJXp-mo" id="MJXp-Span-1945" style="vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1946"><span class="MJXp-mn undefined" id="MJXp-Span-1947">1</span></span><span class="MJXp-mo" id="MJXp-Span-1948">[</span><span class="MJXp-msubsup" id="MJXp-Span-1949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1951" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1952">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953">s</span><span class="MJXp-mo" id="MJXp-Span-1954">,</span><span class="MJXp-msubsup" id="MJXp-Span-1955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1957" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1958">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">a</span><span class="MJXp-mo" id="MJXp-Span-1960">]</span><span class="MJXp-msubsup" id="MJXp-Span-1961"><span class="MJXp-mo" id="MJXp-Span-1962" style="margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">T</span><span class="MJXp-mo" id="MJXp-Span-1969">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">t</span><span class="MJXp-mo" id="MJXp-Span-1971">−</span><span class="MJXp-mn" id="MJXp-Span-1972">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1963"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">k</span><span class="MJXp-mo" id="MJXp-Span-1965">=</span><span class="MJXp-mn" id="MJXp-Span-1966">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974" style="margin-right: 0.05em;">γ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1975" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1978" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1979">t</span><span class="MJXp-mo" id="MJXp-Span-1980">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">k</span><span class="MJXp-mo" id="MJXp-Span-1982">+</span><span class="MJXp-mn" id="MJXp-Span-1983">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1984"><span class="MJXp-mo" id="MJXp-Span-1985" style="vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1986"><span class="MJXp-mo" id="MJXp-Span-1987" style="margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1989">t</span><span class="MJXp-mo" id="MJXp-Span-1990">=</span><span class="MJXp-mn" id="MJXp-Span-1991">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1993"><span class="MJXp-mn undefined" id="MJXp-Span-1994">1</span></span><span class="MJXp-mo" id="MJXp-Span-1995">[</span><span class="MJXp-msubsup" id="MJXp-Span-1996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1998" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1999">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000">s</span><span class="MJXp-mo" id="MJXp-Span-2001">,</span><span class="MJXp-msubsup" id="MJXp-Span-2002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2004" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2005">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">a</span><span class="MJXp-mo" id="MJXp-Span-2007">]</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-74-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2177"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2178"><span class="msubsup" id="MathJax-Span-2179"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2180" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-2181" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2182" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2183" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2184" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2185" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-2186" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2187" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mfrac" id="MathJax-Span-2188" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 12.402em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.027em, 1012.15em, 4.589em, -999.997em); top: -4.836em; left: 50%; margin-left: -6.147em;"><span class="mrow" id="MathJax-Span-2189"><span class="munderover" id="MathJax-Span-2190"><span style="display: inline-block; position: relative; width: 1.615em; height: 0px;"><span style="position: absolute; clip: rect(3.279em, 1000.71em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2191" style="font-size: 70.7%; font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.41em, 4.136em, -999.997em); top: -4.332em; left: 0.759em;"><span class="mi" id="MathJax-Span-2192" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.86em, 4.136em, -999.997em); top: -3.778em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2193"><span class="mrow" id="MathJax-Span-2194"><span class="mi" id="MathJax-Span-2195" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2196" style="font-size: 50%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2197" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2198" style="padding-left: 0.154em;"><span class="mrow" id="MathJax-Span-2199"><span class="mo" id="MathJax-Span-2200" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">(</span></span></span></span></span><span class="texatom" id="MathJax-Span-2201"><span class="mrow" id="MathJax-Span-2202"><span class="mn" id="MathJax-Span-2203" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span class="mo" id="MathJax-Span-2204" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2205"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.456em;"><span class="mi" id="MathJax-Span-2207" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2208" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-2209" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2210" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2211"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2212" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.557em;"><span class="mi" id="MathJax-Span-2213" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2214" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-2215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2216" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="munderover" id="MathJax-Span-2217" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 2.371em; height: 0px;"><span style="position: absolute; clip: rect(3.279em, 1000.71em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2218" style="font-size: 70.7%; font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1001.62em, 4.186em, -999.997em); top: -4.332em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2219"><span class="mrow" id="MathJax-Span-2220"><span class="mi" id="MathJax-Span-2221" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-2222" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2223" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2224" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2225" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.96em, 4.136em, -999.997em); top: -3.778em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2226"><span class="mrow" id="MathJax-Span-2227"><span class="mi" id="MathJax-Span-2228" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2229" style="font-size: 50%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2230" style="font-size: 50%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2231" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.287em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2232" style="font-size: 70.7%; font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.456em;"><span class="mi" id="MathJax-Span-2233" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2234"><span style="display: inline-block; position: relative; width: 2.069em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2235" style="font-size: 70.7%; font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.557em;"><span class="texatom" id="MathJax-Span-2236"><span class="mrow" id="MathJax-Span-2237"><span class="mi" id="MathJax-Span-2238" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2239" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-2240" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2241" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2242" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2243"><span class="mrow" id="MathJax-Span-2244"><span class="mo" id="MathJax-Span-2245" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size2;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1005.85em, 4.337em, -999.997em); top: -3.374em; left: 50%; margin-left: -2.971em;"><span class="mrow" id="MathJax-Span-2246"><span class="munderover" id="MathJax-Span-2247"><span style="display: inline-block; position: relative; width: 1.615em; height: 0px;"><span style="position: absolute; clip: rect(3.279em, 1000.71em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2248" style="font-size: 70.7%; font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.41em, 4.136em, -999.997em); top: -4.332em; left: 0.759em;"><span class="mi" id="MathJax-Span-2249" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.48em, 1000.86em, 4.136em, -999.997em); top: -3.778em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2250"><span class="mrow" id="MathJax-Span-2251"><span class="mi" id="MathJax-Span-2252" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2253" style="font-size: 50%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2254" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2255" style="padding-left: 0.154em;"><span class="mrow" id="MathJax-Span-2256"><span class="mn" id="MathJax-Span-2257" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span class="mo" id="MathJax-Span-2258" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-2259"><span style="display: inline-block; position: relative; width: 0.658em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2260" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.456em;"><span class="mi" id="MathJax-Span-2261" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2262" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-2263" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2264" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2265"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.329em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2266" style="font-size: 70.7%; font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.557em;"><span class="mi" id="MathJax-Span-2267" style="font-size: 50%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2268" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-2269" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2270" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1012.4em, 1.212em, -999.997em); top: -1.258em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 12.402em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">q_\pi(s, a) = \frac{\sum_{t=1}^T \big( \mathbb{1}[S_t = s, A_t = a] \sum_{k=0}^{T-t-1} \gamma^k R_{t+k+1} \big)}{\sum_{t=1}^T \mathbb{1}[S_t = s, A_t = a]}</script></li>
</ol>

<h3 id="temporal-difference-learning">Temporal-Difference Learning</h3>

<p>Similar to Monte-Carlo methods, Temporal-Difference (TD) Learning is model-free and learns from episodes of experience. However, TD learning can learn from <span style="color: #e01f1f;"><strong>incomplete</strong></span> episodes and hence we don’t need to track the episode up to termination. TD learning is so important that Sutton &amp; Barto (2017) in their RL book describes it as “one idea … central and novel to reinforcement learning”.</p>

<h4 id="bootstrapping">Bootstrapping</h4>

<p>TD learning methods update targets with regard to existing estimates rather than exclusively relying on actual rewards and complete returns as in MC methods. This approach is known as <strong>bootstrapping</strong>.</p>

<h4 id="value-estimation">Value Estimation</h4>

<p>The key idea in TD learning is to update the value function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">V</span><span class="MJXp-mo" id="MJXp-Span-2010" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2011"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2012" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2013" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2014" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-75-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2271"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2272"><span class="mi" id="MathJax-Span-2273" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2274" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2275"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2276" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2277" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2278" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">V(S_t)</script> towards an estimated return <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2015"><span class="MJXp-msubsup" id="MJXp-Span-2016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2018" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019">t</span><span class="MJXp-mo" id="MJXp-Span-2020">+</span><span class="MJXp-mn" id="MJXp-Span-2021">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2022" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2023">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">V</span><span class="MJXp-mo" id="MJXp-Span-2025" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2028" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">t</span><span class="MJXp-mo" id="MJXp-Span-2030">+</span><span class="MJXp-mn" id="MJXp-Span-2031">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-76-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2279"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2280"><span class="msubsup" id="MathJax-Span-2281"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2282" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2283"><span class="mrow" id="MathJax-Span-2284"><span class="mi" id="MathJax-Span-2285" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2286" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2287" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2288" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2289" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2290" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2291" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2292"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2293" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2294"><span class="mrow" id="MathJax-Span-2295"><span class="mi" id="MathJax-Span-2296" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2297" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2298" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2299" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">R_{t+1} + \gamma V(S_{t+1})</script> (known as “<strong>TD target</strong>”). To what extent we want to update the value function is controlled by the learning rate hyperparameter α:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2033"><span class="MJXp-mtable" id="MJXp-Span-2034"><span><span class="MJXp-mtr" id="MJXp-Span-2035" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2036" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">V</span><span class="MJXp-mo" id="MJXp-Span-2038" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2041" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2042" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-2043" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2044"></span><span class="MJXp-mo" id="MJXp-Span-2045" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mo" id="MJXp-Span-2046" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2047">1</span><span class="MJXp-mo" id="MJXp-Span-2048" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2049">α</span><span class="MJXp-mo" id="MJXp-Span-2050" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051">V</span><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2055" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2056" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2057" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2058">α</span><span class="MJXp-msubsup" id="MJXp-Span-2059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2061" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-2062" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2063" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">V</span><span class="MJXp-mo" id="MJXp-Span-2065" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2068" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2069" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-2070" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2071"></span><span class="MJXp-mo" id="MJXp-Span-2072" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073">V</span><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2077" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2079" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">α</span><span class="MJXp-mo" id="MJXp-Span-2081" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2082"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2083" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2084" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2085" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">V</span><span class="MJXp-mo" id="MJXp-Span-2087" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2090" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2091" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2092" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2093" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2094" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">V</span><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2099" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2100" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-2101" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2102"></span><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104">V</span><span class="MJXp-mo" id="MJXp-Span-2105" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2108" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2109" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2110" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">α</span><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2115" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">t</span><span class="MJXp-mo" id="MJXp-Span-2117">+</span><span class="MJXp-mn" id="MJXp-Span-2118">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2119" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">V</span><span class="MJXp-mo" id="MJXp-Span-2122" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2125" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">t</span><span class="MJXp-mo" id="MJXp-Span-2127">+</span><span class="MJXp-mn" id="MJXp-Span-2128">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2129" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2130" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">V</span><span class="MJXp-mo" id="MJXp-Span-2132" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2135" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2136" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2137" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2300"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2301"><span class="mtable" id="MathJax-Span-2302" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 20.013em; height: 0px;"><span style="position: absolute; clip: rect(2.472em, 1002.42em, 6.454em, -999.997em); top: -4.685em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1002.42em, 4.388em, -999.997em); top: -5.29em; right: 0em;"><span class="mtd" id="MathJax-Span-2303"><span class="mrow" id="MathJax-Span-2304"><span class="mi" id="MathJax-Span-2305" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2306" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2307"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2308" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2309" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2310" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1002.42em, 4.388em, -999.997em); top: -3.979em; right: 0em;"><span class="mtd" id="MathJax-Span-2331"><span class="mrow" id="MathJax-Span-2332"><span class="mi" id="MathJax-Span-2333" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2334" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2335"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2336" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2337" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2338" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1002.42em, 4.388em, -999.997em); top: -2.618em; right: 0em;"><span class="mtd" id="MathJax-Span-2363"><span class="mrow" id="MathJax-Span-2364"><span class="mi" id="MathJax-Span-2365" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2366" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2367"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2368" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2369" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2370" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.69em;"></span></span><span style="position: absolute; clip: rect(2.472em, 1017.39em, 6.454em, -999.997em); top: -4.685em; left: 2.472em;"><span style="display: inline-block; position: relative; width: 17.492em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1010.13em, 4.388em, -999.997em); top: -5.29em; left: 0em;"><span class="mtd" id="MathJax-Span-2311"><span class="mrow" id="MathJax-Span-2312"><span class="mi" id="MathJax-Span-2313"></span><span class="mo" id="MathJax-Span-2314" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mo" id="MathJax-Span-2315" style="font-family: MathJax_Main; padding-left: 0.305em;">(</span><span class="mn" id="MathJax-Span-2316" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2317" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-2318" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">α</span><span class="mo" id="MathJax-Span-2319" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-2320" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2321" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2322"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2323" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2324" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2325" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2326" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2327" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">α</span><span class="msubsup" id="MathJax-Span-2328"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2329" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-2330" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1011.39em, 4.388em, -999.997em); top: -3.979em; left: 0em;"><span class="mtd" id="MathJax-Span-2339"><span class="mrow" id="MathJax-Span-2340"><span class="mi" id="MathJax-Span-2341"></span><span class="mo" id="MathJax-Span-2342" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mi" id="MathJax-Span-2343" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2344" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2345"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2346" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2347" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2348" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2349" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2350" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">α</span><span class="mo" id="MathJax-Span-2351" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2352"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2353" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-2354" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2355" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-2356" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2357" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2358"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2359" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2360" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2361" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2362" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1017.39em, 4.388em, -999.997em); top: -2.618em; left: 0em;"><span class="mtd" id="MathJax-Span-2371"><span class="mrow" id="MathJax-Span-2372"><span class="mi" id="MathJax-Span-2373"></span><span class="mo" id="MathJax-Span-2374" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mi" id="MathJax-Span-2375" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2376" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2377"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2378" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2379" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2380" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2381" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2382" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">α</span><span class="mo" id="MathJax-Span-2383" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2384"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2385" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2386"><span class="mrow" id="MathJax-Span-2387"><span class="mi" id="MathJax-Span-2388" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2389" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2390" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2391" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2392" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2393" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2394" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2395"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2396" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2397"><span class="mrow" id="MathJax-Span-2398"><span class="mi" id="MathJax-Span-2399" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2400" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2401" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2402" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2403" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-2404" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-2405" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2406"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2407" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2408" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2409" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2410" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.69em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-77">% <![CDATA[
\begin{aligned}
V(S_t) &\leftarrow (1- \alpha) V(S_t) + \alpha G_t \\
V(S_t) &\leftarrow V(S_t) + \alpha (G_t - V(S_t)) \\
V(S_t) &\leftarrow V(S_t) + \alpha (R_{t+1} + \gamma V(S_{t+1}) - V(S_t))
\end{aligned} %]]></script>

<p>Similarly, for action-value estimation:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">Q</span><span class="MJXp-mo" id="MJXp-Span-2140" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2143" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2144" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2146" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2147" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2148" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2149" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">Q</span><span class="MJXp-mo" id="MJXp-Span-2151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2154" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2155" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2158" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2159" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2160" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161">α</span><span class="MJXp-mo" id="MJXp-Span-2162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2165" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2166">t</span><span class="MJXp-mo" id="MJXp-Span-2167">+</span><span class="MJXp-mn" id="MJXp-Span-2168">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2169" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">Q</span><span class="MJXp-mo" id="MJXp-Span-2172" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2175" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">t</span><span class="MJXp-mo" id="MJXp-Span-2177">+</span><span class="MJXp-mn" id="MJXp-Span-2178">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2179" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2182" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183">t</span><span class="MJXp-mo" id="MJXp-Span-2184">+</span><span class="MJXp-mn" id="MJXp-Span-2185">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2186" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2187" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">Q</span><span class="MJXp-mo" id="MJXp-Span-2189" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2192" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2193" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2196" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2197" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2198" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2411"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2412"><span class="mi" id="MathJax-Span-2413" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-2414" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2415"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2416" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2418" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2419" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2420" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2421" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2422" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2423" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mi" id="MathJax-Span-2424" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">Q</span><span class="mo" id="MathJax-Span-2425" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2426"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2427" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2428" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2429" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2430" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2431" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2432" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2433" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2434" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2435" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">α</span><span class="mo" id="MathJax-Span-2436" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2437"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2438" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2439"><span class="mrow" id="MathJax-Span-2440"><span class="mi" id="MathJax-Span-2441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2442" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2443" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2444" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2445" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2446" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-2447" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2448"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2449" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2450"><span class="mrow" id="MathJax-Span-2451"><span class="mi" id="MathJax-Span-2452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2453" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2454" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2455" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2456" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.968em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2457" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2458"><span class="mrow" id="MathJax-Span-2459"><span class="mi" id="MathJax-Span-2460" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2461" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2462" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2463" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2464" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-2465" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">Q</span><span class="mo" id="MathJax-Span-2466" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2467"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2468" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2469" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2470" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2471" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2472" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2473" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2474" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2475" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-78">Q(S_t, A_t) \leftarrow Q(S_t, A_t) + \alpha (R_{t+1} + \gamma Q(S_{t+1}, A_{t+1}) - Q(S_t, A_t))</script>

<p>Next, let’s dig into the fun part on how to learn optimal policy in TD learning (aka “TD control”). Be prepared, you are gonna see many famous names of classic algorithms in this section.</p>

<h4 id="sarsa-on-policy-td-control">SARSA: On-Policy TD control</h4>

<p>“SARSA” refers to the procedure of updaing Q-value by following a sequence of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2199"><span class="MJXp-mo" id="MJXp-Span-2200" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2201" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2204" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2205" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2208" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2211" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2212" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2213">t</span><span class="MJXp-mo" id="MJXp-Span-2214">+</span><span class="MJXp-mn" id="MJXp-Span-2215">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2216" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2219" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">t</span><span class="MJXp-mo" id="MJXp-Span-2221">+</span><span class="MJXp-mn" id="MJXp-Span-2222">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2223" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2225" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2226" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">t</span><span class="MJXp-mo" id="MJXp-Span-2228">+</span><span class="MJXp-mn" id="MJXp-Span-2229">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2231" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-79-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2476"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2477"><span class="mo" id="MathJax-Span-2478" style="font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-2479" style="font-family: MathJax_Main; padding-left: 0.154em;">,</span><span class="msubsup" id="MathJax-Span-2480" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2481" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2482" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2483" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2484" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2485" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2487" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2488" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2489" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2490"><span class="mrow" id="MathJax-Span-2491"><span class="mi" id="MathJax-Span-2492" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2493" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2494" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2495" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2496" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2497" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2498"><span class="mrow" id="MathJax-Span-2499"><span class="mi" id="MathJax-Span-2500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2501" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2502" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2503" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2504" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.968em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2505" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2506"><span class="mrow" id="MathJax-Span-2507"><span class="mi" id="MathJax-Span-2508" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2509" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2510" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2511" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2512" style="font-family: MathJax_Main; padding-left: 0.154em;">…</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">\dots, S_t, A_t, R_{t+1}, S_{t+1}, A_{t+1}, \dots</script>. The idea follows the same route of <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#policy-iteration">GPI</a>:</p>
<ol>
  <li>At time step t, we start from state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2232"><span class="MJXp-msubsup" id="MJXp-Span-2233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2235" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-80-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2513"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2514"><span class="msubsup" id="MathJax-Span-2515"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2516" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2517" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-80">S_t</script> and pick action according to Q values, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2236"><span class="MJXp-msubsup" id="MJXp-Span-2237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2239" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2240" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2241">arg</span><span class="MJXp-mo" id="MJXp-Span-2242" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2243"><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2245" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246">a</span><span class="MJXp-mo" id="MJXp-Span-2247">∈</span><span class="MJXp-mrow" id="MJXp-Span-2248"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2249">A</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250">Q</span><span class="MJXp-mo" id="MJXp-Span-2251" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2254" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2255" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256">a</span><span class="MJXp-mo" id="MJXp-Span-2257" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-81-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2518"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2519"><span class="msubsup" id="MathJax-Span-2520"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2521" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2522" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2523" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2524" style="font-family: MathJax_Main; padding-left: 0.305em;">arg</span><span class="mo" id="MathJax-Span-2525"></span><span class="munderover" id="MathJax-Span-2526" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 3.38em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2527" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 1.867em;"><span class="texatom" id="MathJax-Span-2528"><span class="mrow" id="MathJax-Span-2529"><span class="mi" id="MathJax-Span-2530" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2531" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2532"><span class="mrow" id="MathJax-Span-2533"><span class="mi" id="MathJax-Span-2534" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-2535" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">Q</span><span class="mo" id="MathJax-Span-2536" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2537"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2538" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2539" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2540" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2541" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-2542" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">A_t = \arg\max_{a \in \mathcal{A}} Q(S_t, a)</script>; ε-greedy is commonly applied.</li>
  <li>With action <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2258"><span class="MJXp-msubsup" id="MJXp-Span-2259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2261" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-82-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2543"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2544"><span class="msubsup" id="MathJax-Span-2545"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2546" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2547" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">A_t</script>, we observe reward <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2262"><span class="MJXp-msubsup" id="MJXp-Span-2263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2265" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2266">t</span><span class="MJXp-mo" id="MJXp-Span-2267">+</span><span class="MJXp-mn" id="MJXp-Span-2268">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-83-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2548"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2549"><span class="msubsup" id="MathJax-Span-2550"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2551" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2552"><span class="mrow" id="MathJax-Span-2553"><span class="mi" id="MathJax-Span-2554" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2555" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2556" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">R_{t+1}</script> and get into the next state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2269"><span class="MJXp-msubsup" id="MJXp-Span-2270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2272" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">t</span><span class="MJXp-mo" id="MJXp-Span-2274">+</span><span class="MJXp-mn" id="MJXp-Span-2275">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-84-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2557"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2558"><span class="msubsup" id="MathJax-Span-2559"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2560" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2561"><span class="mrow" id="MathJax-Span-2562"><span class="mi" id="MathJax-Span-2563" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2564" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2565" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">S_{t+1}</script>.</li>
  <li>Then pick the next action in the same way as in step 1.: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2276"><span class="MJXp-msubsup" id="MJXp-Span-2277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2279" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">t</span><span class="MJXp-mo" id="MJXp-Span-2281">+</span><span class="MJXp-mn" id="MJXp-Span-2282">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2283" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2284">arg</span><span class="MJXp-mo" id="MJXp-Span-2285" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2286"><span class="MJXp-mo" id="MJXp-Span-2287" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2288" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">a</span><span class="MJXp-mo" id="MJXp-Span-2290">∈</span><span class="MJXp-mrow" id="MJXp-Span-2291"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2292">A</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293">Q</span><span class="MJXp-mo" id="MJXp-Span-2294" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2296" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2297" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298">t</span><span class="MJXp-mo" id="MJXp-Span-2299">+</span><span class="MJXp-mn" id="MJXp-Span-2300">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2301" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302">a</span><span class="MJXp-mo" id="MJXp-Span-2303" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-85-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2566"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2567"><span class="msubsup" id="MathJax-Span-2568"><span style="display: inline-block; position: relative; width: 1.968em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2569" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2570"><span class="mrow" id="MathJax-Span-2571"><span class="mi" id="MathJax-Span-2572" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2573" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2574" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2575" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2576" style="font-family: MathJax_Main; padding-left: 0.305em;">arg</span><span class="mo" id="MathJax-Span-2577"></span><span class="munderover" id="MathJax-Span-2578" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 3.38em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2579" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 1.867em;"><span class="texatom" id="MathJax-Span-2580"><span class="mrow" id="MathJax-Span-2581"><span class="mi" id="MathJax-Span-2582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2583" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2584"><span class="mrow" id="MathJax-Span-2585"><span class="mi" id="MathJax-Span-2586" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-2587" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">Q</span><span class="mo" id="MathJax-Span-2588" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2589"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2590" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2591"><span class="mrow" id="MathJax-Span-2592"><span class="mi" id="MathJax-Span-2593" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2594" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2595" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2596" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2597" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-2598" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">A_{t+1} = \arg\max_{a \in \mathcal{A}} Q(S_{t+1}, a)</script>.</li>
  <li>Update the action-value function: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">Q</span><span class="MJXp-mo" id="MJXp-Span-2306" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2308" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2309" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2312" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2313" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2314" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2315" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316">Q</span><span class="MJXp-mo" id="MJXp-Span-2317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2319" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2320" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2321" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2324" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2325" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327">α</span><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2331" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2332">t</span><span class="MJXp-mo" id="MJXp-Span-2333">+</span><span class="MJXp-mn" id="MJXp-Span-2334">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2335" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2337">Q</span><span class="MJXp-mo" id="MJXp-Span-2338" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2340" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2341" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2342">t</span><span class="MJXp-mo" id="MJXp-Span-2343">+</span><span class="MJXp-mn" id="MJXp-Span-2344">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2345" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2348" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349">t</span><span class="MJXp-mo" id="MJXp-Span-2350">+</span><span class="MJXp-mn" id="MJXp-Span-2351">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2352" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2353" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354">Q</span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2358" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2359" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2362" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2363" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2364" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-86-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2599"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2600"><span class="mi" id="MathJax-Span-2601" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-2602" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2603"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2604" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2605" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2606" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2607" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2608" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2609" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2610" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2611" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mi" id="MathJax-Span-2612" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">Q</span><span class="mo" id="MathJax-Span-2613" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2614"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2615" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2616" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2617" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2618" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2619" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2620" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2621" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2622" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2623" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">α</span><span class="mo" id="MathJax-Span-2624" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2625"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2626" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2627"><span class="mrow" id="MathJax-Span-2628"><span class="mi" id="MathJax-Span-2629" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2630" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2631" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2632" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2633" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2634" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-2635" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2636"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2637" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2638"><span class="mrow" id="MathJax-Span-2639"><span class="mi" id="MathJax-Span-2640" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2641" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2642" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2643" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2644" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.968em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2645" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2646"><span class="mrow" id="MathJax-Span-2647"><span class="mi" id="MathJax-Span-2648" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2649" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2650" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2651" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2652" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-2653" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">Q</span><span class="mo" id="MathJax-Span-2654" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2655"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2656" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2657" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2658" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2659" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2660" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2661" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2662" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2663" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">Q(S_t, A_t) \leftarrow Q(S_t, A_t) + \alpha (R_{t+1} + \gamma Q(S_{t+1}, A_{t+1}) - Q(S_t, A_t))</script>.</li>
  <li>t = t+1 and repeat from step 1.</li>
</ol>

<p>In each update of SARSA, we need to choose actions for two steps by following the current policy twice (in Step 1. &amp; 3.).</p>

<h4 id="q-learning-off-policy-td-control">Q-Learning: Off-policy TD control</h4>

<p>The development of Q-learning (<a href="https://link.springer.com/content/pdf/10.1007/BF00992698.pdf">Watkins &amp; Dayan, 1992</a>) is a big breakout in the early days of Reinforcement Learning.</p>
<ol>
  <li>At time step t, we start from state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2365"><span class="MJXp-msubsup" id="MJXp-Span-2366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2368" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-87-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2664"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2665"><span class="msubsup" id="MathJax-Span-2666"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2667" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2668" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">S_t</script> and pick action according to Q values, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2369"><span class="MJXp-msubsup" id="MJXp-Span-2370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2372" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2373" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2374">arg</span><span class="MJXp-mo" id="MJXp-Span-2375" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-2376"><span class="MJXp-mo" id="MJXp-Span-2377" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2378" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">a</span><span class="MJXp-mo" id="MJXp-Span-2380">∈</span><span class="MJXp-mrow" id="MJXp-Span-2381"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2382">A</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2383">Q</span><span class="MJXp-mo" id="MJXp-Span-2384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2387" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2388" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2389">a</span><span class="MJXp-mo" id="MJXp-Span-2390" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-88-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2669"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2670"><span class="msubsup" id="MathJax-Span-2671"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2672" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2674" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-2675" style="font-family: MathJax_Main; padding-left: 0.305em;">arg</span><span class="mo" id="MathJax-Span-2676"></span><span class="munderover" id="MathJax-Span-2677" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 3.38em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2678" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 1.867em;"><span class="texatom" id="MathJax-Span-2679"><span class="mrow" id="MathJax-Span-2680"><span class="mi" id="MathJax-Span-2681" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2682" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2683"><span class="mrow" id="MathJax-Span-2684"><span class="mi" id="MathJax-Span-2685" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-2686" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">Q</span><span class="mo" id="MathJax-Span-2687" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2688"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2689" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2690" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2691" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2692" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-2693" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">A_t = \arg\max_{a \in \mathcal{A}} Q(S_t, a)</script>; ε-greedy is commonly applied.</li>
  <li>With action <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2391"><span class="MJXp-msubsup" id="MJXp-Span-2392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2393" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2394" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-89-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2694"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2695"><span class="msubsup" id="MathJax-Span-2696"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2697" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2698" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">A_t</script>, we observe reward <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2395"><span class="MJXp-msubsup" id="MJXp-Span-2396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2397" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2398" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399">t</span><span class="MJXp-mo" id="MJXp-Span-2400">+</span><span class="MJXp-mn" id="MJXp-Span-2401">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-90-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2699"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2700"><span class="msubsup" id="MathJax-Span-2701"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2702" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2703"><span class="mrow" id="MathJax-Span-2704"><span class="mi" id="MathJax-Span-2705" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2706" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2707" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">R_{t+1}</script> and get into the next state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2402"><span class="MJXp-msubsup" id="MJXp-Span-2403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2405" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">t</span><span class="MJXp-mo" id="MJXp-Span-2407">+</span><span class="MJXp-mn" id="MJXp-Span-2408">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-91-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2708"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2709"><span class="msubsup" id="MathJax-Span-2710"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2711" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2712"><span class="mrow" id="MathJax-Span-2713"><span class="mi" id="MathJax-Span-2714" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2715" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2716" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">S_{t+1}</script>.</li>
  <li>Update the action-value function: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410">Q</span><span class="MJXp-mo" id="MJXp-Span-2411" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2414" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2415" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2417" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2418" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2419" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2420" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2421">Q</span><span class="MJXp-mo" id="MJXp-Span-2422" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2424" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2425" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2428" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2429" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2430" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2431" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2432">α</span><span class="MJXp-mo" id="MJXp-Span-2433" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2436" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437">t</span><span class="MJXp-mo" id="MJXp-Span-2438">+</span><span class="MJXp-mn" id="MJXp-Span-2439">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2440" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2441">γ</span><span class="MJXp-msubsup" id="MJXp-Span-2442"><span class="MJXp-mo" id="MJXp-Span-2443" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2444" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2445">a</span><span class="MJXp-mo" id="MJXp-Span-2446">∈</span><span class="MJXp-mrow" id="MJXp-Span-2447"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2448">A</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449">Q</span><span class="MJXp-mo" id="MJXp-Span-2450" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2453" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">t</span><span class="MJXp-mo" id="MJXp-Span-2455">+</span><span class="MJXp-mn" id="MJXp-Span-2456">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2457" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2458">a</span><span class="MJXp-mo" id="MJXp-Span-2459" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2460" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">Q</span><span class="MJXp-mo" id="MJXp-Span-2462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2464" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2465" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2466" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2468" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2469" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2470" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2471" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-92-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2717"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2718"><span class="mi" id="MathJax-Span-2719" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-2720" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2721"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2722" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2723" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2724" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2725" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2726" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2727" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2728" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2729" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mi" id="MathJax-Span-2730" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">Q</span><span class="mo" id="MathJax-Span-2731" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2732"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2733" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2734" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2735" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2736" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2737" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2738" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2739" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2740" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2741" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">α</span><span class="mo" id="MathJax-Span-2742" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2743"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2744" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="texatom" id="MathJax-Span-2745"><span class="mrow" id="MathJax-Span-2746"><span class="mi" id="MathJax-Span-2747" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2748" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2749" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2750" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2751" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-2752" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 3.38em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2753" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 1.867em;"><span class="texatom" id="MathJax-Span-2754"><span class="mrow" id="MathJax-Span-2755"><span class="mi" id="MathJax-Span-2756" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2757" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-2758"><span class="mrow" id="MathJax-Span-2759"><span class="mi" id="MathJax-Span-2760" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-2761" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">Q</span><span class="mo" id="MathJax-Span-2762" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2763"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2764" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2765"><span class="mrow" id="MathJax-Span-2766"><span class="mi" id="MathJax-Span-2767" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2768" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2769" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2770" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2771" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-2772" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2773" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-2774" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">Q</span><span class="mo" id="MathJax-Span-2775" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2776"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2777" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2778" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2779" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2780" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2781" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2782" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2783" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2784" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">Q(S_t, A_t) \leftarrow Q(S_t, A_t) + \alpha (R_{t+1} + \gamma \max_{a \in \mathcal{A}} Q(S_{t+1}, a) - Q(S_t, A_t))</script>.</li>
  <li>t = t+1 and repeat from step 1.</li>
</ol>

<p>The first two steps are same as in SARSA. In step 3., Q-learning does not follow the current policy to pick the second action but rather estimate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2472"><span class="MJXp-msubsup" id="MJXp-Span-2473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474" style="margin-right: 0.05em;">Q</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2475" style="vertical-align: -0.4em;">∗</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-93-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2785"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2786"><span class="msubsup" id="MathJax-Span-2787"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2788" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mo" id="MathJax-Span-2789" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">Q_*</script> out of the best Q values independently of the current policy.</p>

<p style="width: 50%;" class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/sarsa_vs_q_learning.png" alt="SARSA and Q-learning"></p>
<p><em>Fig. 6. The backup diagrams for Q-learning and SARSA. (Image source: Replotted based on Figure 6.5 in Sutton &amp; Barto (2017))</em></p>

<h4 id="deep-q-network">Deep Q-Network</h4>

<p>Theoretically, we can memorize <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2476"><span class="MJXp-msubsup" id="MJXp-Span-2477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478" style="margin-right: 0.05em;">Q</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2479" style="vertical-align: -0.4em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-2480" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2481" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2482" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-94-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2790"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2791"><span class="msubsup" id="MathJax-Span-2792"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2793" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mo" id="MathJax-Span-2794" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2795" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2796" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-2797" style="font-family: MathJax_Main; padding-left: 0.154em;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-94">Q_*(.)</script> for all state-action pairs in Q-learning, like in a gigantic table. However, it quickly becomes computationally infeasible when the state and action space are large. Thus people use functions (i.e. a machine learning model) to approximate Q values and this is called <strong>function approximation</strong>. For example, if we use a function with parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2484">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-95-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2798"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2799"><span class="mi" id="MathJax-Span-2800" style="font-family: MathJax_Math-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">\theta</script> to calculate Q values, we can label Q value function as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2486">Q</span><span class="MJXp-mo" id="MJXp-Span-2487" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2488">s</span><span class="MJXp-mo" id="MJXp-Span-2489" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2490">a</span><span class="MJXp-mo" id="MJXp-Span-2491" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2492">θ</span><span class="MJXp-mo" id="MJXp-Span-2493" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-96-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2801"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2802"><span class="mi" id="MathJax-Span-2803" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-2804" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2805" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2806" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2807" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-2808" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-2809" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-2810" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">Q(s, a; \theta)</script>.</p>

<p>Unfortunately Q-learning may suffer from instability and divergence when combined with an nonlinear Q-value function approximation and <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#bootstrapping">bootstrapping</a> (See <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#deadly-triad-issue">Problems #2</a>).</p>

<p>Deep Q-Network (“DQN”; Mnih et al. 2015) aims to greatly improve and stabilize the training procedure of Q-learning by two innovative mechanisms:</p>
<ul>
  <li><strong>Experience Replay</strong>: All the episode steps <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2494"><span class="MJXp-msubsup" id="MJXp-Span-2495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2496" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2497" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2498" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2499" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2501" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2502" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2503" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2505" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2506" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2507" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2509" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2510" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2511" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2513" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2514" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2515">t</span><span class="MJXp-mo" id="MJXp-Span-2516">+</span><span class="MJXp-mn" id="MJXp-Span-2517">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2518" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-97-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2811"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2812"><span class="msubsup" id="MathJax-Span-2813"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2814" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-2815" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2816" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mo" id="MathJax-Span-2817" style="font-family: MathJax_Main; padding-left: 0.305em;">(</span><span class="msubsup" id="MathJax-Span-2818"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2819" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-2820" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2821" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2822" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2823" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2824" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2825" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2826" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2827" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-2828" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2829" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2830" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2831" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-2832"><span class="mrow" id="MathJax-Span-2833"><span class="mi" id="MathJax-Span-2834" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2835" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-2836" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2837" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">e_t = (S_t, A_t, R_t, S_{t+1})</script> are stored in one replay memory <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2519"><span class="MJXp-msubsup" id="MJXp-Span-2520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2522" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2523" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2524" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-2525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526" style="margin-right: 0.05em;">e</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2527" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2528" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2529" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2530" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2533" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2534" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-98-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2838"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2839"><span class="msubsup" id="MathJax-Span-2840"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2841" style="font-family: MathJax_Math-italic;">D</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-2842" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2843" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mo" id="MathJax-Span-2844" style="font-family: MathJax_Main; padding-left: 0.305em;">{</span><span class="msubsup" id="MathJax-Span-2845"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2846" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mn" id="MathJax-Span-2847" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2848" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2849" style="font-family: MathJax_Main; padding-left: 0.154em;">…</span><span class="mo" id="MathJax-Span-2850" style="font-family: MathJax_Main; padding-left: 0.154em;">,</span><span class="msubsup" id="MathJax-Span-2851" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2852" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-2853" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2854" style="font-family: MathJax_Main;">}</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">D_t = \{ e_1, \dots, e_t \}</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2535"><span class="MJXp-msubsup" id="MJXp-Span-2536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2538" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-99-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2855"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2856"><span class="msubsup" id="MathJax-Span-2857"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2858" style="font-family: MathJax_Math-italic;">D</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-2859" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">D_t</script> has experience tuples over many episodes. During Q-learning updates, samples are drawn at random from the replay memory and thus one sample could be used multiple times. Experience replay improves data efficiency, removes correlations in the observation sequences, and smooths over changes in the data distribution.</li>
  <li><strong>Periodically Updated Target</strong>: Q is optimized towards target values that are only periodically updated. The Q network is cloned and kept frozen as the optimization target every C steps (C is a hyperparameter). This modification makes the training more stable as it overcomes the short-term oscillations.</li>
</ul>

<p>The loss function looks like this:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2539"><span class="MJXp-mrow" id="MJXp-Span-2540"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2541">L</span></span><span class="MJXp-mo" id="MJXp-Span-2542" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2543">θ</span><span class="MJXp-mo" id="MJXp-Span-2544" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2545" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2546"><span class="MJXp-mrow" id="MJXp-Span-2547" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2548">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2549" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-2550">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551">s</span><span class="MJXp-mo" id="MJXp-Span-2552">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2553">a</span><span class="MJXp-mo" id="MJXp-Span-2554">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555">r</span><span class="MJXp-mo" id="MJXp-Span-2556">,</span><span class="MJXp-msup" id="MJXp-Span-2557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2559" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2560">)</span><span class="MJXp-mo" id="MJXp-Span-2561">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2562">U</span><span class="MJXp-mo" id="MJXp-Span-2563">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2564">D</span><span class="MJXp-mo" id="MJXp-Span-2565">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2566"><span class="MJXp-mo" id="MJXp-Span-2567" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">[</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2568"><span class="MJXp-mo" id="MJXp-Span-2569" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570">r</span><span class="MJXp-mo" id="MJXp-Span-2571" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2572">γ</span><span class="MJXp-munderover" id="MJXp-Span-2573"><span class=""><span class="MJXp-mo" id="MJXp-Span-2574" style="margin-left: 0.333em; margin-right: 0.333em;">max</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2575" style="margin-left: 0px;"><span class="MJXp-msup" id="MJXp-Span-2576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2577" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2578" style="vertical-align: 0.5em;">′</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2579">Q</span><span class="MJXp-mo" id="MJXp-Span-2580" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-2581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2583" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2584" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-2585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2586" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2587" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-2588" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-2589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2591" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2592">−</span></span></span><span class="MJXp-mo" id="MJXp-Span-2593" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2594" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595">Q</span><span class="MJXp-mo" id="MJXp-Span-2596" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597">s</span><span class="MJXp-mo" id="MJXp-Span-2598" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2599">a</span><span class="MJXp-mo" id="MJXp-Span-2600" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601">θ</span><span class="MJXp-mo" id="MJXp-Span-2602" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-2603"><span class="MJXp-mrow" id="MJXp-Span-2604" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2605" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2606" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-2607"><span class="MJXp-mo" id="MJXp-Span-2608" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">]</span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2860"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2861"><span class="texatom" id="MathJax-Span-2862"><span class="mrow" id="MathJax-Span-2863"><span class="mi" id="MathJax-Span-2864" style="font-family: MathJax_Caligraphic;">L</span></span></span><span class="mo" id="MathJax-Span-2865" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2866" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-2867" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2868" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-2869" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 5.648em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-2870"><span class="mrow" id="MathJax-Span-2871"><span class="mi" id="MathJax-Span-2872" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.778em; left: 0.658em;"><span class="texatom" id="MathJax-Span-2873"><span class="mrow" id="MathJax-Span-2874"><span class="mo" id="MathJax-Span-2875" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2876" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2877" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2878" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2879" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2880" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-2881" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-2882"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.3em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2883" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.181em; left: 0.355em;"><span class="mo" id="MathJax-Span-2884" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2885" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2886" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-2887" style="font-size: 70.7%; font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-2888" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2889" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-2890" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2891" style=""><span class="mrow" id="MathJax-Span-2892"><span class="mo" id="MathJax-Span-2893" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">[</span></span></span></span><span class="texatom" id="MathJax-Span-2894" style=""><span class="mrow" id="MathJax-Span-2895"><span class="mo" id="MathJax-Span-2896" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span><span class="mi" id="MathJax-Span-2897" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-2898" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-2899" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="munderover" id="MathJax-Span-2900" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.867em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1001.87em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-2901" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1000.56em, 4.236em, -999.997em); top: -3.274em; left: 0.658em;"><span class="texatom" id="MathJax-Span-2902"><span class="mrow" id="MathJax-Span-2903"><span class="msup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.231em; left: 0.355em;"><span class="mo" id="MathJax-Span-2906" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-2907" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">Q</span><span class="mo" id="MathJax-Span-2908" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-2909"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2910" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="mo" id="MathJax-Span-2911" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2912" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-2913" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2914" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.507em;"><span class="mo" id="MathJax-Span-2915" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2916" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-2917" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2918" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.456em;"><span class="texatom" id="MathJax-Span-2919"><span class="mrow" id="MathJax-Span-2920"><span class="mo" id="MathJax-Span-2921" style="font-size: 70.7%; font-family: MathJax_Main;">−</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2922" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2923" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-2924" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">Q</span><span class="mo" id="MathJax-Span-2925" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2926" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2927" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2928" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-2929" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-2930" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-2931" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-2932" style=""><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(2.976em, 1000.3em, 4.488em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-2933" style=""><span class="mrow" id="MathJax-Span-2934"><span class="mo" id="MathJax-Span-2935" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.534em; left: 0.456em;"><span class="mn" id="MathJax-Span-2936" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2937" style=""><span class="mrow" id="MathJax-Span-2938"><span class="mo" id="MathJax-Span-2939" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-100">\mathcal{L}(\theta) = \mathbb{E}_{(s, a, r, s') \sim U(D)} \Big[ \big( r + \gamma \max_{a'} Q(s', a'; \theta^{-}) - Q(s, a; \theta) \big)^2 \Big]</script>

<p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2610">U</span><span class="MJXp-mo" id="MJXp-Span-2611" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2612">D</span><span class="MJXp-mo" id="MJXp-Span-2613" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-101-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2940"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2941"><span class="mi" id="MathJax-Span-2942" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-2943" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2944" style="font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-2945" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">U(D)</script> is a uniform distribution over the replay memory D; <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2614"><span class="MJXp-msubsup" id="MJXp-Span-2615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2616" style="margin-right: 0.05em;">θ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2617" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2618">−</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-102-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2946"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2947"><span class="msubsup" id="MathJax-Span-2948"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2949" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.456em;"><span class="texatom" id="MathJax-Span-2950"><span class="mrow" id="MathJax-Span-2951"><span class="mo" id="MathJax-Span-2952" style="font-size: 70.7%; font-family: MathJax_Main;">−</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-102">\theta^{-}</script> is the parameters of the frozen target Q-network.</p>

<p>In addition, it is also found to be helpful to clip the error term to be between [-1, 1]. (I always get mixed feeling with parameter clipping, as many studies have shown that it works empirically but it makes the math much less pretty. :/)</p>

<p style="width: 75%;" class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/DQN_algorithm.png" alt="DQN algorithm"></p>
<p><em>Fig. 7. Algorithm for DQN with experience replay and occasionally frozen optimization target. The prepossessed sequence is the output of some processes running on the input images of Atari games. Don’t worry too much about it; just consider them as input feature vectors. (Image source: Mnih et al. 2015)</em></p>

<p>There are many extensions of DQN to improve the original design, such as DQN with dueling architecture (Wang et al. 2016) which estimates state-value function V(s) and advantage function A(s, a) with shared network parameters.</p>

<h3 id="combining-td-and-mc-learning">Combining TD and MC Learning</h3>

<p>In the previous <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#value-estimation">section</a> on value estimation in TD learning, we only trace one step further down the action chain when calculating the TD target. One can easily extend it to take multiple steps to estimate the return.</p>

<p>Let’s label the estimated return following n steps as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2619"><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621" style="margin-right: 0.05em;">G</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2623"><span class="MJXp-mo" id="MJXp-Span-2624">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625">n</span><span class="MJXp-mo" id="MJXp-Span-2626">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2622">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2627" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2628">n</span><span class="MJXp-mo" id="MJXp-Span-2629" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2630">1</span><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2632" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2633" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-2634">∞</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-103-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2953"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2954"><span class="msubsup" id="MathJax-Span-2955"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-2956" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.06em, 4.337em, -999.997em); top: -4.483em; left: 0.809em;"><span class="texatom" id="MathJax-Span-2957"><span class="mrow" id="MathJax-Span-2958"><span class="mo" id="MathJax-Span-2959" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2960" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-2961" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.36em, 4.136em, -999.997em); top: -3.677em; left: 0.809em;"><span class="mi" id="MathJax-Span-2962" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-2963" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2964" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">n</span><span class="mo" id="MathJax-Span-2965" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-2966" style="font-family: MathJax_Main; padding-left: 0.305em;">1</span><span class="mo" id="MathJax-Span-2967" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2968" style="font-family: MathJax_Main; padding-left: 0.154em;">…</span><span class="mo" id="MathJax-Span-2969" style="font-family: MathJax_Main; padding-left: 0.154em;">,</span><span class="mi" id="MathJax-Span-2970" style="font-family: MathJax_Main; padding-left: 0.154em;">∞</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">G_t^{(n)}, n=1, \dots, \infty</script>, then:</p>

<table class="info">
  <thead>
    <tr>
      <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2636">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-104-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2971"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 126%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2972"><span class="mi" id="MathJax-Span-2973" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-104">n</script></th>
      <th><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2637"><span class="MJXp-msubsup" id="MJXp-Span-2638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2639" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2640" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-105-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2974"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 126%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2975"><span class="msubsup" id="MathJax-Span-2976"><span style="display: inline-block; position: relative; width: 1.105em; height: 0px;"><span style="position: absolute; clip: rect(3.144em, 1000.77em, 4.191em, -999.997em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-2977" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span><span style="position: absolute; top: -3.855em; left: 0.774em;"><span class="mi" id="MathJax-Span-2978" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.026em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">G_t</script></th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2642">n</span><span class="MJXp-mo" id="MJXp-Span-2643" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2644">1</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-106-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2979"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2980"><span class="mi" id="MathJax-Span-2981" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-2982" style="font-family: MathJax_Main; padding-left: 0.283em;">=</span><span class="mn" id="MathJax-Span-2983" style="font-family: MathJax_Main; padding-left: 0.283em;">1</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-106">n=1</script></td>
      <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2645"><span class="MJXp-msubsup" id="MJXp-Span-2646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2647" style="margin-right: 0.05em;">G</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2649"><span class="MJXp-mo" id="MJXp-Span-2650">(</span><span class="MJXp-mn" id="MJXp-Span-2651">1</span><span class="MJXp-mo" id="MJXp-Span-2652">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2648">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2653" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2656" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2657">t</span><span class="MJXp-mo" id="MJXp-Span-2658">+</span><span class="MJXp-mn" id="MJXp-Span-2659">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2660" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2661">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2662">V</span><span class="MJXp-mo" id="MJXp-Span-2663" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2666" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2667">t</span><span class="MJXp-mo" id="MJXp-Span-2668">+</span><span class="MJXp-mn" id="MJXp-Span-2669">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2670" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-107-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-2984"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-2985"><span class="msubsup" id="MathJax-Span-2986"><span style="display: inline-block; position: relative; width: 1.795em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000.79em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-2987" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; clip: rect(3.307em, 1000.96em, 4.315em, -999.997em); top: -4.477em; left: 0.787em;"><span class="texatom" id="MathJax-Span-2988"><span class="mrow" id="MathJax-Span-2989"><span class="mo" id="MathJax-Span-2990" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2991" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2992" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.34em, 4.147em, -999.997em); top: -3.693em; left: 0.787em;"><span class="mi" id="MathJax-Span-2993" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-2994" style="font-family: MathJax_Main; padding-left: 0.283em;">=</span><span class="msubsup" id="MathJax-Span-2995" style="padding-left: 0.283em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-2996" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.787em;"><span class="texatom" id="MathJax-Span-2997"><span class="mrow" id="MathJax-Span-2998"><span class="mi" id="MathJax-Span-2999" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3000" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3001" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3002" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="mi" id="MathJax-Span-3003" style="font-family: MathJax_Math-italic; padding-left: 0.227em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3004" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.171em;"></span></span><span class="mo" id="MathJax-Span-3005" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3006"><span style="display: inline-block; position: relative; width: 1.851em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000.67em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3007" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.619em;"><span class="texatom" id="MathJax-Span-3008"><span class="mrow" id="MathJax-Span-3009"><span class="mi" id="MathJax-Span-3010" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3011" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3012" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3013" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">G_t^{(1)} = R_{t+1} + \gamma V(S_{t+1})</script></td>
      <td>TD learning</td>
    </tr>
    <tr>
      <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2672">n</span><span class="MJXp-mo" id="MJXp-Span-2673" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2674">2</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-108-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3014"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3015"><span class="mi" id="MathJax-Span-3016" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3017" style="font-family: MathJax_Main; padding-left: 0.283em;">=</span><span class="mn" id="MathJax-Span-3018" style="font-family: MathJax_Main; padding-left: 0.283em;">2</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">n=2</script></td>
      <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2675"><span class="MJXp-msubsup" id="MJXp-Span-2676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2677" style="margin-right: 0.05em;">G</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2679"><span class="MJXp-mo" id="MJXp-Span-2680">(</span><span class="MJXp-mn" id="MJXp-Span-2681">2</span><span class="MJXp-mo" id="MJXp-Span-2682">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2678">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2683" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2686" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687">t</span><span class="MJXp-mo" id="MJXp-Span-2688">+</span><span class="MJXp-mn" id="MJXp-Span-2689">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2690" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2691">γ</span><span class="MJXp-msubsup" id="MJXp-Span-2692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2694" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695">t</span><span class="MJXp-mo" id="MJXp-Span-2696">+</span><span class="MJXp-mn" id="MJXp-Span-2697">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2698" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2700" style="margin-right: 0.05em;">γ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2701" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2702">V</span><span class="MJXp-mo" id="MJXp-Span-2703" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2705" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2706" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2707">t</span><span class="MJXp-mo" id="MJXp-Span-2708">+</span><span class="MJXp-mn" id="MJXp-Span-2709">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2710" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-109-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3019"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3020"><span class="msubsup" id="MathJax-Span-3021"><span style="display: inline-block; position: relative; width: 1.795em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000.79em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3022" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; clip: rect(3.307em, 1000.96em, 4.315em, -999.997em); top: -4.477em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3023"><span class="mrow" id="MathJax-Span-3024"><span class="mo" id="MathJax-Span-3025" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-3026" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3027" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.34em, 4.147em, -999.997em); top: -3.693em; left: 0.787em;"><span class="mi" id="MathJax-Span-3028" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3029" style="font-family: MathJax_Main; padding-left: 0.283em;">=</span><span class="msubsup" id="MathJax-Span-3030" style="padding-left: 0.283em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3031" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3032"><span class="mrow" id="MathJax-Span-3033"><span class="mi" id="MathJax-Span-3034" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3035" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3036" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3037" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="mi" id="MathJax-Span-3038" style="font-family: MathJax_Math-italic; padding-left: 0.227em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3039"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3040" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3041"><span class="mrow" id="MathJax-Span-3042"><span class="mi" id="MathJax-Span-3043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3044" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3045" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3046" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="msubsup" id="MathJax-Span-3047" style="padding-left: 0.227em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.56em, 4.371em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3048" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.619em;"><span class="mn" id="MathJax-Span-3049" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mi" id="MathJax-Span-3050" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.171em;"></span></span><span class="mo" id="MathJax-Span-3051" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3052"><span style="display: inline-block; position: relative; width: 1.851em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000.67em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3053" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.619em;"><span class="texatom" id="MathJax-Span-3054"><span class="mrow" id="MathJax-Span-3055"><span class="mi" id="MathJax-Span-3056" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3057" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3058" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3059" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">G_t^{(2)} = R_{t+1} + \gamma R_{t+2} + \gamma^2 V(S_{t+2})</script></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>…</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2712">n</span><span class="MJXp-mo" id="MJXp-Span-2713" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2714">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-110-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3060"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3061"><span class="mi" id="MathJax-Span-3062" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3063" style="font-family: MathJax_Main; padding-left: 0.283em;">=</span><span class="mi" id="MathJax-Span-3064" style="font-family: MathJax_Math-italic; padding-left: 0.283em;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">n=n</script></td>
      <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2715"><span class="MJXp-msubsup" id="MJXp-Span-2716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717" style="margin-right: 0.05em;">G</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2719"><span class="MJXp-mo" id="MJXp-Span-2720">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2721">n</span><span class="MJXp-mo" id="MJXp-Span-2722">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2723" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2725" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2726" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2727">t</span><span class="MJXp-mo" id="MJXp-Span-2728">+</span><span class="MJXp-mn" id="MJXp-Span-2729">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2730" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2731">γ</span><span class="MJXp-msubsup" id="MJXp-Span-2732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2733" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2734" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735">t</span><span class="MJXp-mo" id="MJXp-Span-2736">+</span><span class="MJXp-mn" id="MJXp-Span-2737">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2738" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2739" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2740" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742" style="margin-right: 0.05em;">γ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2743" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2744">n</span><span class="MJXp-mo" id="MJXp-Span-2745">−</span><span class="MJXp-mn" id="MJXp-Span-2746">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2748" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2749" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2750">t</span><span class="MJXp-mo" id="MJXp-Span-2751">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2752">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-2753" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2755" style="margin-right: 0.05em;">γ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2756" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2757">V</span><span class="MJXp-mo" id="MJXp-Span-2758" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2760" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2761" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762">t</span><span class="MJXp-mo" id="MJXp-Span-2763">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2764">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-2765" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-111-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3065"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3066"><span class="msubsup" id="MathJax-Span-3067"><span style="display: inline-block; position: relative; width: 1.851em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000.79em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3068" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; clip: rect(3.307em, 1001.07em, 4.315em, -999.997em); top: -4.477em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3069"><span class="mrow" id="MathJax-Span-3070"><span class="mo" id="MathJax-Span-3071" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3072" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3073" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.34em, 4.147em, -999.997em); top: -3.693em; left: 0.787em;"><span class="mi" id="MathJax-Span-3074" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3075" style="font-family: MathJax_Main; padding-left: 0.283em;">=</span><span class="msubsup" id="MathJax-Span-3076" style="padding-left: 0.283em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3077" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3078"><span class="mrow" id="MathJax-Span-3079"><span class="mi" id="MathJax-Span-3080" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3081" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3082" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3083" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="mi" id="MathJax-Span-3084" style="font-family: MathJax_Math-italic; padding-left: 0.227em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3085"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3086" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3087"><span class="mrow" id="MathJax-Span-3088"><span class="mi" id="MathJax-Span-3089" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3090" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3091" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3092" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="mo" id="MathJax-Span-3093" style="font-family: MathJax_Main; padding-left: 0.227em;">⋯</span><span class="mo" id="MathJax-Span-3094" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="msubsup" id="MathJax-Span-3095" style="padding-left: 0.227em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.56em, 4.371em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3096" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.619em;"><span class="texatom" id="MathJax-Span-3097"><span class="mrow" id="MathJax-Span-3098"><span class="mi" id="MathJax-Span-3099" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3100" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3101" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3102"><span style="display: inline-block; position: relative; width: 2.075em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3103" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3104"><span class="mrow" id="MathJax-Span-3105"><span class="mi" id="MathJax-Span-3106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3107" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-3108" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3109" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="msubsup" id="MathJax-Span-3110" style="padding-left: 0.227em;"><span style="display: inline-block; position: relative; width: 1.123em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.56em, 4.371em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3111" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.619em;"><span class="mi" id="MathJax-Span-3112" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mi" id="MathJax-Span-3113" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.171em;"></span></span><span class="mo" id="MathJax-Span-3114" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3115"><span style="display: inline-block; position: relative; width: 1.907em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000.67em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3116" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.619em;"><span class="texatom" id="MathJax-Span-3117"><span class="mrow" id="MathJax-Span-3118"><span class="mi" id="MathJax-Span-3119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3120" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-3121" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3122" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-111">G_t^{(n)} = R_{t+1} + \gamma R_{t+2} + \dots + \gamma^{n-1} R_{t+n} + \gamma^n V(S_{t+n})</script></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>…</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2767">n</span><span class="MJXp-mo" id="MJXp-Span-2768" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-2769">∞</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-112-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3123"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3124"><span class="mi" id="MathJax-Span-3125" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3126" style="font-family: MathJax_Main; padding-left: 0.283em;">=</span><span class="mi" id="MathJax-Span-3127" style="font-family: MathJax_Main; padding-left: 0.283em;">∞</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">n=\infty</script></td>
      <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2770"><span class="MJXp-msubsup" id="MJXp-Span-2771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2772" style="margin-right: 0.05em;">G</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2774"><span class="MJXp-mo" id="MJXp-Span-2775">(</span><span class="MJXp-mi" id="MJXp-Span-2776">∞</span><span class="MJXp-mo" id="MJXp-Span-2777">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2773">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2778" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2780" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2781" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2782">t</span><span class="MJXp-mo" id="MJXp-Span-2783">+</span><span class="MJXp-mn" id="MJXp-Span-2784">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2785" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2786">γ</span><span class="MJXp-msubsup" id="MJXp-Span-2787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2788" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2789" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790">t</span><span class="MJXp-mo" id="MJXp-Span-2791">+</span><span class="MJXp-mn" id="MJXp-Span-2792">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2793" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2794" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2795" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797" style="margin-right: 0.05em;">γ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2798" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799">T</span><span class="MJXp-mo" id="MJXp-Span-2800">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2801">t</span><span class="MJXp-mo" id="MJXp-Span-2802">−</span><span class="MJXp-mn" id="MJXp-Span-2803">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2805" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2806" style="vertical-align: -0.4em;">T</span></span><span class="MJXp-mo" id="MJXp-Span-2807" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2809" style="margin-right: 0.05em;">γ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2810" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2811">T</span><span class="MJXp-mo" id="MJXp-Span-2812">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2813">t</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814">V</span><span class="MJXp-mo" id="MJXp-Span-2815" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2817" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2818" style="vertical-align: -0.4em;">T</span></span><span class="MJXp-mo" id="MJXp-Span-2819" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-113-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3128"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3129"><span class="msubsup" id="MathJax-Span-3130"><span style="display: inline-block; position: relative; width: 2.131em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000.79em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3131" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; clip: rect(3.307em, 1001.35em, 4.315em, -999.997em); top: -4.477em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3132"><span class="mrow" id="MathJax-Span-3133"><span class="mo" id="MathJax-Span-3134" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3135" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span><span class="mo" id="MathJax-Span-3136" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; clip: rect(3.363em, 1000.34em, 4.147em, -999.997em); top: -3.693em; left: 0.787em;"><span class="mi" id="MathJax-Span-3137" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3138" style="font-family: MathJax_Main; padding-left: 0.283em;">=</span><span class="msubsup" id="MathJax-Span-3139" style="padding-left: 0.283em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3140" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3141"><span class="mrow" id="MathJax-Span-3142"><span class="mi" id="MathJax-Span-3143" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3144" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3145" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3146" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="mi" id="MathJax-Span-3147" style="font-family: MathJax_Math-italic; padding-left: 0.227em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-3148"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3149" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.787em;"><span class="texatom" id="MathJax-Span-3150"><span class="mrow" id="MathJax-Span-3151"><span class="mi" id="MathJax-Span-3152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3153" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3154" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3155" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="mo" id="MathJax-Span-3156" style="font-family: MathJax_Main; padding-left: 0.227em;">⋯</span><span class="mo" id="MathJax-Span-3157" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="msubsup" id="MathJax-Span-3158" style="padding-left: 0.227em;"><span style="display: inline-block; position: relative; width: 2.859em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.56em, 4.371em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3159" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.619em;"><span class="texatom" id="MathJax-Span-3160"><span class="mrow" id="MathJax-Span-3161"><span class="mi" id="MathJax-Span-3162" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.115em;"></span></span><span class="mo" id="MathJax-Span-3163" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-3164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3165" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3166" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3167"><span style="display: inline-block; position: relative; width: 1.347em; height: 0px;"><span style="position: absolute; clip: rect(3.139em, 1000.73em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3168" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.787em;"><span class="mi" id="MathJax-Span-3169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.115em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3170" style="font-family: MathJax_Main; padding-left: 0.227em;">+</span><span class="msubsup" id="MathJax-Span-3171" style="padding-left: 0.227em;"><span style="display: inline-block; position: relative; width: 1.963em; height: 0px;"><span style="position: absolute; clip: rect(3.363em, 1000.56em, 4.371em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3172" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.619em;"><span class="texatom" id="MathJax-Span-3173"><span class="mrow" id="MathJax-Span-3174"><span class="mi" id="MathJax-Span-3175" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.115em;"></span></span><span class="mo" id="MathJax-Span-3176" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-3177" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mi" id="MathJax-Span-3178" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.171em;"></span></span><span class="mo" id="MathJax-Span-3179" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3180"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000.67em, 4.147em, -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-3181" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span><span style="position: absolute; top: -3.805em; left: 0.619em;"><span class="mi" id="MathJax-Span-3182" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.115em;"></span></span><span style="display: inline-block; width: 0px; height: 3.979em;"></span></span></span></span><span class="mo" id="MathJax-Span-3183" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">G_t^{(\infty)} = R_{t+1} + \gamma R_{t+2} + \dots + \gamma^{T-t-1} R_T + \gamma^{T-t} V(S_T)</script></td>
      <td>MC estimation</td>
    </tr>
  </tbody>
</table>

<p>The generalized n-step TD learning still has the <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#value-estimation">same</a> form for updating the value function:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821">V</span><span class="MJXp-mo" id="MJXp-Span-2822" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2824" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2825" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2826" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2827" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2828">V</span><span class="MJXp-mo" id="MJXp-Span-2829" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2831" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2832" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2833" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2834" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2835">α</span><span class="MJXp-mo" id="MJXp-Span-2836" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2838" style="margin-right: 0.05em;">G</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2840"><span class="MJXp-mo" id="MJXp-Span-2841">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2842">n</span><span class="MJXp-mo" id="MJXp-Span-2843">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2839">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2844" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2845">V</span><span class="MJXp-mo" id="MJXp-Span-2846" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2848" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2849" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-2850" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2851" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3184"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3185"><span class="mi" id="MathJax-Span-3186" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-3187" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3188"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3189" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-3190" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3191" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3192" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mi" id="MathJax-Span-3193" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-3194" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3195"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3196" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-3197" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3198" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3199" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-3200" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">α</span><span class="mo" id="MathJax-Span-3201" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3202"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3203" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.06em, 4.337em, -999.997em); top: -4.483em; left: 0.809em;"><span class="texatom" id="MathJax-Span-3204"><span class="mrow" id="MathJax-Span-3205"><span class="mo" id="MathJax-Span-3206" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3207" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3208" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.36em, 4.136em, -999.997em); top: -3.677em; left: 0.809em;"><span class="mi" id="MathJax-Span-3209" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3210" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-3211" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-3212" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3213"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3214" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-3215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3216" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3217" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-114">V(S_t) \leftarrow V(S_t) + \alpha (G_t^{(n)} - V(S_t))</script>

<p style="width: 70%;" class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/TD_lambda.png" alt="TD lambda"></p>

<p>We are free to pick any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-115-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3218"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3219"><span class="mi" id="MathJax-Span-3220" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">n</script> in TD learning as we like. Now the question becomes what is the best <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2855">n</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-116-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3221"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3222"><span class="mi" id="MathJax-Span-3223" style="font-family: MathJax_Math-italic;">n</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">n</script>? Which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2856"><span class="MJXp-msubsup" id="MJXp-Span-2857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2858" style="margin-right: 0.05em;">G</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2860"><span class="MJXp-mo" id="MJXp-Span-2861">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2862">n</span><span class="MJXp-mo" id="MJXp-Span-2863">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859">t</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-117-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3224"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3225"><span class="msubsup" id="MathJax-Span-3226"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3227" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.06em, 4.337em, -999.997em); top: -4.483em; left: 0.809em;"><span class="texatom" id="MathJax-Span-3228"><span class="mrow" id="MathJax-Span-3229"><span class="mo" id="MathJax-Span-3230" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3231" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3232" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.36em, 4.136em, -999.997em); top: -3.677em; left: 0.809em;"><span class="mi" id="MathJax-Span-3233" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-117">G_t^{(n)}</script> gives us the best return approximation? A common yet smart solution is to apply a weighted sum of all possible n-step TD targets rather than to pick a single best n. The weights decay by a factor λ with n, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2864"><span class="MJXp-msubsup" id="MJXp-Span-2865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2866" style="margin-right: 0.05em;">λ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2867" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868">n</span><span class="MJXp-mo" id="MJXp-Span-2869">−</span><span class="MJXp-mn" id="MJXp-Span-2870">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-118-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3234"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3235"><span class="msubsup" id="MathJax-Span-3236"><span style="display: inline-block; position: relative; width: 1.968em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3237" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.607em;"><span class="texatom" id="MathJax-Span-3238"><span class="mrow" id="MathJax-Span-3239"><span class="mi" id="MathJax-Span-3240" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3241" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3242" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-118">\lambda^{n-1}</script>; the intuition is similar to <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#value-estimation">why</a> we want to discount future rewards when computing the return: the more future we look into the less confident we would be. To make all the weight (n → ∞) sum up to 1, we multiply every weight by (1-λ), because:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2871"><span class="MJXp-mtable" id="MJXp-Span-2872"><span><span class="MJXp-mtr" id="MJXp-Span-2873" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2874" style="text-align: right;"><span class="MJXp-mtext" id="MJXp-Span-2875">let&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2876">S</span></span><span class="MJXp-mtd" id="MJXp-Span-2877" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2878"></span><span class="MJXp-mo" id="MJXp-Span-2879" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2880">1</span><span class="MJXp-mo" id="MJXp-Span-2881" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2882">λ</span><span class="MJXp-mo" id="MJXp-Span-2883" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2885" style="margin-right: 0.05em;">λ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2886" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2887" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2888" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2889" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2890" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2891">S</span></span><span class="MJXp-mtd" id="MJXp-Span-2892" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2893"></span><span class="MJXp-mo" id="MJXp-Span-2894" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2895">1</span><span class="MJXp-mo" id="MJXp-Span-2896" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2897">λ</span><span class="MJXp-mo" id="MJXp-Span-2898" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2899">1</span><span class="MJXp-mo" id="MJXp-Span-2900" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2901">λ</span><span class="MJXp-mo" id="MJXp-Span-2902" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2904" style="margin-right: 0.05em;">λ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2905" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2906" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2907" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2908" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2909" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2910" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2911">S</span></span><span class="MJXp-mtd" id="MJXp-Span-2912" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2913"></span><span class="MJXp-mo" id="MJXp-Span-2914" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2915">1</span><span class="MJXp-mo" id="MJXp-Span-2916" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2917">λ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2918">S</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2919" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2920" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921">S</span></span><span class="MJXp-mtd" id="MJXp-Span-2922" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-2923"></span><span class="MJXp-mo" id="MJXp-Span-2924" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2925">1</span><span class="MJXp-mrow" id="MJXp-Span-2926"><span class="MJXp-mo" id="MJXp-Span-2927" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-2928" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2929">1</span><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2931">λ</span><span class="MJXp-mo" id="MJXp-Span-2932" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3243"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3244"><span class="mtable" id="MathJax-Span-3245" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 13.259em; height: 0px;"><span style="position: absolute; clip: rect(2.926em, 1002.02em, 8.017em, -999.997em); top: -5.743em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.019em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1002.02em, 4.136em, -999.997em); top: -5.945em; right: 0em;"><span class="mtd" id="MathJax-Span-3246"><span class="mrow" id="MathJax-Span-3247"><span class="mtext" id="MathJax-Span-3248" style="font-family: MathJax_Main;">let&nbsp;</span><span class="mi" id="MathJax-Span-3249" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -4.534em; right: 0em;"><span class="mtd" id="MathJax-Span-3263"><span class="mrow" id="MathJax-Span-3264"><span class="mi" id="MathJax-Span-3265" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.173em; right: 0em;"><span class="mtd" id="MathJax-Span-3284"><span class="mrow" id="MathJax-Span-3285"><span class="mi" id="MathJax-Span-3286" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -1.913em; right: 0em;"><span class="mtd" id="MathJax-Span-3295"><span class="mrow" id="MathJax-Span-3296"><span class="mi" id="MathJax-Span-3297" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.748em;"></span></span><span style="position: absolute; clip: rect(3.178em, 1011.19em, 8.621em, -999.997em); top: -6.147em; left: 2.019em;"><span style="display: inline-block; position: relative; width: 11.242em; height: 0px;"><span style="position: absolute; clip: rect(2.926em, 1008.12em, 4.236em, -999.997em); top: -5.945em; left: 0em;"><span class="mtd" id="MathJax-Span-3250"><span class="mrow" id="MathJax-Span-3251"><span class="mi" id="MathJax-Span-3252"></span><span class="mo" id="MathJax-Span-3253" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-3254" style="font-family: MathJax_Main; padding-left: 0.305em;">1</span><span class="mo" id="MathJax-Span-3255" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-3256" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">λ</span><span class="mo" id="MathJax-Span-3257" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="msubsup" id="MathJax-Span-3258" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3259" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.607em;"><span class="mn" id="MathJax-Span-3260" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3261" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mo" id="MathJax-Span-3262" style="font-family: MathJax_Main; padding-left: 0.204em;">…</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.926em, 1011.19em, 4.388em, -999.997em); top: -4.534em; left: 0em;"><span class="mtd" id="MathJax-Span-3266"><span class="mrow" id="MathJax-Span-3267"><span class="mi" id="MathJax-Span-3268"></span><span class="mo" id="MathJax-Span-3269" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-3270" style="font-family: MathJax_Main; padding-left: 0.305em;">1</span><span class="mo" id="MathJax-Span-3271" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-3272" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">λ</span><span class="mo" id="MathJax-Span-3273" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-3274" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3275" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-3276" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">λ</span><span class="mo" id="MathJax-Span-3277" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="msubsup" id="MathJax-Span-3278" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3279" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.383em; left: 0.607em;"><span class="mn" id="MathJax-Span-3280" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3281" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mo" id="MathJax-Span-3282" style="font-family: MathJax_Main; padding-left: 0.204em;">…</span><span class="mo" id="MathJax-Span-3283" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1004.29em, 4.236em, -999.997em); top: -3.173em; left: 0em;"><span class="mtd" id="MathJax-Span-3287"><span class="mrow" id="MathJax-Span-3288"><span class="mi" id="MathJax-Span-3289"></span><span class="mo" id="MathJax-Span-3290" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-3291" style="font-family: MathJax_Main; padding-left: 0.305em;">1</span><span class="mo" id="MathJax-Span-3292" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-3293" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">λ</span><span class="mi" id="MathJax-Span-3294" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1005.35em, 4.388em, -999.997em); top: -1.913em; left: 0em;"><span class="mtd" id="MathJax-Span-3298"><span class="mrow" id="MathJax-Span-3299"><span class="mi" id="MathJax-Span-3300"></span><span class="mo" id="MathJax-Span-3301" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mn" id="MathJax-Span-3302" style="font-family: MathJax_Main; padding-left: 0.305em;">1</span><span class="texatom" id="MathJax-Span-3303"><span class="mrow" id="MathJax-Span-3304"><span class="mo" id="MathJax-Span-3305" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-3306" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-3307" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3308" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-3309" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">λ</span><span class="mo" id="MathJax-Span-3310" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.152em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-119">% <![CDATA[
\begin{aligned}
\text{let } S &= 1 + \lambda + \lambda^2 + \dots \\
S &= 1 + \lambda(1 + \lambda + \lambda^2 + \dots) \\
S &= 1 + \lambda S \\
S &= 1 / (1-\lambda)
\end{aligned} %]]></script>

<p>This weighted sum of many n-step returns is called λ-return <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2933"><span class="MJXp-msubsup" id="MJXp-Span-2934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2935" style="margin-right: 0.05em;">G</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2938">λ</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2939" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2940" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2941">1</span><span class="MJXp-mo" id="MJXp-Span-2942" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2943">λ</span><span class="MJXp-mo" id="MJXp-Span-2944" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-2945"><span class="MJXp-mo" id="MJXp-Span-2946" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2951"><span class="MJXp-mi" id="MJXp-Span-2952">∞</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2948">n</span><span class="MJXp-mo" id="MJXp-Span-2949">=</span><span class="MJXp-mn" id="MJXp-Span-2950">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2954" style="margin-right: 0.05em;">λ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2955" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2956">n</span><span class="MJXp-mo" id="MJXp-Span-2957">−</span><span class="MJXp-mn" id="MJXp-Span-2958">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2959"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2960" style="margin-right: 0.05em;">G</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2962"><span class="MJXp-mo" id="MJXp-Span-2963">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2964">n</span><span class="MJXp-mo" id="MJXp-Span-2965">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2961">t</span></span></span></span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-120-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3311"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3312"><span class="msubsup" id="MathJax-Span-3313"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3314" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1000.51em, 4.136em, -999.997em); top: -4.332em; left: 0.809em;"><span class="texatom" id="MathJax-Span-3315"><span class="mrow" id="MathJax-Span-3316"><span class="mi" id="MathJax-Span-3317" style="font-size: 70.7%; font-family: MathJax_Math-italic;">λ</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.36em, 4.136em, -999.997em); top: -3.677em; left: 0.809em;"><span class="mi" id="MathJax-Span-3318" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3319" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mo" id="MathJax-Span-3320" style="font-family: MathJax_Main; padding-left: 0.305em;">(</span><span class="mn" id="MathJax-Span-3321" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3322" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-3323" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">λ</span><span class="mo" id="MathJax-Span-3324" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-3325" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1001.01em, 4.388em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3326" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.531em, 1000.81em, 4.136em, -999.997em); top: -4.433em; left: 1.061em;"><span class="texatom" id="MathJax-Span-3327"><span class="mrow" id="MathJax-Span-3328"><span class="mi" id="MathJax-Span-3329" style="font-size: 70.7%; font-family: MathJax_Main;">∞</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1001.41em, 4.136em, -999.997em); top: -3.677em; left: 1.061em;"><span class="texatom" id="MathJax-Span-3330"><span class="mrow" id="MathJax-Span-3331"><span class="mi" id="MathJax-Span-3332" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3333" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-3334" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3335" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.968em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3336" style="font-family: MathJax_Math-italic;">λ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.607em;"><span class="texatom" id="MathJax-Span-3337"><span class="mrow" id="MathJax-Span-3338"><span class="mi" id="MathJax-Span-3339" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3340" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3341" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3342"><span style="display: inline-block; position: relative; width: 1.817em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3343" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.279em, 1001.06em, 4.337em, -999.997em); top: -4.483em; left: 0.809em;"><span class="texatom" id="MathJax-Span-3344"><span class="mrow" id="MathJax-Span-3345"><span class="mo" id="MathJax-Span-3346" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3347" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3348" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.36em, 4.136em, -999.997em); top: -3.677em; left: 0.809em;"><span class="mi" id="MathJax-Span-3349" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-120">G_t^{\lambda} = (1-\lambda) \sum_{n=1}^{\infty} \lambda^{n-1} G_t^{(n)}</script>. TD learning that adopts λ-return for value updating is labeled as <strong>TD(λ)</strong>. The original version we introduced <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#value-estimation">above</a> is equivalent to <strong>TD(0)</strong>.</p>

<p class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/TD_MC_DP_backups.png" alt="Backup diagrams"></p>
<p><em>Fig. 8. Comparison of the backup diagrams of Monte-Carlo, Temporal-Difference learning, and Dynamic Programming for state value functions. (Image source: David Silver’s RL course <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching_files/MC-TD.pdf">lecture 4</a>: “Model-Free Prediction”)</em></p>

<h3 id="policy-gradient">Policy Gradient</h3>

<p>All the methods we have introduced above aim to learn the state/action value function and then to select actions accordingly. Policy Gradient methods instead learn the policy directly with a parameterized function respect to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2967">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-121-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3350"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3351"><span class="mi" id="MathJax-Span-3352" style="font-family: MathJax_Math-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-121">\theta</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2969">π</span><span class="MJXp-mo" id="MJXp-Span-2970" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2971">a</span><span class="MJXp-mo" id="MJXp-Span-2972" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2973">s</span><span class="MJXp-mo" id="MJXp-Span-2974" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2975">θ</span><span class="MJXp-mo" id="MJXp-Span-2976" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-122-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3353"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3354"><span class="mi" id="MathJax-Span-3355" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3356" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3357" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3358" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3359" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3360" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3361" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3362" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-122">\pi(a \vert s; \theta)</script>. Let’s define the reward function (opposite of loss function) as <em>the expected return</em> and train the algorithm with the goal to maximize the reward function. My <a href="https://lilianweng.github.io/lil-log/2018/04/08/policy-gradient-algorithms.html">next post</a> described why the policy gradient theorem works (proof) and introduced a number of policy gradient algorithms.</p>

<p>In discrete space:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2977"><span class="MJXp-mrow" id="MJXp-Span-2978"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2979">J</span></span><span class="MJXp-mo" id="MJXp-Span-2980" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2981">θ</span><span class="MJXp-mo" id="MJXp-Span-2982" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2983" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2985" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2986" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2988" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2989" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2990" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2992" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2993" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2994" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2995" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2996"><span class="MJXp-mrow" id="MJXp-Span-2997" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-2998">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2999" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3001" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3002" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3003" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3005" style="margin-right: 0.05em;">V</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3006" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3007" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3363"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3364"><span class="texatom" id="MathJax-Span-3365"><span class="mrow" id="MathJax-Span-3366"><span class="mi" id="MathJax-Span-3367" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3368" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3369" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3370" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3371" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-3372" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.363em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3373" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-3374"><span class="mrow" id="MathJax-Span-3375"><span class="msubsup" id="MathJax-Span-3376"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3377" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3378" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3379" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3380"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3381" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mn" id="MathJax-Span-3382" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3383" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3384" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-3385" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-3386"><span class="mrow" id="MathJax-Span-3387"><span class="mi" id="MathJax-Span-3388" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="texatom" id="MathJax-Span-3389"><span class="mrow" id="MathJax-Span-3390"><span class="msubsup" id="MathJax-Span-3391"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3392" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3393" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3394" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-3395"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3396" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mn" id="MathJax-Span-3397" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3398" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-123">\mathcal{J}(\theta) = V_{\pi_\theta}(S_1) = \mathbb{E}_{\pi_\theta}[V_1]</script>

<p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3008"><span class="MJXp-msubsup" id="MJXp-Span-3009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3010" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3011" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-124-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3399"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3400"><span class="msubsup" id="MathJax-Span-3401"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3402" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mn" id="MathJax-Span-3403" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-124">S_1</script> is the initial starting state.</p>

<p>Or in continuous space:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3012"><span class="MJXp-mrow" id="MJXp-Span-3013"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3014">J</span></span><span class="MJXp-mo" id="MJXp-Span-3015" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3016">θ</span><span class="MJXp-mo" id="MJXp-Span-3017" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3018" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3019"><span class=""><span class="MJXp-mo" id="MJXp-Span-3020" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3021" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3022">s</span><span class="MJXp-mo" id="MJXp-Span-3023">∈</span><span class="MJXp-mrow" id="MJXp-Span-3024"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3025">S</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3027" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3028" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3030" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3031" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3032" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3033">s</span><span class="MJXp-mo" id="MJXp-Span-3034" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3036" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3037" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3039" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3040" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3041" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3042">s</span><span class="MJXp-mo" id="MJXp-Span-3043" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3044" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3045"><span class=""><span class="MJXp-mo" id="MJXp-Span-3046" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3047" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3048">s</span><span class="MJXp-mo" id="MJXp-Span-3049">∈</span><span class="MJXp-mrow" id="MJXp-Span-3050"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3051">S</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3052"><span class="MJXp-mo" id="MJXp-Span-3053" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3055" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3056" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3058" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3059" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3060" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3061">s</span><span class="MJXp-mo" id="MJXp-Span-3062" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-3063"><span class=""><span class="MJXp-mo" id="MJXp-Span-3064" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3065" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3066">a</span><span class="MJXp-mo" id="MJXp-Span-3067">∈</span><span class="MJXp-mrow" id="MJXp-Span-3068"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3069">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3070">π</span><span class="MJXp-mo" id="MJXp-Span-3071" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3072">a</span><span class="MJXp-mo" id="MJXp-Span-3073" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3074">s</span><span class="MJXp-mo" id="MJXp-Span-3075" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3076">θ</span><span class="MJXp-mo" id="MJXp-Span-3077" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3079" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3080" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3081" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3082">s</span><span class="MJXp-mo" id="MJXp-Span-3083" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3084">a</span><span class="MJXp-mo" id="MJXp-Span-3085" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-3086"><span class="MJXp-mo" id="MJXp-Span-3087" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3404"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3405"><span class="texatom" id="MathJax-Span-3406"><span class="mrow" id="MathJax-Span-3407"><span class="mi" id="MathJax-Span-3408" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3409" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3410" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3411" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3412" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-3413" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3414" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.287em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-3415"><span class="mrow" id="MathJax-Span-3416"><span class="mi" id="MathJax-Span-3417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3418" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3419"><span class="mrow" id="MathJax-Span-3420"><span class="mi" id="MathJax-Span-3421" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3422" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3423" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="texatom" id="MathJax-Span-3424"><span class="mrow" id="MathJax-Span-3425"><span class="msubsup" id="MathJax-Span-3426"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3427" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3428" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3429" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3430" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3431" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3432"><span style="display: inline-block; position: relative; width: 1.363em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3433" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="texatom" id="MathJax-Span-3434"><span class="mrow" id="MathJax-Span-3435"><span class="msubsup" id="MathJax-Span-3436"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3437" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3438" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3439" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3440" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3441" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3442" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-3443" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3444" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.287em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-3445"><span class="mrow" id="MathJax-Span-3446"><span class="mi" id="MathJax-Span-3447" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3448" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3449"><span class="mrow" id="MathJax-Span-3450"><span class="mi" id="MathJax-Span-3451" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3452" style="padding-left: 0.154em;"><span class="mrow" id="MathJax-Span-3453"><span class="mo" id="MathJax-Span-3454" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span></span></span><span class="msubsup" id="MathJax-Span-3455"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3456" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="texatom" id="MathJax-Span-3457"><span class="mrow" id="MathJax-Span-3458"><span class="msubsup" id="MathJax-Span-3459"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3460" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3461" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3462" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3463" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3464" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-3465" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3466" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3467"><span class="mrow" id="MathJax-Span-3468"><span class="mi" id="MathJax-Span-3469" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3470" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3471"><span class="mrow" id="MathJax-Span-3472"><span class="mi" id="MathJax-Span-3473" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3474" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3475" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3476" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3477" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3478" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3479" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3480" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3481" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3482"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3483" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-3484" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3485" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3486" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3487" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3488" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-3489" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-3490" style=""><span class="mrow" id="MathJax-Span-3491"><span class="mo" id="MathJax-Span-3492" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-125">\mathcal{J}(\theta) = \sum_{s \in \mathcal{S}} d_{\pi_\theta}(s) V_{\pi_\theta}(s) = \sum_{s \in \mathcal{S}} \Big( d_{\pi_\theta}(s) \sum_{a \in \mathcal{A}} \pi(a \vert s, \theta) Q_\pi(s, a) \Big)</script>

<p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3088"><span class="MJXp-msubsup" id="MJXp-Span-3089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3090" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3091" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3093" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3094" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3095" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3096">s</span><span class="MJXp-mo" id="MJXp-Span-3097" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-126-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3493"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3494"><span class="msubsup" id="MathJax-Span-3495"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3496" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="texatom" id="MathJax-Span-3497"><span class="mrow" id="MathJax-Span-3498"><span class="msubsup" id="MathJax-Span-3499"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3501" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3502" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3503" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3504" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-126">d_{\pi_\theta}(s)</script> is stationary distribution of Markov chain for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3098"><span class="MJXp-msubsup" id="MJXp-Span-3099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3100" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3101" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-127-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3505"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3506"><span class="msubsup" id="MathJax-Span-3507"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3508" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="mi" id="MathJax-Span-3509" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">\pi_\theta</script>. If you are unfamiliar with the definition of a “stationary distribution,” please check this <a href="https://jeremykun.com/2015/04/06/markov-chain-monte-carlo-without-all-the-bullshit/">reference</a>.</p>

<p>Using <em>gradient ascent</em> we can find the best θ that produces the highest return. It is natural to expect policy-based methods are more useful in continuous space, because there is an infinite number of actions and/or states to estimate the values for in continuous space and hence value-based approaches are computationally much more expensive.</p>

<h4 id="policy-gradient-theorem">Policy Gradient Theorem</h4>

<p>Computing the gradient <em>numerically</em> can be done by perturbing θ by a small amount ε in the k-th dimension. It works even when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3103">J</span><span class="MJXp-mo" id="MJXp-Span-3104" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3105">θ</span><span class="MJXp-mo" id="MJXp-Span-3106" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-128-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3510"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3511"><span class="mi" id="MathJax-Span-3512" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-3513" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3514" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3515" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-128">J(\theta)</script> is not differentiable (nice!), but unsurprisingly very slow.</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3107"><span class="MJXp-mfrac" id="MJXp-Span-3108" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3109">∂</span><span class="MJXp-mrow" id="MJXp-Span-3110"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3111">J</span></span><span class="MJXp-mo" id="MJXp-Span-3112" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3113">θ</span><span class="MJXp-mo" id="MJXp-Span-3114" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3115">∂</span><span class="MJXp-msubsup" id="MJXp-Span-3116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3117" style="margin-right: 0.05em;">θ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3118" style="vertical-align: -0.4em;">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3119" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mfrac" id="MJXp-Span-3120" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-3121"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3122">J</span></span><span class="MJXp-mo" id="MJXp-Span-3123" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3124">θ</span><span class="MJXp-mo" id="MJXp-Span-3125" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3126">ϵ</span><span class="MJXp-msubsup" id="MJXp-Span-3127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3128" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3129" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-3130" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3131" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-3132"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3133">J</span></span><span class="MJXp-mo" id="MJXp-Span-3134" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3135">θ</span><span class="MJXp-mo" id="MJXp-Span-3136" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3137">ϵ</span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3516"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3517"><span class="mfrac" id="MathJax-Span-3518"><span style="display: inline-block; position: relative; width: 2.775em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.077em, 1002.57em, 4.388em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.308em;"><span class="mrow" id="MathJax-Span-3519"><span class="mi" id="MathJax-Span-3520" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="texatom" id="MathJax-Span-3521"><span class="mrow" id="MathJax-Span-3522"><span class="mi" id="MathJax-Span-3523" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3524" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3525" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3526" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.46em, 4.287em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.754em;"><span class="mrow" id="MathJax-Span-3527"><span class="mi" id="MathJax-Span-3528" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="msubsup" id="MathJax-Span-3529"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3530" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-3531" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1002.77em, 1.212em, -999.997em); top: -1.258em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.775em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="mo" id="MathJax-Span-3532" style="font-family: MathJax_Main; padding-left: 0.305em;">≈</span><span class="mfrac" id="MathJax-Span-3533" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 8.067em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.077em, 1007.87em, 4.388em, -999.997em); top: -4.685em; left: 50%; margin-left: -3.979em;"><span class="mrow" id="MathJax-Span-3534"><span class="texatom" id="MathJax-Span-3535"><span class="mrow" id="MathJax-Span-3536"><span class="mi" id="MathJax-Span-3537" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3538" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3539" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3540" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-3541" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">ϵ</span><span class="msubsup" id="MathJax-Span-3542"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3543" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.557em;"><span class="mi" id="MathJax-Span-3544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3545" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3546" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="texatom" id="MathJax-Span-3547" style="padding-left: 0.204em;"><span class="mrow" id="MathJax-Span-3548"><span class="mi" id="MathJax-Span-3549" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3550" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3551" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3552" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.274em; left: 50%; margin-left: -0.199em;"><span class="mi" id="MathJax-Span-3553" style="font-family: MathJax_Math-italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1008.07em, 1.212em, -999.997em); top: -1.258em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.067em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-129">\frac{\partial \mathcal{J}(\theta)}{\partial \theta_k} \approx \frac{\mathcal{J}(\theta + \epsilon u_k) - \mathcal{J}(\theta)}{\epsilon}</script>

<p>Or <em>analytically</em>,</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3138"><span class="MJXp-mrow" id="MJXp-Span-3139"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3140">J</span></span><span class="MJXp-mo" id="MJXp-Span-3141" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3142">θ</span><span class="MJXp-mo" id="MJXp-Span-3143" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3144" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3145"><span class="MJXp-mrow" id="MJXp-Span-3146" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3147">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3148" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3150" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3151" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3152" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3153">r</span><span class="MJXp-mo" id="MJXp-Span-3154" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3155" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3156"><span class=""><span class="MJXp-mo" id="MJXp-Span-3157" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3158" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3159">s</span><span class="MJXp-mo" id="MJXp-Span-3160">∈</span><span class="MJXp-mrow" id="MJXp-Span-3161"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3162">S</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3164" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3165" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3167" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3168" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3169" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3170">s</span><span class="MJXp-mo" id="MJXp-Span-3171" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-3172"><span class=""><span class="MJXp-mo" id="MJXp-Span-3173" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3174" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3175">a</span><span class="MJXp-mo" id="MJXp-Span-3176">∈</span><span class="MJXp-mrow" id="MJXp-Span-3177"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3178">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3179">π</span><span class="MJXp-mo" id="MJXp-Span-3180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3181">a</span><span class="MJXp-mo" id="MJXp-Span-3182" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3183">s</span><span class="MJXp-mo" id="MJXp-Span-3184" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3185">θ</span><span class="MJXp-mo" id="MJXp-Span-3186" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3187">R</span><span class="MJXp-mo" id="MJXp-Span-3188" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3189">s</span><span class="MJXp-mo" id="MJXp-Span-3190" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3191">a</span><span class="MJXp-mo" id="MJXp-Span-3192" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3554"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3555"><span class="texatom" id="MathJax-Span-3556"><span class="mrow" id="MathJax-Span-3557"><span class="mi" id="MathJax-Span-3558" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3559" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3560" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3561" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3562" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-3563" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-3564"><span class="mrow" id="MathJax-Span-3565"><span class="mi" id="MathJax-Span-3566" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="texatom" id="MathJax-Span-3567"><span class="mrow" id="MathJax-Span-3568"><span class="msubsup" id="MathJax-Span-3569"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3570" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3571" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3572" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3573" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-3574" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-3575" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-3576" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3577" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.287em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-3578"><span class="mrow" id="MathJax-Span-3579"><span class="mi" id="MathJax-Span-3580" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3581" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3582"><span class="mrow" id="MathJax-Span-3583"><span class="mi" id="MathJax-Span-3584" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3585" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3586" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="texatom" id="MathJax-Span-3587"><span class="mrow" id="MathJax-Span-3588"><span class="msubsup" id="MathJax-Span-3589"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3590" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3591" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3592" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3593" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3594" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-3595" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3596" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3597"><span class="mrow" id="MathJax-Span-3598"><span class="mi" id="MathJax-Span-3599" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3600" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3601"><span class="mrow" id="MathJax-Span-3602"><span class="mi" id="MathJax-Span-3603" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3604" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3605" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3606" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3607" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3608" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3609" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3610" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3611" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-3612" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-3613" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3614" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3615" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3616" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-3617" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-130">\mathcal{J}(\theta) = \mathbb{E}_{\pi_\theta} [r] = \sum_{s \in \mathcal{S}} d_{\pi_\theta}(s) \sum_{a \in \mathcal{A}} \pi(a \vert s; \theta) R(s, a)</script>

<p>Actually we have nice theoretical support for (replacing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3194">d</span><span class="MJXp-mo" id="MJXp-Span-3195" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-3196" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3197" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-131-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3618"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3619"><span class="mi" id="MathJax-Span-3620" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3621" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-3622" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-3623" style="font-family: MathJax_Main; padding-left: 0.154em;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-131">d(.)</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3198"><span class="MJXp-msubsup" id="MJXp-Span-3199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3200" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3201" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3202" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-3203" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-3204" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-132-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3624"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3625"><span class="msubsup" id="MathJax-Span-3626"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3627" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="mi" id="MathJax-Span-3628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3629" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-3630" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-3631" style="font-family: MathJax_Main; padding-left: 0.154em;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-132">d_\pi(.)</script>):</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3205"><span class="MJXp-mrow" id="MJXp-Span-3206"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3207">J</span></span><span class="MJXp-mo" id="MJXp-Span-3208" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3209">θ</span><span class="MJXp-mo" id="MJXp-Span-3210" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3211" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3212"><span class=""><span class="MJXp-mo" id="MJXp-Span-3213" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3214" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3215">s</span><span class="MJXp-mo" id="MJXp-Span-3216">∈</span><span class="MJXp-mrow" id="MJXp-Span-3217"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3218">S</span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3220" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3221" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3223" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3224" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3225" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3226">s</span><span class="MJXp-mo" id="MJXp-Span-3227" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-3228"><span class=""><span class="MJXp-mo" id="MJXp-Span-3229" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3230" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3231">a</span><span class="MJXp-mo" id="MJXp-Span-3232">∈</span><span class="MJXp-mrow" id="MJXp-Span-3233"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3234">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3235">π</span><span class="MJXp-mo" id="MJXp-Span-3236" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3237">a</span><span class="MJXp-mo" id="MJXp-Span-3238" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3239">s</span><span class="MJXp-mo" id="MJXp-Span-3240" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3241">θ</span><span class="MJXp-mo" id="MJXp-Span-3242" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3244" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3245" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3246" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3247">s</span><span class="MJXp-mo" id="MJXp-Span-3248" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3249">a</span><span class="MJXp-mo" id="MJXp-Span-3250" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3251" style="margin-left: 0.333em; margin-right: 0.333em;">∝</span><span class="MJXp-munderover" id="MJXp-Span-3252"><span class=""><span class="MJXp-mo" id="MJXp-Span-3253" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3254" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3255">s</span><span class="MJXp-mo" id="MJXp-Span-3256">∈</span><span class="MJXp-mrow" id="MJXp-Span-3257"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3258">S</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3259">d</span><span class="MJXp-mo" id="MJXp-Span-3260" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3261">s</span><span class="MJXp-mo" id="MJXp-Span-3262" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-3263"><span class=""><span class="MJXp-mo" id="MJXp-Span-3264" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3265" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3266">a</span><span class="MJXp-mo" id="MJXp-Span-3267">∈</span><span class="MJXp-mrow" id="MJXp-Span-3268"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3269">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3270">π</span><span class="MJXp-mo" id="MJXp-Span-3271" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3272">a</span><span class="MJXp-mo" id="MJXp-Span-3273" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3274">s</span><span class="MJXp-mo" id="MJXp-Span-3275" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3276">θ</span><span class="MJXp-mo" id="MJXp-Span-3277" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3279" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3280" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3281" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3282">s</span><span class="MJXp-mo" id="MJXp-Span-3283" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3284">a</span><span class="MJXp-mo" id="MJXp-Span-3285" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3632"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3633"><span class="texatom" id="MathJax-Span-3634"><span class="mrow" id="MathJax-Span-3635"><span class="mi" id="MathJax-Span-3636" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3637" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3638" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3639" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3640" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-3641" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3642" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.287em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-3643"><span class="mrow" id="MathJax-Span-3644"><span class="mi" id="MathJax-Span-3645" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3646" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3647"><span class="mrow" id="MathJax-Span-3648"><span class="mi" id="MathJax-Span-3649" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3650" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3651" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="texatom" id="MathJax-Span-3652"><span class="mrow" id="MathJax-Span-3653"><span class="msubsup" id="MathJax-Span-3654"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3655" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3656" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3657" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3658" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3659" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-3660" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3661" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3662"><span class="mrow" id="MathJax-Span-3663"><span class="mi" id="MathJax-Span-3664" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3665" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3666"><span class="mrow" id="MathJax-Span-3667"><span class="mi" id="MathJax-Span-3668" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3669" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3670" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3671" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3672" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3673" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3674" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3675" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3676" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3677"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3678" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-3679" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3680" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3681" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3682" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3683" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-3684" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3685" style="font-family: MathJax_Main; padding-left: 0.305em;">∝</span><span class="munderover" id="MathJax-Span-3686" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3687" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.287em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-3688"><span class="mrow" id="MathJax-Span-3689"><span class="mi" id="MathJax-Span-3690" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3691" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3692"><span class="mrow" id="MathJax-Span-3693"><span class="mi" id="MathJax-Span-3694" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3695" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3696" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3697" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3698" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-3699" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3700" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3701"><span class="mrow" id="MathJax-Span-3702"><span class="mi" id="MathJax-Span-3703" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3704" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3705"><span class="mrow" id="MathJax-Span-3706"><span class="mi" id="MathJax-Span-3707" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3708" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3709" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3710" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3711" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3712" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3713" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3714" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3715" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3716"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3717" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-3718" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3719" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3720" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3721" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3722" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-3723" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-133">\mathcal{J}(\theta) = \sum_{s \in \mathcal{S}} d_{\pi_\theta}(s) \sum_{a \in \mathcal{A}} \pi(a \vert s; \theta) Q_\pi(s, a) \propto \sum_{s \in \mathcal{S}} d(s) \sum_{a \in \mathcal{A}} \pi(a \vert s; \theta) Q_\pi(s, a)</script>

<p>Check Sec 13.1 in Sutton &amp; Barto (2017) for why this is the case.</p>

<p>Then,</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3286"><span class="MJXp-mtable" id="MJXp-Span-3287"><span><span class="MJXp-mtr" id="MJXp-Span-3288" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3289" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-3290"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3291">J</span></span><span class="MJXp-mo" id="MJXp-Span-3292" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3293">θ</span><span class="MJXp-mo" id="MJXp-Span-3294" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-3295" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3296"></span><span class="MJXp-mo" id="MJXp-Span-3297" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3298"><span class=""><span class="MJXp-mo" id="MJXp-Span-3299" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3300" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3301">s</span><span class="MJXp-mo" id="MJXp-Span-3302">∈</span><span class="MJXp-mrow" id="MJXp-Span-3303"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3304">S</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3305">d</span><span class="MJXp-mo" id="MJXp-Span-3306" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3307">s</span><span class="MJXp-mo" id="MJXp-Span-3308" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-3309"><span class=""><span class="MJXp-mo" id="MJXp-Span-3310" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3311" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3312">a</span><span class="MJXp-mo" id="MJXp-Span-3313">∈</span><span class="MJXp-mrow" id="MJXp-Span-3314"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3315">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3316">π</span><span class="MJXp-mo" id="MJXp-Span-3317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3318">a</span><span class="MJXp-mo" id="MJXp-Span-3319" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3320">s</span><span class="MJXp-mo" id="MJXp-Span-3321" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3322">θ</span><span class="MJXp-mo" id="MJXp-Span-3323" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3325" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3326" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3327" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3328">s</span><span class="MJXp-mo" id="MJXp-Span-3329" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3330">a</span><span class="MJXp-mo" id="MJXp-Span-3331" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3332" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3333" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi" id="MJXp-Span-3334">∇</span><span class="MJXp-mrow" id="MJXp-Span-3335"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3336">J</span></span><span class="MJXp-mo" id="MJXp-Span-3337" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3338">θ</span><span class="MJXp-mo" id="MJXp-Span-3339" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-3340" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3341"></span><span class="MJXp-mo" id="MJXp-Span-3342" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3343"><span class=""><span class="MJXp-mo" id="MJXp-Span-3344" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3345" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3346">s</span><span class="MJXp-mo" id="MJXp-Span-3347">∈</span><span class="MJXp-mrow" id="MJXp-Span-3348"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3349">S</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3350">d</span><span class="MJXp-mo" id="MJXp-Span-3351" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3352">s</span><span class="MJXp-mo" id="MJXp-Span-3353" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-3354"><span class=""><span class="MJXp-mo" id="MJXp-Span-3355" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3356" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3357">a</span><span class="MJXp-mo" id="MJXp-Span-3358">∈</span><span class="MJXp-mrow" id="MJXp-Span-3359"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3360">A</span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3361">∇</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3362">π</span><span class="MJXp-mo" id="MJXp-Span-3363" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3364">a</span><span class="MJXp-mo" id="MJXp-Span-3365" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3366">s</span><span class="MJXp-mo" id="MJXp-Span-3367" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3368">θ</span><span class="MJXp-mo" id="MJXp-Span-3369" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3371" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3372" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3373" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3374">s</span><span class="MJXp-mo" id="MJXp-Span-3375" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3376">a</span><span class="MJXp-mo" id="MJXp-Span-3377" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3378" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3379" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3380" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3381"></span><span class="MJXp-mo" id="MJXp-Span-3382" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3383"><span class=""><span class="MJXp-mo" id="MJXp-Span-3384" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3385" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3386">s</span><span class="MJXp-mo" id="MJXp-Span-3387">∈</span><span class="MJXp-mrow" id="MJXp-Span-3388"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3389">S</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3390">d</span><span class="MJXp-mo" id="MJXp-Span-3391" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3392">s</span><span class="MJXp-mo" id="MJXp-Span-3393" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-3394"><span class=""><span class="MJXp-mo" id="MJXp-Span-3395" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3396" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3397">a</span><span class="MJXp-mo" id="MJXp-Span-3398">∈</span><span class="MJXp-mrow" id="MJXp-Span-3399"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3400">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3401">π</span><span class="MJXp-mo" id="MJXp-Span-3402" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3403">a</span><span class="MJXp-mo" id="MJXp-Span-3404" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3405">s</span><span class="MJXp-mo" id="MJXp-Span-3406" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3407">θ</span><span class="MJXp-mo" id="MJXp-Span-3408" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-3409" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-3410">∇</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3411">π</span><span class="MJXp-mo" id="MJXp-Span-3412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3413">a</span><span class="MJXp-mo" id="MJXp-Span-3414" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3415">s</span><span class="MJXp-mo" id="MJXp-Span-3416" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3417">θ</span><span class="MJXp-mo" id="MJXp-Span-3418" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3419">π</span><span class="MJXp-mo" id="MJXp-Span-3420" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3421">a</span><span class="MJXp-mo" id="MJXp-Span-3422" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3423">s</span><span class="MJXp-mo" id="MJXp-Span-3424" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3425">θ</span><span class="MJXp-mo" id="MJXp-Span-3426" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3428" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3429" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3430" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3431">s</span><span class="MJXp-mo" id="MJXp-Span-3432" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3433">a</span><span class="MJXp-mo" id="MJXp-Span-3434" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3435" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3436" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3437" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3438"></span><span class="MJXp-mo" id="MJXp-Span-3439" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3440"><span class=""><span class="MJXp-mo" id="MJXp-Span-3441" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3442" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3443">s</span><span class="MJXp-mo" id="MJXp-Span-3444">∈</span><span class="MJXp-mrow" id="MJXp-Span-3445"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3446">S</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3447">d</span><span class="MJXp-mo" id="MJXp-Span-3448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3449">s</span><span class="MJXp-mo" id="MJXp-Span-3450" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-munderover" id="MJXp-Span-3451"><span class=""><span class="MJXp-mo" id="MJXp-Span-3452" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3453" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3454">a</span><span class="MJXp-mo" id="MJXp-Span-3455">∈</span><span class="MJXp-mrow" id="MJXp-Span-3456"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3457">A</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3458">π</span><span class="MJXp-mo" id="MJXp-Span-3459" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3460">a</span><span class="MJXp-mo" id="MJXp-Span-3461" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3462">s</span><span class="MJXp-mo" id="MJXp-Span-3463" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3464">θ</span><span class="MJXp-mo" id="MJXp-Span-3465" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-3466">∇</span><span class="MJXp-mi" id="MJXp-Span-3467">ln</span><span class="MJXp-mo" id="MJXp-Span-3468" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3469">π</span><span class="MJXp-mo" id="MJXp-Span-3470" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3471">a</span><span class="MJXp-mo" id="MJXp-Span-3472" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3473">s</span><span class="MJXp-mo" id="MJXp-Span-3474" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3475">θ</span><span class="MJXp-mo" id="MJXp-Span-3476" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3478" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3479" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3480" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3481">s</span><span class="MJXp-mo" id="MJXp-Span-3482" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3483">a</span><span class="MJXp-mo" id="MJXp-Span-3484" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3485" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3486" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-3487" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-3488"></span><span class="MJXp-mo" id="MJXp-Span-3489" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3490"><span class="MJXp-mrow" id="MJXp-Span-3491" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3492">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3493" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3495" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3496" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3497" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi" id="MJXp-Span-3498">∇</span><span class="MJXp-mi" id="MJXp-Span-3499">ln</span><span class="MJXp-mo" id="MJXp-Span-3500" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3501">π</span><span class="MJXp-mo" id="MJXp-Span-3502" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3503">a</span><span class="MJXp-mo" id="MJXp-Span-3504" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3505">s</span><span class="MJXp-mo" id="MJXp-Span-3506" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3507">θ</span><span class="MJXp-mo" id="MJXp-Span-3508" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3510" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3511" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3512" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3513">s</span><span class="MJXp-mo" id="MJXp-Span-3514" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3515">a</span><span class="MJXp-mo" id="MJXp-Span-3516" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3517" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3724"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3725"><span class="mtable" id="MathJax-Span-3726" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 21.928em; height: 0px;"><span style="position: absolute; clip: rect(6.152em, 1002.83em, 17.644em, -999.997em); top: -12.195em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.926em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1002.02em, 4.388em, -999.997em); top: -9.12em; right: 0em;"><span class="mtd" id="MathJax-Span-3727"><span class="mrow" id="MathJax-Span-3728"><span class="texatom" id="MathJax-Span-3729"><span class="mrow" id="MathJax-Span-3730"><span class="mi" id="MathJax-Span-3731" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3732" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3733" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3734" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1002.83em, 4.388em, -999.997em); top: -6.6em; right: 0em;"><span class="mtd" id="MathJax-Span-3777"><span class="mrow" id="MathJax-Span-3778"><span class="mi" id="MathJax-Span-3779" style="font-family: MathJax_Main;">∇</span><span class="texatom" id="MathJax-Span-3780"><span class="mrow" id="MathJax-Span-3781"><span class="mi" id="MathJax-Span-3782" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3783" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3784" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3785" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000em, 4.136em, -999.997em); top: -3.576em; right: 0em;"><span class="mtd" id="MathJax-Span-3829"><span class="mrow" id="MathJax-Span-3830"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000em, 4.136em, -999.997em); top: -1.056em; right: 0em;"><span class="mtd" id="MathJax-Span-3893"><span class="mrow" id="MathJax-Span-3894"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.833em, 1000em, 4.136em, -999.997em); top: 1.313em; right: 0em;"><span class="mtd" id="MathJax-Span-3948"><span class="mrow" id="MathJax-Span-3949"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 12.2em;"></span></span><span style="position: absolute; clip: rect(6.454em, 1018.9em, 18.4em, -999.997em); top: -12.649em; left: 2.926em;"><span style="display: inline-block; position: relative; width: 19.005em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1013.41em, 5.396em, -999.997em); top: -9.12em; left: 0em;"><span class="mtd" id="MathJax-Span-3735"><span class="mrow" id="MathJax-Span-3736"><span class="mi" id="MathJax-Span-3737"></span><span class="mo" id="MathJax-Span-3738" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-3739" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3740" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.287em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-3741"><span class="mrow" id="MathJax-Span-3742"><span class="mi" id="MathJax-Span-3743" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3744" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3745"><span class="mrow" id="MathJax-Span-3746"><span class="mi" id="MathJax-Span-3747" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3748" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3749" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3750" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3751" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-3752" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3753" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3754"><span class="mrow" id="MathJax-Span-3755"><span class="mi" id="MathJax-Span-3756" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3757" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3758"><span class="mrow" id="MathJax-Span-3759"><span class="mi" id="MathJax-Span-3760" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3761" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3762" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3763" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3764" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3765" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3766" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3767" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3768" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3769"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3770" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-3771" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3772" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3773" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3774" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3775" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-3776" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1014.27em, 5.396em, -999.997em); top: -6.6em; left: 0em;"><span class="mtd" id="MathJax-Span-3786"><span class="mrow" id="MathJax-Span-3787"><span class="mi" id="MathJax-Span-3788"></span><span class="mo" id="MathJax-Span-3789" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-3790" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3791" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.287em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-3792"><span class="mrow" id="MathJax-Span-3793"><span class="mi" id="MathJax-Span-3794" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3795" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3796"><span class="mrow" id="MathJax-Span-3797"><span class="mi" id="MathJax-Span-3798" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3799" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3800" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3801" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3802" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-3803" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3804" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3805"><span class="mrow" id="MathJax-Span-3806"><span class="mi" id="MathJax-Span-3807" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3808" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3809"><span class="mrow" id="MathJax-Span-3810"><span class="mi" id="MathJax-Span-3811" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3812" style="font-family: MathJax_Main; padding-left: 0.154em;">∇</span><span class="mi" id="MathJax-Span-3813" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3814" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3815" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3816" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3817" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3818" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3819" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3820" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3821"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3822" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-3823" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3824" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3825" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3826" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3827" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-3828" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.371em, 1018.15em, 5.396em, -999.997em); top: -3.576em; left: 0em;"><span class="mtd" id="MathJax-Span-3831"><span class="mrow" id="MathJax-Span-3832"><span class="mi" id="MathJax-Span-3833"></span><span class="mo" id="MathJax-Span-3834" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-3835" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3836" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.287em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-3837"><span class="mrow" id="MathJax-Span-3838"><span class="mi" id="MathJax-Span-3839" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3840" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3841"><span class="mrow" id="MathJax-Span-3842"><span class="mi" id="MathJax-Span-3843" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3844" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3845" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3846" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3847" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-3848" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3849" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3850"><span class="mrow" id="MathJax-Span-3851"><span class="mi" id="MathJax-Span-3852" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3853" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3854"><span class="mrow" id="MathJax-Span-3855"><span class="mi" id="MathJax-Span-3856" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3857" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3858" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3859" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3860" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3861" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3862" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3863" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3864" style="font-family: MathJax_Main;">)</span><span class="mfrac" id="MathJax-Span-3865"><span style="display: inline-block; position: relative; width: 4.488em; height: 0px; margin-right: 0.103em; margin-left: 0.103em;"><span style="position: absolute; clip: rect(3.077em, 1004.29em, 4.388em, -999.997em); top: -4.685em; left: 50%; margin-left: -2.165em;"><span class="mrow" id="MathJax-Span-3866"><span class="mi" id="MathJax-Span-3867" style="font-family: MathJax_Main;">∇</span><span class="mi" id="MathJax-Span-3868" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3869" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3870" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3871" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3872" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3873" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3874" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3875" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1003.43em, 4.388em, -999.997em); top: -3.274em; left: 50%; margin-left: -1.762em;"><span class="mrow" id="MathJax-Span-3876"><span class="mi" id="MathJax-Span-3877" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3878" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3879" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3880" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3881" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3882" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3883" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3884" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(0.859em, 1004.49em, 1.212em, -999.997em); top: -1.258em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.488em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.061em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3885"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3886" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-3887" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3888" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3889" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3890" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3891" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-3892" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.876em, 1018.9em, 5.396em, -999.997em); top: -1.056em; left: 0em;"><span class="mtd" id="MathJax-Span-3895"><span class="mrow" id="MathJax-Span-3896"><span class="mi" id="MathJax-Span-3897"></span><span class="mo" id="MathJax-Span-3898" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="munderover" id="MathJax-Span-3899" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3900" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.26em, 4.287em, -999.997em); top: -2.87em; left: 0.103em;"><span class="texatom" id="MathJax-Span-3901"><span class="mrow" id="MathJax-Span-3902"><span class="mi" id="MathJax-Span-3903" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3904" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3905"><span class="mrow" id="MathJax-Span-3906"><span class="mi" id="MathJax-Span-3907" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3908" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3909" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3910" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3911" style="font-family: MathJax_Main;">)</span><span class="munderover" id="MathJax-Span-3912" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(2.876em, 1001.41em, 4.589em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-3913" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.329em, 1001.41em, 4.287em, -999.997em); top: -2.87em; left: 0.003em;"><span class="texatom" id="MathJax-Span-3914"><span class="mrow" id="MathJax-Span-3915"><span class="mi" id="MathJax-Span-3916" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3917" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="texatom" id="MathJax-Span-3918"><span class="mrow" id="MathJax-Span-3919"><span class="mi" id="MathJax-Span-3920" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">A<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-3921" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3922" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3923" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3924" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3925" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3926" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3927" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3928" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-3929" style="font-family: MathJax_Main;">∇</span><span class="mi" id="MathJax-Span-3930" style="font-family: MathJax_Main; padding-left: 0.154em;">ln</span><span class="mo" id="MathJax-Span-3931"></span><span class="mi" id="MathJax-Span-3932" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3933" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3934" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3935" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3936" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3937" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3938" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3939" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3940"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3941" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-3942" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3943" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3944" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3945" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3946" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-3947" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1012.25em, 4.388em, -999.997em); top: 1.313em; left: 0em;"><span class="mtd" id="MathJax-Span-3950"><span class="mrow" id="MathJax-Span-3951"><span class="mi" id="MathJax-Span-3952"></span><span class="mo" id="MathJax-Span-3953" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-3954" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-3955"><span class="mrow" id="MathJax-Span-3956"><span class="mi" id="MathJax-Span-3957" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="texatom" id="MathJax-Span-3958"><span class="mrow" id="MathJax-Span-3959"><span class="msubsup" id="MathJax-Span-3960"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3961" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-3962" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3963" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3964" style="font-family: MathJax_Main;">∇</span><span class="mi" id="MathJax-Span-3965" style="font-family: MathJax_Main; padding-left: 0.154em;">ln</span><span class="mo" id="MathJax-Span-3966"></span><span class="mi" id="MathJax-Span-3967" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3968" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3969" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3970" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-3971" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3972" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3973" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-3974" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-3975"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-3976" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-3977" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-3978" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3979" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-3980" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3981" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-3982" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3983" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 12.654em;"></span></span></span></span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-134">% <![CDATA[
\begin{aligned}
\mathcal{J}(\theta) &= \sum_{s \in \mathcal{S}} d(s) \sum_{a \in \mathcal{A}} \pi(a \vert s; \theta) Q_\pi(s, a) \\
\nabla \mathcal{J}(\theta) &= \sum_{s \in \mathcal{S}} d(s) \sum_{a \in \mathcal{A}} \nabla \pi(a \vert s; \theta) Q_\pi(s, a) \\
&= \sum_{s \in \mathcal{S}} d(s) \sum_{a \in \mathcal{A}} \pi(a \vert s; \theta) \frac{\nabla \pi(a \vert s; \theta)}{\pi(a \vert s; \theta)} Q_\pi(s, a) \\
& = \sum_{s \in \mathcal{S}} d(s) \sum_{a \in \mathcal{A}} \pi(a \vert s; \theta) \nabla \ln \pi(a \vert s; \theta) Q_\pi(s, a) \\
& = \mathbb{E}_{\pi_\theta} [\nabla \ln \pi(a \vert s; \theta) Q_\pi(s, a)]
\end{aligned} %]]></script>

<p>This result is named “Policy Gradient Theorem” which lays the theoretical foundation for various policy gradient algorithms:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3518"><span class="MJXp-mi" id="MJXp-Span-3519">∇</span><span class="MJXp-mrow" id="MJXp-Span-3520"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3521">J</span></span><span class="MJXp-mo" id="MJXp-Span-3522" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3523">θ</span><span class="MJXp-mo" id="MJXp-Span-3524" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3525" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3526"><span class="MJXp-mrow" id="MJXp-Span-3527" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3528">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3529" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3531" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3532" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3533" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi" id="MJXp-Span-3534">∇</span><span class="MJXp-mi" id="MJXp-Span-3535">ln</span><span class="MJXp-mo" id="MJXp-Span-3536" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3537">π</span><span class="MJXp-mo" id="MJXp-Span-3538" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3539">a</span><span class="MJXp-mo" id="MJXp-Span-3540" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3541">s</span><span class="MJXp-mo" id="MJXp-Span-3542" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3543">θ</span><span class="MJXp-mo" id="MJXp-Span-3544" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3546" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3547" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3548" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3549">s</span><span class="MJXp-mo" id="MJXp-Span-3550" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3551">a</span><span class="MJXp-mo" id="MJXp-Span-3552" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3553" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_Display MathJax_Processed"><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-3984"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-3985"><span class="mi" id="MathJax-Span-3986" style="font-family: MathJax_Main;">∇</span><span class="texatom" id="MathJax-Span-3987"><span class="mrow" id="MathJax-Span-3988"><span class="mi" id="MathJax-Span-3989" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span class="mo" id="MathJax-Span-3990" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3991" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-3992" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3993" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-3994" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-3995"><span class="mrow" id="MathJax-Span-3996"><span class="mi" id="MathJax-Span-3997" style="font-family: MathJax_AMS;">E</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="texatom" id="MathJax-Span-3998"><span class="mrow" id="MathJax-Span-3999"><span class="msubsup" id="MathJax-Span-4000"><span style="display: inline-block; position: relative; width: 0.708em; height: 0px;"><span style="position: absolute; clip: rect(3.531em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4001" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.879em; left: 0.406em;"><span class="mi" id="MathJax-Span-4002" style="font-size: 50%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4003" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-4004" style="font-family: MathJax_Main;">∇</span><span class="mi" id="MathJax-Span-4005" style="font-family: MathJax_Main; padding-left: 0.154em;">ln</span><span class="mo" id="MathJax-Span-4006"></span><span class="mi" id="MathJax-Span-4007" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4008" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4009" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-4010" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-4011" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4012" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4013" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-4014" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-4015"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4016" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-4017" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4018" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4019" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4020" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4021" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-4022" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4023" style="font-family: MathJax_Main;">]</span></span></span></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-135">\nabla \mathcal{J}(\theta) = \mathbb{E}_{\pi_\theta} [\nabla \ln \pi(a \vert s, \theta) Q_\pi(s, a)]</script>

<h4 id="reinforce">REINFORCE</h4>

<p>REINFORCE, also known as Monte-Carlo policy gradient, relies on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3554"><span class="MJXp-msubsup" id="MJXp-Span-3555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3556" style="margin-right: 0.05em;">Q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3557" style="vertical-align: -0.4em;">π</span></span><span class="MJXp-mo" id="MJXp-Span-3558" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3559">s</span><span class="MJXp-mo" id="MJXp-Span-3560" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3561">a</span><span class="MJXp-mo" id="MJXp-Span-3562" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-136-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4024"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4025"><span class="msubsup" id="MathJax-Span-4026"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4027" style="font-family: MathJax_Math-italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-4028" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4029" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4030" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4031" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4032" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-4033" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-136">Q_\pi(s, a)</script>, an estimated return by <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#monte-carlo-methods">MC</a> methods using episode samples, to update the policy parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3564">θ</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-137-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4034"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4035"><span class="mi" id="MathJax-Span-4036" style="font-family: MathJax_Math-italic;">θ</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-137">\theta</script>.</p>

<p>A commonly used variation of REINFORCE is to subtract a baseline value from the return <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3565"><span class="MJXp-msubsup" id="MJXp-Span-3566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3567" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3568" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-138-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4037"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4038"><span class="msubsup" id="MathJax-Span-4039"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4040" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-4041" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-138">G_t</script> to reduce the variance of gradient estimation while keeping the bias unchanged. For example, a common baseline is state-value, and if applied, we would use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3570">A</span><span class="MJXp-mo" id="MJXp-Span-3571" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3572">s</span><span class="MJXp-mo" id="MJXp-Span-3573" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3574">a</span><span class="MJXp-mo" id="MJXp-Span-3575" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3576" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3577">Q</span><span class="MJXp-mo" id="MJXp-Span-3578" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3579">s</span><span class="MJXp-mo" id="MJXp-Span-3580" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3581">a</span><span class="MJXp-mo" id="MJXp-Span-3582" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3583" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3584">V</span><span class="MJXp-mo" id="MJXp-Span-3585" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3586">s</span><span class="MJXp-mo" id="MJXp-Span-3587" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-139-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4042"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4043"><span class="mi" id="MathJax-Span-4044" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-4045" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4046" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4047" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4048" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-4049" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4050" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mi" id="MathJax-Span-4051" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">Q</span><span class="mo" id="MathJax-Span-4052" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4053" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4054" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4055" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-4056" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4057" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-4058" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-4059" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4060" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4061" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-139">A(s, a) = Q(s, a) - V(s)</script> in the gradient ascent update.</p>

<ol>
  <li>Initialize θ at random</li>
  <li>Generate one episode <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3588"><span class="MJXp-msubsup" id="MJXp-Span-3589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3590" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3591" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3592" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3594" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3595" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3596" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3598" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3599" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3600" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3602" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3603" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3604" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3606" style="margin-right: 0.05em;">A</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3607" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3608" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3609" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3610" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3612" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3613" style="vertical-align: -0.4em;">T</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-140-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4062"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4063"><span class="msubsup" id="MathJax-Span-4064"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4065" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mn" id="MathJax-Span-4066" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4067" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4068" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4069" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mn" id="MathJax-Span-4070" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4071" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4072" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4073" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mn" id="MathJax-Span-4074" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4075" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4076" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4077" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mn" id="MathJax-Span-4078" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4079" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4080" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4081" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mn" id="MathJax-Span-4082" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4083" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-4084" style="font-family: MathJax_Main; padding-left: 0.154em;">…</span><span class="mo" id="MathJax-Span-4085" style="font-family: MathJax_Main; padding-left: 0.154em;">,</span><span class="msubsup" id="MathJax-Span-4086" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4087" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-4088" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-140">S_1, A_1, R_2, S_2, A_2, \dots, S_T</script></li>
  <li>For t=1, 2, … , T:
    <ol>
      <li>Estimate the the return G_t since the time step t.</li>
      <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3615">θ</span><span class="MJXp-mo" id="MJXp-Span-3616" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3617">θ</span><span class="MJXp-mo" id="MJXp-Span-3618" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3619">α</span><span class="MJXp-msubsup" id="MJXp-Span-3620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3621" style="margin-right: 0.05em;">γ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3622" style="vertical-align: 0.5em;">t</span></span><span class="MJXp-msubsup" id="MJXp-Span-3623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3624" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3625" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mi" id="MJXp-Span-3626">∇</span><span class="MJXp-mi" id="MJXp-Span-3627">ln</span><span class="MJXp-mo" id="MJXp-Span-3628" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3629">π</span><span class="MJXp-mo" id="MJXp-Span-3630" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3632" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3633" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3634" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-3635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3636" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3637" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3638" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3639">θ</span><span class="MJXp-mo" id="MJXp-Span-3640" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-141-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4089"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4090"><span class="mi" id="MathJax-Span-4091" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-4092" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mi" id="MathJax-Span-4093" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">θ</span><span class="mo" id="MathJax-Span-4094" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-4095" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">α</span><span class="msubsup" id="MathJax-Span-4096"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.56em, 4.337em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4097" style="font-family: MathJax_Math-italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.607em;"><span class="mi" id="MathJax-Span-4098" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4099"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4100" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-4101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-4102" style="font-family: MathJax_Main;">∇</span><span class="mi" id="MathJax-Span-4103" style="font-family: MathJax_Main; padding-left: 0.154em;">ln</span><span class="mo" id="MathJax-Span-4104"></span><span class="mi" id="MathJax-Span-4105" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4106" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4107"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4108" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.759em;"><span class="mi" id="MathJax-Span-4109" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4110" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-4111"><span style="display: inline-block; position: relative; width: 0.96em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.66em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4112" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.607em;"><span class="mi" id="MathJax-Span-4113" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4114" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4115" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-4116" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-141">\theta \leftarrow \theta + \alpha \gamma^t G_t \nabla \ln \pi(A_t \vert S_t, \theta)</script>.</li>
    </ol>
  </li>
</ol>

<h4 id="actor-critic">Actor-Critic</h4>

<p>If the value function is learned in addition to the policy, we would get Actor-Critic algorithm.</p>
<ul>
  <li><strong>Critic</strong>: updates value function parameters w and depending on the algorithm it could be action-value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3642">Q</span><span class="MJXp-mo" id="MJXp-Span-3643" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3644">a</span><span class="MJXp-mo" id="MJXp-Span-3645" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3646">s</span><span class="MJXp-mo" id="MJXp-Span-3647" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3648">w</span><span class="MJXp-mo" id="MJXp-Span-3649" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-142-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4117"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4118"><span class="mi" id="MathJax-Span-4119" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-4120" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4121" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-4122" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-4123" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4124" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4125" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">w</span><span class="mo" id="MathJax-Span-4126" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-142">Q(a \vert s; w)</script> or state-value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3651">V</span><span class="MJXp-mo" id="MJXp-Span-3652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3653">s</span><span class="MJXp-mo" id="MJXp-Span-3654" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3655">w</span><span class="MJXp-mo" id="MJXp-Span-3656" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-143-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4127"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4128"><span class="mi" id="MathJax-Span-4129" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-4130" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4131" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4132" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4133" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">w</span><span class="mo" id="MathJax-Span-4134" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-143">V(s; w)</script>.</li>
  <li><strong>Actor</strong>: updates policy parameters θ, in the direction suggested by the critic, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3658">π</span><span class="MJXp-mo" id="MJXp-Span-3659" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3660">a</span><span class="MJXp-mo" id="MJXp-Span-3661" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3662">s</span><span class="MJXp-mo" id="MJXp-Span-3663" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3664">θ</span><span class="MJXp-mo" id="MJXp-Span-3665" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-144-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4135"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4136"><span class="mi" id="MathJax-Span-4137" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4138" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4139" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-4140" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-4141" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4142" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4143" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-4144" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-144">\pi(a \vert s; \theta)</script>.</li>
</ul>

<p>Let’s see how it works in an action-value actor-critic algorithm.</p>

<ol>
  <li>Initialize s, θ, w at random; sample <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3667">a</span><span class="MJXp-mo" id="MJXp-Span-3668" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3669">π</span><span class="MJXp-mo" id="MJXp-Span-3670" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3671">a</span><span class="MJXp-mo" id="MJXp-Span-3672" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3673">s</span><span class="MJXp-mo" id="MJXp-Span-3674" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3675">θ</span><span class="MJXp-mo" id="MJXp-Span-3676" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-145-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4145"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4146"><span class="mi" id="MathJax-Span-4147" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-4148" style="font-family: MathJax_Main; padding-left: 0.305em;">∼</span><span class="mi" id="MathJax-Span-4149" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4150" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4151" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-4152" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-4153" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4154" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4155" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-4156" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-145">a \sim \pi(a \vert s; \theta)</script>.</li>
  <li>For t = 1… T:
    <ol>
      <li>Sample reward <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3677"><span class="MJXp-msubsup" id="MJXp-Span-3678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3679" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3680" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3681" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3682">R</span><span class="MJXp-mo" id="MJXp-Span-3683" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3684">s</span><span class="MJXp-mo" id="MJXp-Span-3685" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3686">a</span><span class="MJXp-mo" id="MJXp-Span-3687" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-146-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4157"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4158"><span class="msubsup" id="MathJax-Span-4159"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4160" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-4161" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4162" style="font-family: MathJax_Main; padding-left: 0.305em;">∼</span><span class="mi" id="MathJax-Span-4163" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">R</span><span class="mo" id="MathJax-Span-4164" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4165" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4166" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4167" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-4168" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-146">r_t  \sim R(s, a)</script> and next state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3688"><span class="MJXp-msup" id="MJXp-Span-3689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3690" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3691" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3692" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3693">P</span><span class="MJXp-mo" id="MJXp-Span-3694" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-3695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3696" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3697" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3698" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3699">s</span><span class="MJXp-mo" id="MJXp-Span-3700" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3701">a</span><span class="MJXp-mo" id="MJXp-Span-3702" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-147-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4169"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4170"><span class="msup" id="MathJax-Span-4171"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4172" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.456em;"><span class="mo" id="MathJax-Span-4173" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4174" style="font-family: MathJax_Main; padding-left: 0.305em;">∼</span><span class="mi" id="MathJax-Span-4175" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.103em;"></span></span><span class="mo" id="MathJax-Span-4176" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-4177"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4178" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.456em;"><span class="mo" id="MathJax-Span-4179" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4180" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-4181" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4182" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4183" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-4184" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-147">s' \sim P(s' \vert s, a)</script>.</li>
      <li>Then sample the next action <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3703"><span class="MJXp-msup" id="MJXp-Span-3704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3705" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3706" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3707" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3708">π</span><span class="MJXp-mo" id="MJXp-Span-3709" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-3710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3711" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3712" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3713" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-3714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3715" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3716" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3717" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3718">θ</span><span class="MJXp-mo" id="MJXp-Span-3719" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-148-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4185"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4186"><span class="msup" id="MathJax-Span-4187"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4188" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.507em;"><span class="mo" id="MathJax-Span-4189" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4190" style="font-family: MathJax_Main; padding-left: 0.305em;">∼</span><span class="mi" id="MathJax-Span-4191" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4192" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-4193"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4194" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.456em;"><span class="mo" id="MathJax-Span-4195" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4196" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-4197" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4198" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.507em;"><span class="mo" id="MathJax-Span-4199" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4200" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4201" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-4202" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-148">a' \sim \pi(s', a'; \theta)</script>.</li>
      <li>Update policy parameters: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3721">θ</span><span class="MJXp-mo" id="MJXp-Span-3722" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3723">θ</span><span class="MJXp-mo" id="MJXp-Span-3724" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3726" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3727" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3728">Q</span><span class="MJXp-mo" id="MJXp-Span-3729" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3730">s</span><span class="MJXp-mo" id="MJXp-Span-3731" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3732">a</span><span class="MJXp-mo" id="MJXp-Span-3733" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3734">w</span><span class="MJXp-mo" id="MJXp-Span-3735" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3736"><span class="MJXp-mi" id="MJXp-Span-3737" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3738" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi" id="MJXp-Span-3739">ln</span><span class="MJXp-mo" id="MJXp-Span-3740" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3741">π</span><span class="MJXp-mo" id="MJXp-Span-3742" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3743">a</span><span class="MJXp-mo" id="MJXp-Span-3744" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3745">s</span><span class="MJXp-mo" id="MJXp-Span-3746" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3747">θ</span><span class="MJXp-mo" id="MJXp-Span-3748" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-149-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4203"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4204"><span class="mi" id="MathJax-Span-4205" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-4206" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mi" id="MathJax-Span-4207" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">θ</span><span class="mo" id="MathJax-Span-4208" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="msubsup" id="MathJax-Span-4209" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4210" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-4211" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-4212" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-4213" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4214" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4215" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4216" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-4217" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4218" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">w</span><span class="mo" id="MathJax-Span-4219" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-4220"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.186em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4221" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.859em;"><span class="mi" id="MathJax-Span-4222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-4223" style="font-family: MathJax_Main; padding-left: 0.154em;">ln</span><span class="mo" id="MathJax-Span-4224"></span><span class="mi" id="MathJax-Span-4225" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4226" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4227" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-4228" style="font-family: MathJax_Main;">|</span><span class="mi" id="MathJax-Span-4229" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4230" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4231" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">θ</span><span class="mo" id="MathJax-Span-4232" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-149">\theta \leftarrow \theta + \alpha_\theta Q(s, a; w) \nabla_\theta \ln \pi(a \vert s; \theta)</script>.</li>
      <li>Compute the correction for action-value at time t: <br>
 <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3749"><span class="MJXp-msubsup" id="MJXp-Span-3750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3751" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3752" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3753">t</span><span class="MJXp-mo" id="MJXp-Span-3754">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3755">t</span><span class="MJXp-mo" id="MJXp-Span-3756">+</span><span class="MJXp-mn" id="MJXp-Span-3757">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3758" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3760" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3761" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3762" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3763">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3764">Q</span><span class="MJXp-mo" id="MJXp-Span-3765" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-3766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3767" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3768" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3769" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-3770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3771" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3772" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3773" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3774">w</span><span class="MJXp-mo" id="MJXp-Span-3775" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3776" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3777">Q</span><span class="MJXp-mo" id="MJXp-Span-3778" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3779">s</span><span class="MJXp-mo" id="MJXp-Span-3780" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3781">a</span><span class="MJXp-mo" id="MJXp-Span-3782" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3783">w</span><span class="MJXp-mo" id="MJXp-Span-3784" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-150-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4233"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4234"><span class="msubsup" id="MathJax-Span-4235"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4236" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-4237"><span class="mrow" id="MathJax-Span-4238"><span class="mi" id="MathJax-Span-4239" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4240" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-4241" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4242" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-4243" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4244" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="msubsup" id="MathJax-Span-4245" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4246" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-4247" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4248" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="mi" id="MathJax-Span-4249" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4250" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-4251" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-4252"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4253" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.456em;"><span class="mo" id="MathJax-Span-4254" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4255" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-4256" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4257" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.507em;"><span class="mo" id="MathJax-Span-4258" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4259" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4260" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">w</span><span class="mo" id="MathJax-Span-4261" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4262" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-4263" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">Q</span><span class="mo" id="MathJax-Span-4264" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4265" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4266" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4267" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-4268" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4269" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">w</span><span class="mo" id="MathJax-Span-4270" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-150">G_{t:t+1} = r_t + \gamma Q(s', a'; w) - Q(s, a; w)</script> <br>
 and use it to update action function parameters: <br>
 <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3786">w</span><span class="MJXp-mo" id="MJXp-Span-3787" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3788">w</span><span class="MJXp-mo" id="MJXp-Span-3789" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3791" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3792" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-msubsup" id="MJXp-Span-3793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3794" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3795" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3796">t</span><span class="MJXp-mo" id="MJXp-Span-3797">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3798">t</span><span class="MJXp-mo" id="MJXp-Span-3799">+</span><span class="MJXp-mn" id="MJXp-Span-3800">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3801"><span class="MJXp-mi" id="MJXp-Span-3802" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3803" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3804">Q</span><span class="MJXp-mo" id="MJXp-Span-3805" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3806">s</span><span class="MJXp-mo" id="MJXp-Span-3807" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3808">a</span><span class="MJXp-mo" id="MJXp-Span-3809" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3810">w</span><span class="MJXp-mo" id="MJXp-Span-3811" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-151-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4271"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4272"><span class="mi" id="MathJax-Span-4273" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4274" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="mi" id="MathJax-Span-4275" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">w</span><span class="mo" id="MathJax-Span-4276" style="font-family: MathJax_Main; padding-left: 0.204em;">+</span><span class="msubsup" id="MathJax-Span-4277" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4278" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-4279" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4280"><span style="display: inline-block; position: relative; width: 2.472em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4281" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="texatom" id="MathJax-Span-4282"><span class="mrow" id="MathJax-Span-4283"><span class="mi" id="MathJax-Span-4284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4285" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-4286" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4287" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-4288" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4289"><span style="display: inline-block; position: relative; width: 1.414em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.81em, 4.186em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4290" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.859em;"><span class="mi" id="MathJax-Span-4291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mi" id="MathJax-Span-4292" style="font-family: MathJax_Math-italic;">Q</span><span class="mo" id="MathJax-Span-4293" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4294" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4295" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4296" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">a</span><span class="mo" id="MathJax-Span-4297" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4298" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">w</span><span class="mo" id="MathJax-Span-4299" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-151">w \leftarrow w + \alpha_w G_{t:t+1} \nabla_w Q(s, a; w)</script>.</li>
      <li>Update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3813">a</span><span class="MJXp-mo" id="MJXp-Span-3814" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msup" id="MJXp-Span-3815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3816" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3817" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-152-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4300"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4301"><span class="mi" id="MathJax-Span-4302" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-4303" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="msup" id="MathJax-Span-4304" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4305" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.507em;"><span class="mo" id="MathJax-Span-4306" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-152">a \leftarrow a'</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3819">s</span><span class="MJXp-mo" id="MJXp-Span-3820" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msup" id="MJXp-Span-3821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3822" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3823" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-153-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4307"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4308"><span class="mi" id="MathJax-Span-4309" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4310" style="font-family: MathJax_Main; padding-left: 0.305em;">←</span><span class="msup" id="MathJax-Span-4311" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4312" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.456em;"><span class="mo" id="MathJax-Span-4313" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-153">s \leftarrow s'</script>.</li>
    </ol>
  </li>
</ol>

<p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3824"><span class="MJXp-msubsup" id="MJXp-Span-3825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3826" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3827" style="vertical-align: -0.4em;">θ</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-154-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4314"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4315"><span class="msubsup" id="MathJax-Span-4316"><span style="display: inline-block; position: relative; width: 1.061em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4317" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-4318" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-154">\alpha_\theta</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3828"><span class="MJXp-msubsup" id="MJXp-Span-3829"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3830" style="margin-right: 0.05em;">α</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3831" style="vertical-align: -0.4em;">w</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-155-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4319"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4320"><span class="msubsup" id="MathJax-Span-4321"><span style="display: inline-block; position: relative; width: 1.212em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.61em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4322" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-4323" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-155">\alpha_w</script> are two learning rates for policy and value function parameter updates, respectively.</p>

<h4 id="a3c">A3C</h4>

<p><strong>Asynchronous Advantage Actor-Critic</strong> (Mnih et al., 2016), short for A3C, is a classic policy gradient method with the special focus on parallel training.</p>

<p>In A3C, the critics learn the state-value function, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3833">V</span><span class="MJXp-mo" id="MJXp-Span-3834" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3835">s</span><span class="MJXp-mo" id="MJXp-Span-3836" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3837">w</span><span class="MJXp-mo" id="MJXp-Span-3838" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-156-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4324"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4325"><span class="mi" id="MathJax-Span-4326" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-4327" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4328" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4329" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4330" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">w</span><span class="mo" id="MathJax-Span-4331" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-156">V(s; w)</script>, while multiple actors are trained in parallel and get synced with global parameters from time to time. Hence, A3C is good for parallel training by default, i.e. on one machine with multi-core CPU.</p>

<p>The loss function for state-value is to minimize the mean squared error, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3839"><span class="MJXp-msubsup" id="MJXp-Span-3840"><span class="MJXp-mrow" id="MJXp-Span-3841" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3842">J</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3843" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-3844" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3845">w</span><span class="MJXp-mo" id="MJXp-Span-3846" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3847" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3848" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3850" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3851" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3852" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3853">V</span><span class="MJXp-mo" id="MJXp-Span-3854" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3855">s</span><span class="MJXp-mo" id="MJXp-Span-3856" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3857">w</span><span class="MJXp-mo" id="MJXp-Span-3858" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-3859"><span class="MJXp-mo" id="MJXp-Span-3860" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3861" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-157-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4332"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4333"><span class="msubsup" id="MathJax-Span-4334"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.86em, 4.236em, -999.997em); top: -3.979em; left: 0em;"><span class="texatom" id="MathJax-Span-4335"><span class="mrow" id="MathJax-Span-4336"><span class="mi" id="MathJax-Span-4337" style="font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.154em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.658em;"><span class="mi" id="MathJax-Span-4338" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4339" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4340" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4341" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4342" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mo" id="MathJax-Span-4343" style="font-family: MathJax_Main; padding-left: 0.305em;">(</span><span class="msubsup" id="MathJax-Span-4344"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.76em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4345" style="font-family: MathJax_Math-italic;">G</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.809em;"><span class="mi" id="MathJax-Span-4346" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4347" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="mi" id="MathJax-Span-4348" style="font-family: MathJax_Math-italic; padding-left: 0.204em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-4349" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4350" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4351" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4352" style="font-family: MathJax_Math-italic; padding-left: 0.154em;">w</span><span class="mo" id="MathJax-Span-4353" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-4354"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.077em, 1000.3em, 4.388em, -999.997em); top: -3.979em; left: 0em;"><span class="mo" id="MathJax-Span-4355" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.406em;"><span class="mn" id="MathJax-Span-4356" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-157">\mathcal{J}_v (w) = (G_t - V(s; w))^2</script> and we use gradient descent to find the optimal w. This state-value function is used as the baseline in the policy gradient update.</p>

<p>Here is the algorithm outline:</p>
<ol>
  <li>We have global parameters, θ and w; similar thread-specific parameters, θ’ and w’.</li>
  <li>Initialize the time step t = 1</li>
  <li>While T &lt;= T_MAX:
    <ol>
      <li>Reset gradient: dθ = 0 and dw = 0.</li>
      <li>Synchronize thread-specific parameters with global ones: θ’ = θ and w’ = w.</li>
      <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3862"><span class="MJXp-msubsup" id="MJXp-Span-3863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3864" style="margin-right: 0.05em;">t</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-3865" style="vertical-align: -0.4em;">start</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-158-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4357"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4358"><span class="msubsup" id="MathJax-Span-4359"><span style="display: inline-block; position: relative; width: 1.918em; height: 0px;"><span style="position: absolute; clip: rect(3.228em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4360" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mtext" id="MathJax-Span-4361" style="font-size: 70.7%; font-family: MathJax_Main;">start</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-158">t_\text{start}</script> = t and get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3866"><span class="MJXp-msubsup" id="MJXp-Span-3867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3868" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3869" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-159-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4362"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4363"><span class="msubsup" id="MathJax-Span-4364"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4365" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-4366" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-159">s_t</script>.</li>
      <li>While (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3870"><span class="MJXp-msubsup" id="MJXp-Span-3871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3872" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3873" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3874" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mtext" id="MJXp-Span-3875">TERMINAL</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-160-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4367"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4368"><span class="msubsup" id="MathJax-Span-4369"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4370" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-4371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4372" style="font-family: MathJax_Main; padding-left: 0.305em;">≠</span><span class="mtext" id="MathJax-Span-4373" style="font-family: MathJax_Main; padding-left: 0.305em;">TERMINAL</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-160">s_t \neq \text{TERMINAL}</script>) and (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3877">t</span><span class="MJXp-mo" id="MJXp-Span-3878" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-3879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3880" style="margin-right: 0.05em;">t</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-3881" style="vertical-align: -0.4em;">start</span></span><span class="MJXp-mo" id="MJXp-Span-3882" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;=</span><span class="MJXp-msubsup" id="MJXp-Span-3883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3884" style="margin-right: 0.05em;">t</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-3885" style="vertical-align: -0.4em;">max</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-161-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4374"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4375"><span class="mi" id="MathJax-Span-4376" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4377" style="font-family: MathJax_Main; padding-left: 0.204em;">−</span><span class="msubsup" id="MathJax-Span-4378" style="padding-left: 0.204em;"><span style="display: inline-block; position: relative; width: 1.918em; height: 0px;"><span style="position: absolute; clip: rect(3.228em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4379" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mtext" id="MathJax-Span-4380" style="font-size: 70.7%; font-family: MathJax_Main;">start</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4381" style="font-family: MathJax_Main; padding-left: 0.305em;">&lt;<span style="font-family: MathJax_Main;">=</span></span><span class="msubsup" id="MathJax-Span-4382" style="padding-left: 0.305em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(3.228em, 1000.36em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4383" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.355em;"><span class="mtext" id="MathJax-Span-4384" style="font-size: 70.7%; font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-161">% <![CDATA[
t - t_\text{start} <= t_\text{max} %]]></script>):
        <ol>
          <li>Pick the action <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3886"><span class="MJXp-msubsup" id="MJXp-Span-3887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3888" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3889" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3890" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3891">π</span><span class="MJXp-mo" id="MJXp-Span-3892" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3894" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3895" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3896" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-3897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3898" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3899" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3900" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msup" id="MJXp-Span-3901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3902" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3903" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3904" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-162-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4385"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4386"><span class="msubsup" id="MathJax-Span-4387"><span style="display: inline-block; position: relative; width: 0.859em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4388" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="mi" id="MathJax-Span-4389" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4390" style="font-family: MathJax_Main; padding-left: 0.305em;">∼</span><span class="mi" id="MathJax-Span-4391" style="font-family: MathJax_Math-italic; padding-left: 0.305em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4392" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4393"><span style="display: inline-block; position: relative; width: 0.859em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.51em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4394" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.507em;"><span class="mi" id="MathJax-Span-4395" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4396" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-4397"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4398" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-4399" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4400" style="font-family: MathJax_Main;">;</span><span class="msup" id="MathJax-Span-4401" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 0.759em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4402" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.456em;"><span class="mo" id="MathJax-Span-4403" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4404" style="font-family: MathJax_Main;">)</span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-162">a_t \sim \pi(a_t \vert s_t; \theta')</script> and receive a new reward <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3905"><span class="MJXp-msubsup" id="MJXp-Span-3906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3907" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3908" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-163-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4405"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4406"><span class="msubsup" id="MathJax-Span-4407"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.46em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4408" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-4409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-163">r_t</script> and a new state <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3909"><span class="MJXp-msubsup" id="MJXp-Span-3910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3911" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3912" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3913">t</span><span class="MJXp-mo" id="MJXp-Span-3914">+</span><span class="MJXp-mn" id="MJXp-Span-3915">1</span></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-164-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4410"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4411"><span class="msubsup" id="MathJax-Span-4412"><span style="display: inline-block; position: relative; width: 1.716em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4413" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="texatom" id="MathJax-Span-4414"><span class="mrow" id="MathJax-Span-4415"><span class="mi" id="MathJax-Span-4416" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4417" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-4418" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-164">s_{t+1}</script>.</li>
          <li>Update t = t + 1 and T = T + 1.</li>
        </ol>
      </li>
      <li>Initialize the variable that holds the return estimation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3917">R</span><span class="MJXp-mo" id="MJXp-Span-3918" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3919"><span class="MJXp-mo" id="MJXp-Span-3920" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.75em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4em; margin-left: -0.278em;">{</span></span><span class="MJXp-mtable" id="MJXp-Span-3921"><span><span class="MJXp-mtr" id="MJXp-Span-3922" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3923" style="text-align: left;"><span class="MJXp-mn" id="MJXp-Span-3924">0</span></span><span class="MJXp-mtd" id="MJXp-Span-3925" style="padding-left: 1em; text-align: left;"><span class="MJXp-mtext" id="MJXp-Span-3926">if&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-3927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3928" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3929" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mtext" id="MJXp-Span-3930">&nbsp;is TERMINAL</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3931" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3932" style="padding-top: 0.2em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3933">V</span><span class="MJXp-mo" id="MJXp-Span-3934" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3936" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3937" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-3938" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msup" id="MJXp-Span-3939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3940" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3941" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3942" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-3943" style="padding-left: 1em; padding-top: 0.2em; text-align: left;"><span class="MJXp-mtext" id="MJXp-Span-3944">otherwise</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3945" style="margin-left: 0em; margin-right: 0em;"></span></span></span></span><span class="MathJax MathJax_Processed" id="MathJax-Element-165-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-4419"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 124%;"><span style="position: absolute;"><span class="mrow" id="MathJax-Span-4420"><span class="mi" id="MathJax-Span-4421" style="font-family: MathJax_Math-italic;">R</span><span class="mo" id="MathJax-Span-4422" style="font-family: MathJax_Main; padding-left: 0.305em;">=</span><span class="mrow" id="MathJax-Span-4423" style="padding-left: 0.305em;"><span class="mo" id="MathJax-Span-4424" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">{</span></span><span class="mtable" id="MathJax-Span-4425" style="padding-right: 0.154em; padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 13.107em; height: 0px;"><span style="position: absolute; clip: rect(2.573em, 1003.68em, 4.992em, -999.997em); top: -3.979em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.783em; height: 0px;"><span style="position: absolute; clip: rect(3.178em, 1000.46em, 4.136em, -999.997em); top: -4.534em; left: 0em;"><span class="mtd" id="MathJax-Span-4426"><span class="mrow" id="MathJax-Span-4427"><span class="mn" id="MathJax-Span-4428" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.077em, 1003.68em, 4.388em, -999.997em); top: -3.374em; left: 0em;"><span class="mtd" id="MathJax-Span-4436"><span class="mrow" id="MathJax-Span-4437"><span class="mi" id="MathJax-Span-4438" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.204em;"></span></span><span class="mo" id="MathJax-Span-4439" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4440"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4441" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-4442" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4443" style="font-family: MathJax_Main;">;</span><span class="msup" id="MathJax-Span-4444" style="padding-left: 0.154em;"><span style="display: inline-block; position: relative; width: 1.011em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.71em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4445" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -4.332em; left: 0.708em;"><span class="mo" id="MathJax-Span-4446" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4447" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(2.523em, 1008.32em, 4.791em, -999.997em); top: -3.979em; left: 4.791em;"><span style="display: inline-block; position: relative; width: 8.369em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1008.32em, 4.287em, -999.997em); top: -4.534em; left: 0em;"><span class="mtd" id="MathJax-Span-4429"><span class="mrow" id="MathJax-Span-4430"><span class="mtext" id="MathJax-Span-4431" style="font-family: MathJax_Main;">if&nbsp;</span><span class="msubsup" id="MathJax-Span-4432"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(3.38em, 1000.41em, 4.136em, -999.997em); top: -3.979em; left: 0em;"><span class="mi" id="MathJax-Span-4433" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.456em;"><span class="mi" id="MathJax-Span-4434" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mtext" id="MathJax-Span-4435" style="font-family: MathJax_Main;">&nbsp;is TERMINAL</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1004.09em, 4.136em, -999.997em); top: -3.374em; left: 0em;"><span class="mtd" id="MathJax-Span-4448"><span class="mrow" id="MathJax-Span-4449"><span class="mtext" id="MathJax-Span-4450" style="font-family: MathJax_Main;">otherwise</span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.984em;"></span></span></span></span><span class="mo" id="MathJax-Span-4451"></span></span></span></span></span></span></nobr></span><script type="math/tex" id="MathJax-Element-165">% <![CDATA[
R = \begin{cases} 
 0 & \text{if } s_t \text{ is TERMINAL} \\
 V(s_t; w') & \text{otherwise}
 \end{cases} %]]></script>.</li>
      <li>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3946"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3947">i</span><span class="MJXp-mo" id="MJXp-Span-3948" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3949">t</span><span class="MJXp-mo" id="MJXp-Span-3950" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-3951">1</span><span class="MJXp-mo" id="MJXp-Span-3952" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-3953" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-3954" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3956" style="margin-right: 0.05em;">t</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-3957" style="vertical-align: -0.4em;">start</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-166-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-166">i = t-1, \dots, t_\text{start}</script>:
        <ol>
          <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3959">R</span><span class="MJXp-mo" id="MJXp-Span-3960" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-3961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3962" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3963" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3964" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3965">γ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3966">R</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-167-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-167">R \leftarrow r_i + \gamma R</script>; here R is a MC measure of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3967"><span class="MJXp-msubsup" id="MJXp-Span-3968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3969" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3970" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-168-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-168">G_i</script>.</li>
          <li>Accumulate gradients w.r.t. θ’: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3972">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3973">θ</span><span class="MJXp-mo" id="MJXp-Span-3974" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3975">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3976">θ</span><span class="MJXp-mo" id="MJXp-Span-3977" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3978"><span class="MJXp-mi" id="MJXp-Span-3979" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3980" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-3981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3982" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3983" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-3984">log</span><span class="MJXp-mo" id="MJXp-Span-3985" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3986">π</span><span class="MJXp-mo" id="MJXp-Span-3987" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3989" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3990" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3991" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-3992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3993" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3994" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3995" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msup" id="MJXp-Span-3996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3997" style="margin-right: 0.05em;">θ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-3998" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-3999" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4000" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4001">R</span><span class="MJXp-mo" id="MJXp-Span-4002" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4003">V</span><span class="MJXp-mo" id="MJXp-Span-4004" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4006" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4007" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4008" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msup" id="MJXp-Span-4009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4010" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4011" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4012" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4013" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-169-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-169">d\theta \leftarrow d\theta + \nabla_{\theta'} \log \pi(a_i \vert s_i; \theta')(R - V(s_i; w'))</script>;<br>
 Accumulate gradients w.r.t. w’: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4014"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4015">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4016">w</span><span class="MJXp-mo" id="MJXp-Span-4017" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4018">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4019">w</span><span class="MJXp-mo" id="MJXp-Span-4020" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-4021"><span class="MJXp-mi" id="MJXp-Span-4022" style="margin-right: 0.05em;">∇</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4023" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-4024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4025" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4026" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4027" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4028">R</span><span class="MJXp-mo" id="MJXp-Span-4029" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4030">V</span><span class="MJXp-mo" id="MJXp-Span-4031" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4033" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4034" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4035" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msup" id="MJXp-Span-4036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4037" style="margin-right: 0.05em;">w</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-4038" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-4039" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4040"><span class="MJXp-mo" id="MJXp-Span-4041" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4042" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-170-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-170">dw \leftarrow dw + \nabla_{w'} (R - V(s_i; w'))^2</script>.</li>
        </ol>
      </li>
      <li>Update synchronously θ using dθ, and w using dw.</li>
    </ol>
  </li>
</ol>

<p>A3C enables the parallelism in multiple agent training. The gradient accumulation step (6.2) can be considered as a reformation of minibatch-based stochastic gradient update: the values of w or θ get corrected by a little bit in the direction of each training thread independently.</p>

<h3 id="evolution-strategies">Evolution Strategies</h3>

<p><a href="https://en.wikipedia.org/wiki/Evolution_strategy">Evolution Strategies</a> (ES) is a type of model-agnostic optimization approach. It learns the optimal solution by imitating Darwin’s theory of the evolution of species by natural selection. Two prerequisites for applying ES: (1) our solutions can freely interact with the environment and see whether they can solve the problem; (2) we are able to compute a <strong>fitness</strong> score of how good each solution is. We don’t have to know the environment configuration to solve the problem.</p>

<p>Say, we start with a population of random solutions. All of them are capable of interacting with the environment and only candidates with high fitness scores can survive (<em>only the fittest can survive in a competition for limited resources</em>). A new generation is then created by recombining the settings (<em>gene mutation</em>) of high-fitness survivors. This process is repeated until the new solutions are good enough.</p>

<p>Very different from the popular MDP-based approaches as what we have introduced above, ES aims to learn the policy parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4044">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-171-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-171">\theta</script> without value approximation. Let’s assume the distribution over the parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4046">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-172-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-172">\theta</script> is an <a href="https://math.stackexchange.com/questions/1991961/gaussian-distribution-is-isotropic">isotropic</a> multivariate Gaussian with mean <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4048">μ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-173-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-173">\mu</script> and fixed covariance <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4049"><span class="MJXp-msubsup" id="MJXp-Span-4050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4051" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4052" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4053">I</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-174-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-174">\sigma^2I</script>. The gradient of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4055">F</span><span class="MJXp-mo" id="MJXp-Span-4056" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4057">θ</span><span class="MJXp-mo" id="MJXp-Span-4058" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-175-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-175">F(\theta)</script> is calculated:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4059"><span class="MJXp-mtable" id="MJXp-Span-4060"><span><span class="MJXp-mtr" id="MJXp-Span-4061" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4062" style="text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-4063" style="padding-left: 0em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-4064"><span class="MJXp-mi" id="MJXp-Span-4065" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4066" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-msubsup" id="MJXp-Span-4067"><span class="MJXp-mrow" id="MJXp-Span-4068" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4069">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4070" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4071">θ</span><span class="MJXp-mo" id="MJXp-Span-4072">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4073">N</span><span class="MJXp-mo" id="MJXp-Span-4074">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4075">μ</span><span class="MJXp-mo" id="MJXp-Span-4076">,</span><span class="MJXp-msubsup" id="MJXp-Span-4077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4078" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4079" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4080">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4081">F</span><span class="MJXp-mo" id="MJXp-Span-4082" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4083">θ</span><span class="MJXp-mo" id="MJXp-Span-4084" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4085" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4086" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4087" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-4088" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-4089"><span class="MJXp-mi" id="MJXp-Span-4090" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4091" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-msubsup" id="MJXp-Span-4092"><span class="MJXp-mo" id="MJXp-Span-4093" style="margin-left: 0em; margin-right: 0.05em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4094" style="vertical-align: -0.46em;">θ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4095">F</span><span class="MJXp-mo" id="MJXp-Span-4096" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4097">θ</span><span class="MJXp-mo" id="MJXp-Span-4098" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4099" style="margin-left: 0.333em; margin-right: 0.333em;">Pr</span><span class="MJXp-mo" id="MJXp-Span-4100" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4101">θ</span><span class="MJXp-mo" id="MJXp-Span-4102" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-4103" style="padding-left: 2em; padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-4104" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mtext" id="MJXp-Span-4105">Pr(.) is the Gaussian density function.</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4106" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4107" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4108" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-4109" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-4110"></span><span class="MJXp-msubsup" id="MJXp-Span-4111"><span class="MJXp-mo" id="MJXp-Span-4112" style="margin-left: 0em; margin-right: 0.05em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4113" style="vertical-align: -0.46em;">θ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4114">F</span><span class="MJXp-mo" id="MJXp-Span-4115" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4116">θ</span><span class="MJXp-mo" id="MJXp-Span-4117" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4118" style="margin-left: 0.333em; margin-right: 0.333em;">Pr</span><span class="MJXp-mo" id="MJXp-Span-4119" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4120">θ</span><span class="MJXp-mo" id="MJXp-Span-4121" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-4122" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4123"><span class="MJXp-mi" id="MJXp-Span-4124" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4125" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mo" id="MJXp-Span-4126" style="margin-left: 0.333em; margin-right: 0.333em;">Pr</span><span class="MJXp-mo" id="MJXp-Span-4127" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4128">θ</span><span class="MJXp-mo" id="MJXp-Span-4129" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-4130" style="margin-left: 0.333em; margin-right: 0.333em;">Pr</span><span class="MJXp-mo" id="MJXp-Span-4131" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4132">θ</span><span class="MJXp-mo" id="MJXp-Span-4133" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-4134" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4135" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-4137" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-4138"></span><span class="MJXp-msubsup" id="MJXp-Span-4139"><span class="MJXp-mo" id="MJXp-Span-4140" style="margin-left: 0em; margin-right: 0.05em;"><span class="MJXp-largeop MJXp-int">∫</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4141" style="vertical-align: -0.46em;">θ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4142">F</span><span class="MJXp-mo" id="MJXp-Span-4143" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4144">θ</span><span class="MJXp-mo" id="MJXp-Span-4145" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4146" style="margin-left: 0.333em; margin-right: 0.333em;">Pr</span><span class="MJXp-mo" id="MJXp-Span-4147" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4148">θ</span><span class="MJXp-mo" id="MJXp-Span-4149" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4150"><span class="MJXp-mi" id="MJXp-Span-4151" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4152" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi" id="MJXp-Span-4153">log</span><span class="MJXp-mo" id="MJXp-Span-4154" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-4155" style="margin-left: 0.333em; margin-right: 0.333em;">Pr</span><span class="MJXp-mo" id="MJXp-Span-4156" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4157">θ</span><span class="MJXp-mo" id="MJXp-Span-4158" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4159" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4160" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4161" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-4162" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-4163"><span class="MJXp-mrow" id="MJXp-Span-4164" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4165">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4166" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4167">θ</span><span class="MJXp-mo" id="MJXp-Span-4168">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4169">N</span><span class="MJXp-mo" id="MJXp-Span-4170">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4171">μ</span><span class="MJXp-mo" id="MJXp-Span-4172">,</span><span class="MJXp-msubsup" id="MJXp-Span-4173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4174" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4175" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4176">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4177" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4178">F</span><span class="MJXp-mo" id="MJXp-Span-4179" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4180">θ</span><span class="MJXp-mo" id="MJXp-Span-4181" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4182"><span class="MJXp-mi" id="MJXp-Span-4183" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4184" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi" id="MJXp-Span-4185">log</span><span class="MJXp-mo" id="MJXp-Span-4186" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-4187" style="margin-left: 0.333em; margin-right: 0.333em;">Pr</span><span class="MJXp-mo" id="MJXp-Span-4188" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4189">θ</span><span class="MJXp-mo" id="MJXp-Span-4190" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4191" style="margin-left: 0em; margin-right: 0em;">]</span></span><span class="MJXp-mtd" id="MJXp-Span-4192" style="padding-left: 2em; padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-4193" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mtext" id="MJXp-Span-4194">Similar to how we do policy gradient update.</span></span></span><span class="MJXp-mtr" id="MJXp-Span-4195" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4196" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4197" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-4198" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-4199"><span class="MJXp-mrow" id="MJXp-Span-4200" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4201">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4202" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4203">θ</span><span class="MJXp-mo" id="MJXp-Span-4204">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4205">N</span><span class="MJXp-mo" id="MJXp-Span-4206">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4207">μ</span><span class="MJXp-mo" id="MJXp-Span-4208">,</span><span class="MJXp-msubsup" id="MJXp-Span-4209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4210" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4211" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4212">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-4213"><span class="MJXp-mo" id="MJXp-Span-4214" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">[</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4215">F</span><span class="MJXp-mo" id="MJXp-Span-4216" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4217">θ</span><span class="MJXp-mo" id="MJXp-Span-4218" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4219"><span class="MJXp-mi" id="MJXp-Span-4220" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4221" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mi" id="MJXp-Span-4222">log</span><span class="MJXp-mo" id="MJXp-Span-4223" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-4224"><span class="MJXp-mo" id="MJXp-Span-4225" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-4226" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4227">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msqrt" id="MJXp-Span-4228"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale10" style="font-size: 166%; margin-top: 0.084em; margin-left: 0em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4229">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4230">π</span><span class="MJXp-msubsup" id="MJXp-Span-4231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4232" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4233" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4235" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4236" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-4237">−</span><span class="MJXp-mfrac" id="MJXp-Span-4238" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-4239">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4240">θ</span><span class="MJXp-mo" id="MJXp-Span-4241">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4242">μ</span><span class="MJXp-msubsup" id="MJXp-Span-4243"><span class="MJXp-mo" id="MJXp-Span-4244" style="margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4245" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4246">2</span><span class="MJXp-msubsup" id="MJXp-Span-4247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4248" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4249" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4250"><span class="MJXp-mo" id="MJXp-Span-4251" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-4252"><span class="MJXp-mo" id="MJXp-Span-4253" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-4254" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4255" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4256" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-4257" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-4258"><span class="MJXp-mrow" id="MJXp-Span-4259" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4260">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4261" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4262">θ</span><span class="MJXp-mo" id="MJXp-Span-4263">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4264">N</span><span class="MJXp-mo" id="MJXp-Span-4265">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4266">μ</span><span class="MJXp-mo" id="MJXp-Span-4267">,</span><span class="MJXp-msubsup" id="MJXp-Span-4268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4269" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4270" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4271">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-4272"><span class="MJXp-mo" id="MJXp-Span-4273" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">[</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4274">F</span><span class="MJXp-mo" id="MJXp-Span-4275" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4276">θ</span><span class="MJXp-mo" id="MJXp-Span-4277" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-4278"><span class="MJXp-mi" id="MJXp-Span-4279" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4280" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mrow" id="MJXp-Span-4281"><span class="MJXp-mo" id="MJXp-Span-4282" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span><span class="MJXp-mo" id="MJXp-Span-4283" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi" id="MJXp-Span-4284">log</span><span class="MJXp-mo" id="MJXp-Span-4285" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msqrt" id="MJXp-Span-4286"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale10" style="font-size: 166%; margin-top: 0.084em; margin-left: 0em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4287">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4288">π</span><span class="MJXp-msubsup" id="MJXp-Span-4289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4290" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4291" style="vertical-align: 0.5em;">2</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-4292" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-4293" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-4294" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4295">θ</span><span class="MJXp-mo" id="MJXp-Span-4296" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4297">μ</span><span class="MJXp-msubsup" id="MJXp-Span-4298"><span class="MJXp-mo" id="MJXp-Span-4299" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4300" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4301">2</span><span class="MJXp-msubsup" id="MJXp-Span-4302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4303" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4304" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4305"><span class="MJXp-mo" id="MJXp-Span-4306" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-4307"><span class="MJXp-mo" id="MJXp-Span-4308" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-4309" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4310" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mo" id="MJXp-Span-4311" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-4312" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-4313"><span class="MJXp-mrow" id="MJXp-Span-4314" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4315">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4316" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4317">θ</span><span class="MJXp-mo" id="MJXp-Span-4318">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4319">N</span><span class="MJXp-mo" id="MJXp-Span-4320">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4321">μ</span><span class="MJXp-mo" id="MJXp-Span-4322">,</span><span class="MJXp-msubsup" id="MJXp-Span-4323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4324" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4325" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4326">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-4327"><span class="MJXp-mo" id="MJXp-Span-4328" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">[</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4329">F</span><span class="MJXp-mo" id="MJXp-Span-4330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4331">θ</span><span class="MJXp-mo" id="MJXp-Span-4332" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mfrac" id="MJXp-Span-4333" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4334">θ</span><span class="MJXp-mo" id="MJXp-Span-4335" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4336">μ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-4337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4338" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4339" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4340"><span class="MJXp-mo" id="MJXp-Span-4341" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">]</span></span></span></span></span></span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-176">% <![CDATA[
\begin{aligned}
& \nabla_\theta \mathbb{E}_{\theta \sim N(\mu, \sigma^2)} F(\theta) \\
=& \nabla_\theta \int_\theta F(\theta) \Pr(\theta) && \text{Pr(.) is the Gaussian density function.} \\
=& \int_\theta F(\theta) \Pr(\theta) \frac{\nabla_\theta \Pr(\theta)}{\Pr(\theta)} \\
=& \int_\theta F(\theta) \Pr(\theta) \nabla_\theta \log \Pr(\theta) \\
=& \mathbb{E}_{\theta \sim N(\mu, \sigma^2)} [F(\theta) \nabla_\theta \log \Pr(\theta)] && \text{Similar to how we do policy gradient update.} \\
=& \mathbb{E}_{\theta \sim N(\mu, \sigma^2)} \Big[ F(\theta) \nabla_\theta \log \Big( \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(\theta - \mu)^2}{2 \sigma^2 }} \Big) \Big] \\
=& \mathbb{E}_{\theta \sim N(\mu, \sigma^2)} \Big[ F(\theta) \nabla_\theta \Big( -\log \sqrt{2\pi\sigma^2} - \frac{(\theta - \mu)^2}{2 \sigma^2} \Big) \Big] \\
=& \mathbb{E}_{\theta \sim N(\mu, \sigma^2)} \Big[ F(\theta) \frac{\theta - \mu}{\sigma^2} \Big]
\end{aligned} %]]></script>

<p>We can rewrite this formula in terms of a “mean” parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4343">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-177-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-177">\theta</script> (different from the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4345">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-178-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-178">\theta</script> above; this <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4347">θ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-179-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-179">\theta</script> is the base gene for further mutation), <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4349">ϵ</span><span class="MJXp-mo" id="MJXp-Span-4350" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4351">N</span><span class="MJXp-mo" id="MJXp-Span-4352" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4353">0</span><span class="MJXp-mo" id="MJXp-Span-4354" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4355">I</span><span class="MJXp-mo" id="MJXp-Span-4356" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-180-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-180">\epsilon \sim N(0, I)</script> and therefore <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4358">θ</span><span class="MJXp-mo" id="MJXp-Span-4359" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4360">ϵ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4361">σ</span><span class="MJXp-mo" id="MJXp-Span-4362" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4363">N</span><span class="MJXp-mo" id="MJXp-Span-4364" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4365">θ</span><span class="MJXp-mo" id="MJXp-Span-4366" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4368" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4369" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4370" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-181-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-181">\theta + \epsilon \sigma \sim N(\theta, \sigma^2)</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4372">ϵ</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-182-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-182">\epsilon</script> controls how much Gaussian noises should be added to create mutation:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4373"><span class="MJXp-msubsup" id="MJXp-Span-4374"><span class="MJXp-mi" id="MJXp-Span-4375" style="margin-right: 0.05em;">∇</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4376" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-msubsup" id="MJXp-Span-4377"><span class="MJXp-mrow" id="MJXp-Span-4378" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4379">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4380" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4381">ϵ</span><span class="MJXp-mo" id="MJXp-Span-4382">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4383">N</span><span class="MJXp-mo" id="MJXp-Span-4384">(</span><span class="MJXp-mn" id="MJXp-Span-4385">0</span><span class="MJXp-mo" id="MJXp-Span-4386">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4387">I</span><span class="MJXp-mo" id="MJXp-Span-4388">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4389">F</span><span class="MJXp-mo" id="MJXp-Span-4390" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4391">θ</span><span class="MJXp-mo" id="MJXp-Span-4392" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4393">σ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4394">ϵ</span><span class="MJXp-mo" id="MJXp-Span-4395" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4396" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-4397" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-4398">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4399">σ</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-4400"><span class="MJXp-mrow" id="MJXp-Span-4401" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-4402">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4403" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4404">ϵ</span><span class="MJXp-mo" id="MJXp-Span-4405">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4406">N</span><span class="MJXp-mo" id="MJXp-Span-4407">(</span><span class="MJXp-mn" id="MJXp-Span-4408">0</span><span class="MJXp-mo" id="MJXp-Span-4409">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4410">I</span><span class="MJXp-mo" id="MJXp-Span-4411">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-4412" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4413">F</span><span class="MJXp-mo" id="MJXp-Span-4414" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4415">θ</span><span class="MJXp-mo" id="MJXp-Span-4416" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4417">σ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4418">ϵ</span><span class="MJXp-mo" id="MJXp-Span-4419" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4420">ϵ</span><span class="MJXp-mo" id="MJXp-Span-4421" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-183">\nabla_\theta \mathbb{E}_{\epsilon \sim N(0, I)} F(\theta + \sigma \epsilon) = \frac{1}{\sigma} \mathbb{E}_{\epsilon \sim N(0, I)} [F(\theta + \sigma \epsilon) \epsilon]</script>

<p class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/EA_RL_parallel.png" alt="EA"></p>
<p><em>Fig. 9. A simple parallel evolution-strategies-based RL algorithm. Parallel workers share the random seeds so that they can reconstruct the Gaussian noises with tiny communication bandwidth. (Image source: Salimans et al. 2017.)</em></p>

<p>ES, as a black-box optimization algorithm, is another approach to RL problems (<span style="color: #999999;"><em>In my original writing, I used the phrase “a nice alternative”; <a href="https://danieltakeshi.github.io/">Seita</a> pointed me to this <a href="https://www.reddit.com/r/MachineLearning/comments/6gke6a/d_requesting_openai_to_justify_the_grandiose/dir9wde/">discussion</a> and thus I updated my wording.</em></span>). It has a couple of good characteristics (Salimans et al., 2017) keeping it fast and easy to train:</p>
<ul>
  <li>ES does not need value function approximation;</li>
  <li>ES does not perform gradient back-propagation;</li>
  <li>ES is invariant to delayed or long-term rewards;</li>
  <li>ES is highly parallelizable with very little data communication.</li>
</ul>

<h2 id="known-problems">Known Problems</h2>

<h3 id="exploration-exploitation-dilemma">Exploration-Exploitation Dilemma</h3>

<p>The problem of exploration vs exploitation dilemma has been discussed in my previous <a href="https://lilianweng.github.io/lil-log/2018/01/23/the-multi-armed-bandit-problem-and-its-solutions.html#exploitation-vs-exploration">post</a>. When the RL problem faces an unknown environment, this issue is especially a key to finding a good solution: without enough exploration, we cannot learn the environment well enough; without enough exploitation, we cannot complete our reward optimization task.</p>

<p>Different RL algorithms balance between exploration and exploitation in different ways. In <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#monte-carlo-methods">MC</a> methods, <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#q-learning-off-policy-td-control">Q-learning</a> or many on-policy algorithms, the exploration is commonly implemented by <a href="https://lilianweng.github.io/lil-log/2018/01/23/the-multi-armed-bandit-problem-and-its-solutions.html#%CE%B5-greedy-algorithm">ε-greedy</a>; In <a href="https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html#evolution-strategies">ES</a>, the exploration is captured by the policy parameter perturbation. Please keep this into consideration when develop a new RL algorithm.</p>

<h3 id="deadly-triad-issue">Deadly Triad Issue</h3>

<p>We do seek the efficiency and flexibility of TD methods that involve bootstrapping. However, when off-policy, nonlinear function approximation, and bootstrapping are combined in one RL algorithm, the training could be unstable and hard to converge. This issue is known as the <strong>deadly triad</strong> (Sutton &amp; Barto, 2017). Many architectures using deep learning models were proposed to resolve the problem, including DQN to stabilize the training with experience replay and occasionally frozen target network.</p>

<h2 id="case-study-alphago-zero">Case Study: AlphaGo Zero</h2>

<p>The game of <a href="https://en.wikipedia.org/wiki/Go_(game)">Go</a> has been an extremely hard problem in the field of Artificial Intelligence for decades until recent years. AlphaGo and AlphaGo Zero are two programs developed by a team at DeepMind. Both involve deep Convolutional Neural Networks (<a href="https://lilianweng.github.io/lil-log/2017/12/15/object-recognition-for-dummies-part-2.html#cnn-for-image-classification">CNN</a>) and Monte Carlo Tree Search (MCTS) and both have been approved to achieve the level of professional human Go players. Different from AlphaGo that relied on supervised learning from expert human moves, AlphaGo Zero used only reinforcement learning and self-play without human knowledge beyond the basic rules.</p>

<p class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/go_config.png" alt="Go game board"></p>
<p><em>Fig. 10. The board of Go. Two players play black and white stones alternatively on the vacant intersections of a board with 19 x 19 lines. A group of stones must have at least one open point (an intersection, called a “liberty”) to remain on the board and must have at least two or more enclosed liberties (called “eyes”) to stay “alive”. No stone shall repeat a previous position.</em></p>

<p>With all the knowledge of RL above, let’s take a look at how AlphaGo Zero works. The main component is a deep <a href="https://lilianweng.github.io/lil-log/2017/12/15/object-recognition-for-dummies-part-2.html#cnn-for-image-classification">CNN</a> over the game board configuration (precisely, a <a href="https://lilianweng.github.io/lil-log/2017/12/15/object-recognition-for-dummies-part-2.html#resnet-he-et-al-2015">ResNet</a> with batch normalization and ReLU). This network outputs two values:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4422"><span class="MJXp-mo" id="MJXp-Span-4423" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4424">p</span><span class="MJXp-mo" id="MJXp-Span-4425" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4426">v</span><span class="MJXp-mo" id="MJXp-Span-4427" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-4428" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4430" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4431" style="vertical-align: -0.4em;">θ</span></span><span class="MJXp-mo" id="MJXp-Span-4432" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4433">s</span><span class="MJXp-mo" id="MJXp-Span-4434" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-184">(p, v) = f_\theta(s)</script>

<ul>
  <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4436">s</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-185-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-185">s</script>: the game board configuration, 19 x 19 x 17 stacked feature planes; 17 features for each position, 8 past configurations (including current) for the current player + 8 past configurations for the opponent + 1 feature indicating the color (1=black, 0=white). We need to code the color specifically because the network is playing with itself and the colors of current player and opponents are switching between steps.</li>
  <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4438">p</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-186-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-186">p</script>: the probability of selecting a move over 19^2 + 1 candidates (19^2 positions on the board, in addition to passing).</li>
  <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4440">v</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-187-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-187">v</script>: the winning probability given the current setting.</li>
</ul>

<p>During self-play, MCTS further improves the action probability distribution <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4442">π</span><span class="MJXp-mo" id="MJXp-Span-4443" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4444">p</span><span class="MJXp-mo" id="MJXp-Span-4445" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-4446" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-4447" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-188-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-188">\pi \sim p(.)</script> and then the action <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4448"><span class="MJXp-msubsup" id="MJXp-Span-4449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4450" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4451" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-189-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-189">a_t</script> is sampled from this improved policy. The reward <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4452"><span class="MJXp-msubsup" id="MJXp-Span-4453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4454" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4455" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-190-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-190">z_t</script> is a binary value indicating whether the current player <em>eventually</em> wins the game. Each move generates an episode tuple <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4456"><span class="MJXp-mo" id="MJXp-Span-4457" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4459" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4460" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-4461" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4463" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4464" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-4465" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-4466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4467" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4468" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-4469" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-191-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-191">(s_t, \pi_t, z_t)</script> and it is saved into the replay memory. The details on MCTS are skipped for the sake of space in this post; please read the original <a href="https://www.dropbox.com/s/yva172qos2u15hf/2017-silver.pdf?dl=0">paper</a> if you are interested.</p>

<p class="center"><img src="./A (Long) Peek into Reinforcement Learning_files/alphago-zero-selfplay.png" alt="AlphaGo Zero training"></p>
<p><em>Fig. 11. AlphaGo Zero is trained by self-play while MCTS improves the output policy further in every step. (Image source: Figure 1a in Silver et al., 2017).</em></p>

<p>The network is trained with the samples in the replay memory to minimize the loss:</p>

<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-4491"><span class="MJXp-mrow" id="MJXp-Span-4492"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-4493">L</span></span><span class="MJXp-mo" id="MJXp-Span-4494" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-4495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4496">z</span><span class="MJXp-mo" id="MJXp-Span-4497" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4498">v</span><span class="MJXp-msubsup" id="MJXp-Span-4499"><span class="MJXp-mo" id="MJXp-Span-4500" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4501" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4502" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-4503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4504" style="margin-right: 0.05em;">π</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-4505" style="vertical-align: 0.5em;">⊤</span></span><span class="MJXp-mi" id="MJXp-Span-4506">log</span><span class="MJXp-mo" id="MJXp-Span-4507" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4508">p</span><span class="MJXp-mo" id="MJXp-Span-4509" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4510">c</span><span class="MJXp-mo" id="MJXp-Span-4511" style="margin-left: 0em; margin-right: 0em;">‖</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4512">θ</span><span class="MJXp-msubsup" id="MJXp-Span-4513"><span class="MJXp-mo" id="MJXp-Span-4514" style="margin-left: 0em; margin-right: 0.05em;">‖</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4515" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_Display MathJax_Processing"><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0"></span></div><script type="math/tex; mode=display" id="MathJax-Element-192">\mathcal{L} = (z - v)^2 - \pi^\top \log p + c \| \theta \|^2</script>

<p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4517">c</span></span></span><span class="MathJax MathJax_Processing" id="MathJax-Element-193-Frame" tabindex="0"></span><script type="math/tex" id="MathJax-Element-193">c</script> is a hyperparameter controlling the intensity of L2 penalty to avoid overfitting.</p>

<p>AlphaGo Zero simplified AlphaGo by removing supervised learning and merging separated policy and value networks into one. It turns out that AlphaGo Zero achieved largely improved performance with a much shorter training time! I strongly recommend reading these <a href="https://pdfs.semanticscholar.org/1740/eb993cc8ca81f1e46ddaadce1f917e8000b5.pdf">two</a> <a href="https://www.dropbox.com/s/yva172qos2u15hf/2017-silver.pdf?dl=0">papers</a> side by side and compare the difference, super fun.</p>

<p>I know this is a long read, but hopefully worth it. <em>If you notice mistakes and errors in this post, don’t hesitate to contact me at [lilian dot wengweng at gmail dot com].</em> See you in the next post! :)</p>

<h2 id="references">References</h2>

<p>[1] Yuxi Li. <a href="https://arxiv.org/pdf/1701.07274.pdf">Deep reinforcement learning: An overview.</a> arXiv preprint arXiv:1701.07274. 2017.</p>

<p>[2] Richard S. Sutton and Andrew G. Barto. <a href="http://incompleteideas.net/book/bookdraft2017nov5.pdf">Reinforcement Learning: An Introduction; 2nd Edition</a>. 2017.</p>

<p>[3] Volodymyr Mnih, et al. <a href="http://proceedings.mlr.press/v48/mniha16.pdf">Asynchronous methods for deep reinforcement learning.</a> ICML. 2016.</p>

<p>[4] Tim Salimans, et al. <a href="https://arxiv.org/pdf/1703.03864.pdf">Evolution strategies as a scalable alternative to reinforcement learning.</a> arXiv preprint arXiv:1703.03864 (2017).</p>

<p>[5] David Silver, et al. <a href="https://www.dropbox.com/s/yva172qos2u15hf/2017-silver.pdf?dl=0">Mastering the game of go without human knowledge</a>. Nature 550.7676 (2017): 354.</p>

<p>[6] David Silver, et al. <a href="https://pdfs.semanticscholar.org/1740/eb993cc8ca81f1e46ddaadce1f917e8000b5.pdf">Mastering the game of Go with deep neural networks and tree search.</a> Nature 529.7587 (2016): 484-489.</p>

<p>[7] Volodymyr Mnih, et al. <a href="https://www.cs.swarthmore.edu/~meeden/cs63/s15/nature15b.pdf">Human-level control through deep reinforcement learning.</a> Nature 518.7540 (2015): 529.</p>

<p>[8] Ziyu Wang, et al. <a href="https://arxiv.org/pdf/1511.06581.pdf">Dueling network architectures for deep reinforcement learning.</a> ICML. 2016.</p>

<p>[9] <a href="https://www.youtube.com/playlist?list=PL7-jPKtc4r78-wCZcQn5IqyuWhBZ8fOxT">Reinforcement Learning lectures</a> by David Silver on YouTube.</p>

<p>[10] OpenAI Blog: <a href="https://blog.openai.com/evolution-strategies/">Evolution Strategies as a Scalable Alternative to Reinforcement Learning</a></p>

<p>[11] Frank Sehnke, et al. <a href="https://mediatum.ub.tum.de/doc/1287490/file.pdf">Parameter-exploring policy gradients.</a> Neural Networks 23.4 (2010): 551-559.</p>

<p>[12] Csaba Szepesvári. <a href="https://sites.ualberta.ca/~szepesva/papers/RLAlgsInMDPs.pdf">Algorithms for reinforcement learning.</a> 1st Edition. Synthesis lectures on artificial intelligence and machine learning 4.1 (2010): 1-103.</p>

<hr>

<p><em>If you notice mistakes and errors in this post, please don’t hesitate to contact me at [lilian dot wengweng at gmail dot com] and I would be super happy to correct them right away!</em></p>


  </div>


  <div class="page-navigation">
    
      <a class="prev" href="https://lilianweng.github.io/lil-log/2018/01/23/the-multi-armed-bandit-problem-and-its-solutions.html">← The Multi-Armed Bandit Problem and Its Solutions</a>
    

    
      <a class="next" href="https://lilianweng.github.io/lil-log/2018/04/08/policy-gradient-algorithms.html">Policy Gradient Algorithms →</a>
    
  </div>

  
    <div id="disqus_thread"><iframe id="dsq-app6544" name="dsq-app6544" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./A (Long) Peek into Reinforcement Learning_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 3821px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
<script>
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://lilianweng-github-io-lil-log.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<noscript>
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>

  

</article>

      </div>
    </main>

    <div style="clear: both;">
<footer class="site-footer">
    2019 © Built by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> and <a href="https://github.com/jekyll/minima/" target="_blank">minima</a> | View <a href="https://github.com/lilianweng/lil-log/tree/gh-pages" target="_blank">this</a> on Github | <a href="https://lilianweng.github.io/lil-log/tags.html">Tags</a> | <a href="https://lilianweng.github.io/lil-log/contact.html">Contact</a> | <a href="https://lilianweng.github.io/lil-log/FAQ.html">FAQ</a>

    <p>
        <a href="https://lilianweng.github.io/lil-log/feed.xml" target="_blank">
            <img src="./A (Long) Peek into Reinforcement Learning_files/logo_rss.png">
        </a>
        <a href="https://scholar.google.com/citations?user=dCa-pW8AAAAJ&amp;hl=en&amp;oi=ao" target="_blank">
            <img src="./A (Long) Peek into Reinforcement Learning_files/logo_scholar.png">
        </a>
        <a href="https://github.com/lilianweng" target="_blank">
            <img src="./A (Long) Peek into Reinforcement Learning_files/logo_github.png">
        </a>
        <a href="https://www.instagram.com/lilianweng/" target="_blank">
            <img src="./A (Long) Peek into Reinforcement Learning_files/logo_instagram.png">
        </a>
        <a href="https://twitter.com/lilianweng/" target="_blank">
            <img src="./A (Long) Peek into Reinforcement Learning_files/logo_twitter.png">
        </a>
    </p>
</footer>


  


</div><iframe style="display: none;" src="./A (Long) Peek into Reinforcement Learning_files/saved_resource(1).html"></iframe><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size3, sans-serif;"></div></div></body></html>